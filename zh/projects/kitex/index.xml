<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CloudWeGo â€“ Kitex</title><link>https://www.cloudwego.io/zh/projects/kitex/</link><description>Recent content in Kitex on CloudWeGo</description><generator>Hugo -- gohugo.io</generator><language>zh</language><lastBuildDate>Thu, 26 Jun 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://www.cloudwego.io/zh/projects/kitex/index.xml" rel="self" type="application/rss+xml"/><item><title>Blog: Kitex Release</title><link>https://www.cloudwego.io/zh/blog/releases/kitex/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/releases/kitex/</guid><description/></item><item><title>Blog: Kitex Release v0.14.0</title><link>https://www.cloudwego.io/zh/blog/2025/06/26/kitex-release-v0.14.0/</link><pubDate>Thu, 26 Jun 2025 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2025/06/26/kitex-release-v0.14.0/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="æ–°ç‰¹æ€§">&lt;strong>æ–°ç‰¹æ€§&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ³›åŒ–è°ƒç”¨ï¼šæ³›åŒ– Client æ”¯æŒæµå¼è°ƒç”¨ï¼Œä¸€ä¸ª Client æå®šæµå¼/éæµå¼è°ƒç”¨åœºæ™¯&lt;/strong>&lt;/p>
&lt;p>æ³›åŒ– Client æ”¯æŒæµå¼æ³›åŒ–è°ƒç”¨ï¼Œé€‚é… gRPC/TTHeader Streaming å¹¶æ”¯æŒ map / json å’Œ protobuf äºŒè¿›åˆ¶æ³›åŒ–è°ƒç”¨ã€‚&lt;/p>
&lt;p>ç®€è¦ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">genericclient&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewClient&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;actualServiceName&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">g&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// Ping-Pong æ³›åŒ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GenericCall&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;PingPongTest&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// ClientStreaming æ³›åŒ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">cliStream&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ClientStreaming&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;ClientStreamingTest&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// ServerStreaming æ³›åŒ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">srvStream&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ServerStreaming&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;ServerStreamingTest&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// BidiStreaming æ³›åŒ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">bidiStream&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BidiStreaming&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;BidiStreamingTest&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å„åœºæ™¯ä½¿ç”¨ç»†èŠ‚è¯·å‚è€ƒ&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage">æ³›åŒ–è°ƒç”¨&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="åŠŸèƒ½ä½“éªŒä¼˜åŒ–">&lt;strong>åŠŸèƒ½/ä½“éªŒä¼˜åŒ–&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Streamingï¼š è§‚æµ‹/æ’é”™ä½“éªŒä¼˜åŒ–&lt;/strong>&lt;/p>
&lt;p>&lt;strong>TTHeader Streaming&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>è‹¥é…ç½®äº† Tracerï¼Œåˆ›å»º Stream å¤±è´¥å°†æ‰“ç‚¹ä¸ŠæŠ¥&lt;/li>
&lt;li>å½“ Server ä¾§å‘ç”Ÿ panic æ—¶ï¼Œå°†æ‰“å°å®Œæ•´å †æ ˆï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>gRPC Streaming&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>è‹¥é…ç½®äº† Tracerï¼Œåˆ›å»º Stream å¤±è´¥å°†æ‰“ç‚¹ä¸ŠæŠ¥&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="å…¶ä»–">&lt;strong>å…¶ä»–&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>äº§ç‰©ç®€åŒ–&lt;/p>
&lt;p>Kitex Tool ä¸å†ç”Ÿæˆ fastpbï¼Œåªå½±å“ protobuf çš„ç”¨æˆ·ã€‚è‹¥æœ‰é«˜æ€§èƒ½ protobuf ç¼–è§£ç éœ€æ±‚ï¼Œå¯é…ç½®ç¯å¢ƒå˜é‡ &lt;code>KITEX_TOOL_USE_PRUTAL_MARSHAL=1&lt;/code>å¯ç”¨ prutalã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1759">#1759&lt;/a>] feat(tool): add env for using prutal to marshal&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1782">#1782&lt;/a>] feat(ttstream): process MetaFrame and reflect to rpcinfo&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1777">#1777&lt;/a>] feat(client): report err when create Stream failed&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1763">#1763&lt;/a>] feat: support ttheader streaming generic call&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1771">#1771&lt;/a>] feat(tool): add thriftgo patcher extension&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1755">#1755&lt;/a>] feat: add generic binary pb for streamx&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1752">#1752&lt;/a>] feat(generic): support generic pb binary for streaming&lt;/p>
&lt;h3 id="optimize">Optimize&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1788">#1788&lt;/a>] optimize: go net implementation&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1786">#1786&lt;/a>] optimize(tool): remove tool fastpb generation&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1783">#1783&lt;/a>] optimize(gRPC): parse PayloadCodec in server side&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1780">#1780&lt;/a>] optimize(ttstream): log the error thrown by invoking handler&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1769">#1769&lt;/a>] optimize: injection of options in ttstream&lt;/p>
&lt;h3 id="fix">Fix&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1792">#1792&lt;/a>] fix(gRPC): inject current method name to rpcinfo in server-side to fix FROM_METHOD missing&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1787">#1787&lt;/a>] fix(ttstream): metrics missing caused by server-side rpcinfo not set correctly&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1778">#1778&lt;/a>] fix: enabling json mode of map generic not work&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1774">#1774&lt;/a>] fix(server): trans server conn count race issue&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1742">#1742&lt;/a>] fix(generic): align dynamicgo&amp;rsquo;s write base behavior with old generic (only for internal logic)&lt;/p>
&lt;h3 id="refactor">Refactor&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1770">#1770&lt;/a>] refactor: refactor generic streaming&lt;/p>
&lt;h3 id="test">Test&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1793">#1793&lt;/a>] test: add go1.18 to scenario-test&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1765">#1765&lt;/a>] refactor: refactor generic streaming&lt;/p>
&lt;h3 id="docs">Docs&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1794">#1794&lt;/a>] docs: update CONTRIBUTING.md to change PR base branch to main&lt;/p>
&lt;h3 id="chore">Chore&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1795">#1795&lt;/a>] chore: update dependency&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1776">#1776&lt;/a>] chore: remove testify dependency&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1757">#1757&lt;/a>] chore: update prutal to v0.1.1&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1753">#1753&lt;/a>] ci: disable codecov annotations&lt;/p></description></item><item><title>Blog: Kitex Release v0.13.0</title><link>https://www.cloudwego.io/zh/blog/2025/04/09/kitex-release-v0.13.0/</link><pubDate>Wed, 09 Apr 2025 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2025/04/09/kitex-release-v0.13.0/</guid><description>
&lt;blockquote>
&lt;p>å»ºè®®ç›´æ¥å‡çº§ Kitex ç‰ˆæœ¬åˆ° v0.13.1ï¼Œå› ä¸ºæˆ‘ä»¬å¯¹ v0.13.0 é‡Œ gRPC Client æ½œåœ¨çš„ Goroutine æ³„æ¼é—®é¢˜è¿›è¡Œäº†ä¿®å¤&lt;/p>
&lt;/blockquote>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="æ–°ç‰¹æ€§">&lt;strong>æ–°ç‰¹æ€§&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ–°æµå¼æ¥å£ StreamX æ”¯æŒ gRPCï¼Œå­˜é‡ Kitex gRPC ç”¨æˆ·å¯è¿ç§»&lt;/strong>&lt;/p>
&lt;p>v0.12.0 å‘å¸ƒäº† StreamX æ¥å£ä¼˜åŒ–æµå¼ä½“éªŒï¼Œæ”¯æŒäº†è‡ªå®šä¹‰æµå¼åè®® TTHeader Streamingï¼Œä½†æœªæ”¯æŒ gRPCï¼Œå¯¼è‡´å­˜é‡ç”¨æˆ·æ— æ³•è¿ç§»ã€‚&lt;/p>
&lt;p>v0.13.0 å¯¹ StreamX æ”¯æŒ gRPC åï¼Œç”¨æˆ·å¯è¿ç§»è‡³ StreamX æ–°æ¥å£ï¼ŒServer ç«¯å¯ä»¥åŒæ—¶å…¼å®¹ä¸¤ä¸ªæµå¼åè®®ï¼Œæ— éœ€æ‹…å¿ƒæ¥å£è¿ç§»åçš„åè®®å…¼å®¹æ€§é—®é¢˜ã€‚&lt;/p>
&lt;p>ç‰¹åˆ«åœ°ï¼ŒStreamX åœ¨é€‚é… gRPC æ—¶ï¼Œå‘ç°ä¾ç„¶æœ‰ä¸€äº›ä¸ä¾¿åˆ©çš„é—®é¢˜ï¼Œä¸ºå¸¦æ¥æ›´å¥½çš„æ¥å£ä½¿ç”¨ä½“éªŒï¼Œå› æ­¤å¯¹ StreamX æ¥å£åšäº†äºŒæ¬¡è°ƒæ•´ã€‚&lt;/p>
&lt;p>å·²ç»ä½¿ç”¨ v0.12.* çš„ StreamX ç”¨æˆ·ä¼šå¸¦æ¥å½±å“ï¼Œåœ¨è¿™é‡Œè¡¨ç¤ºæŠ±æ­‰ã€‚&lt;/p>
&lt;p>è¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/streamx">StreamX ç”¨æˆ·æ–‡æ¡£&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Prutal - Protobuf çš„æ— ç”Ÿæˆä»£ç åºåˆ—åŒ–åº“&lt;/strong>&lt;/p>
&lt;p>&lt;a href="https://github.com/cloudwego/prutal">Prutal&lt;/a> æ­£å¼å¼€æºï¼Œå¯¹æ ‡ Thrift çš„ &lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a> åº“ï¼Œæ–°ç‰ˆæœ¬ Kitex é»˜è®¤é›†æˆ Prutalã€‚ç‰¹ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>äº§ç‰©ä½“ç§¯æœ€å°åŒ–ï¼Œåªéœ€ç”Ÿæˆç»“æ„ä½“&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä½¿ç”¨ä¸ Frugal ç›¸ä¼¼çš„åå°„ä¼˜åŒ–ï¼Œæ€§èƒ½ä¼˜äºå®˜æ–¹ Protobuf&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å…¼å®¹å®˜æ–¹ Protobuf åŠè¡ç”Ÿç‰ˆæœ¬çš„ç”Ÿæˆä»£ç &lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>è¯¦ç»†ä¿¡æ¯å‚è€ƒ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/prutal">Prutal&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="åŠŸèƒ½ä½“éªŒä¼˜åŒ–">&lt;strong>åŠŸèƒ½/ä½“éªŒä¼˜åŒ–&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>TTHeader Streaming æ”¯æŒé…ç½®æ¥å£çº§åˆ« Recv è¶…æ—¶&lt;/strong>&lt;/p>
&lt;p>æœ¬ç‰ˆæœ¬ TTHeader Streaming åœ¨åŸæœ‰çš„ Kitex Client çº§åˆ«åŸºç¡€ä¸Šï¼Œé¢å¤–æ”¯æŒæ¥å£çº§åˆ«çš„ Recv è¶…æ—¶é…ç½®ï¼Œé…ç½®æ›´ä¸ºçµæ´»ã€‚&lt;/p>
&lt;p>è¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/streamx/stream&amp;#43;timeout&amp;#43;control/">StreamX æµè¶…æ—¶æ§åˆ¶&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Thrift é»˜è®¤ä¼ è¾“åè®®ç”± Buffered æ”¹ä¸º Framed&lt;/strong>&lt;/p>
&lt;p>è¿™ä¸ªå˜æ›´å¯ä»¥åˆ©ç”¨ FastCodec ä»¥è·å¾—æ›´é«˜çš„ç¼–è§£ç æ€§èƒ½ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å…¶ä»–">&lt;strong>å…¶ä»–&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>äº§ç‰©ç®€åŒ–&lt;/p>
&lt;ul>
&lt;li>
&lt;p>é»˜è®¤ä¸ç”Ÿæˆ Set æ•°æ®ç»“æ„çš„é‡å¤æ ¡éªŒä»£ç ä¸å„ç»“æ„ä½“çš„ DeepEqual å‡½æ•°&lt;/p>
&lt;ul>
&lt;li>
&lt;p>è‹¥åªæƒ³æ¢å¤ DeepEqualï¼Œç”Ÿæˆå‘½ä»¤è¿½åŠ &lt;code>-thrift gen_deep_equal=true&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è‹¥æƒ³æ¢å¤ Set çš„é‡å¤æ ¡éªŒï¼Œç”Ÿæˆå‘½ä»¤è¿½åŠ &lt;code>-thrift validate_set=true, -thrift gen_deep_equal=true&lt;/code>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>é»˜è®¤ä¸ç”Ÿæˆ Apache Codec ç›¸å…³ä»£ç &lt;/p>
&lt;ul>
&lt;li>è‹¥æƒ³æ¢å¤è¿™éƒ¨åˆ†ä»£ç ï¼Œç”Ÿæˆå‘½ä»¤è¿½åŠ &lt;code>-thrift no_default_serdes=false&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Go æ”¯æŒç‰ˆæœ¬å˜åŒ–&lt;/p>
&lt;p>æ”¯æŒç‰ˆæœ¬ Go 1.19~1.24ï¼Œæœ€ä½æ”¯æŒç‰ˆæœ¬å˜ä¸º Go 1.19ï¼Œå¦‚æœ Go ç‰ˆæœ¬è¿‡ä½ï¼Œç¼–è¯‘æ—¶ä¼šæœ‰æç¤ºï¼š&lt;code>note: module requires Go 1.19&lt;/code>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1719">#1719&lt;/a>] feat: prutal for replacing protoc&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1736">#1736&lt;/a>] feat(ttstream): support WithRecvTimeout stream call option&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1702">#1702&lt;/a>] feat(gRPC): add grpc client conn dump to help debug the conn and stream status&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1723">#1723&lt;/a>] feat(codec/thrift): use fastcodec/frugal if apache codec not available&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1724">#1724&lt;/a>] feat: add tail option to support for delayed initialization of some client options&lt;/p>
&lt;h3 id="optimize">Optimize&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1728">#1728&lt;/a>] optimize(apache): remove apache codec gen and set default protocol from buffered to framed&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1732">#1732&lt;/a>] optimize(rpcinfo): purify the transport protocol of rpcinfo in a single rpc request&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1711">#1711&lt;/a>] optimize(tool): disable set validate and deep equal code gen to simplify kitex_gen&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1717">#1717&lt;/a>] optimize(gRPC): return more detailed error when received invalid http2 frame&lt;/p>
&lt;h3 id="fix">Fix&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1734">#1734&lt;/a>] fix(ttstream): adjust stream state transition and remove all SetFinalizer to avoid memory leak&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1735">#1735&lt;/a>] fix(generic): support both relative and absolute check for idl includes parse to make it compatible with generation tool&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1725">#1725&lt;/a>] fix: code gen import issue for streamx mode, stream call judgement bug and set ttheader streaming as default&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1727">#1727&lt;/a>] fix(tool): fix tool UseStdLib remains unexpected lib issue.&lt;/p>
&lt;h3 id="refactor">Refactor&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1658">#1658&lt;/a>] refactor: streamx api to adapt both grpc and ttheader streaming protocol and provide more user-friendly interface&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1729">#1729&lt;/a>] refactor(tool): move pb tpl code to sep pkg&lt;/p>
&lt;h3 id="chore">Chore&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1743">#1743&lt;/a>] chore: update dependencies version&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1740">#1740&lt;/a>] chore(generic): deprecate NewThriftContentProvider&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1741">#1741&lt;/a>] chore(streamx): remove redundant streamx package&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1738">#1738&lt;/a>] ci: fix typos &amp;amp; crate-ci/typos&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1737">#1737&lt;/a>] chore: update dependency and change go support to 1.19-1.24&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1720">#1720&lt;/a>] Revert &amp;ldquo;fix(ttstream): pingpong method refers to server interface defined in Kitex generation code when streamx is enabled and there are other streaming methods&amp;rdquo;&lt;/p></description></item><item><title>Blog: Kitex Release v0.12.0</title><link>https://www.cloudwego.io/zh/blog/2025/01/03/kitex-release-v0.12.0/</link><pubDate>Fri, 03 Jan 2025 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2025/01/03/kitex-release-v0.12.0/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="ç²¾ç®€äº§ç‰©å»ºè®®---å»-apache-thrift">ç²¾ç®€äº§ç‰©å»ºè®® - å» Apache Thrift&lt;/h3>
&lt;p>å¼ºçƒˆå»ºè®®å» Apache Codecï¼Œè§£å†³ Apache ä¸å…¼å®¹å˜æ›´å¸¦æ¥çš„ç¼–è¯‘ä½“éªŒé—®é¢˜ï¼Œå¹¶èƒ½&lt;strong>å‡å°‘ 50% äº§ç‰©ä½“ç§¯&lt;/strong>ã€‚&lt;/p>
&lt;p>è¯·ä½¿ç”¨ Kitex çš„ Thrift Codecï¼šFastCodec æˆ– Frugalï¼Œä¸ä¼šä¾èµ– Apache Thrift Codecã€‚&lt;/p>
&lt;p>åç»­ç‰ˆæœ¬è®¡åˆ’ï¼šKitex ä¼šé»˜è®¤å»é™¤ Apache äº§ç‰©ï¼Œç”¨æˆ·æŒ‡å—è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/best-practice/remove_apache_codec/">Kitex å» Apache Thrift ç”¨æˆ·æ‰‹å†Œ&lt;/a>&lt;/p>
&lt;h3 id="new-features">New Features&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Thrift Streaming over TTHeader - è‡ªå®šä¹‰æµå¼åè®®&lt;/strong>&lt;/p>
&lt;p>æ”¯æŒäº†åŸºäº TTheader åè®®çš„æµå¼è°ƒç”¨ï¼Œä¼˜åŒ–å›  gRPC streaming åè®®å¤æ‚åº¦è¿‡é«˜è€Œå¼•å…¥çš„ç¨³å®šæ€§é—®é¢˜ï¼›&lt;/p>
&lt;p>æä¾›äº†æ–°çš„æµå¼æ¥å£ StreamXï¼Œè§£å†³åŸæµå¼æ¥å£å„ç±»ä½¿ç”¨ä½“éªŒé—®é¢˜ï¼Œå¹¶æä¾›æµå¼æ¥å£çš„æœ€ä½³å®è·µã€‚&lt;/p>
&lt;p>ç”¨æˆ·æ–‡æ¡£ï¼š&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/streamx/">StreamX ç”¨æˆ·æ–‡æ¡£ä¸æœ€ä½³å®è·µ&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>gRPC Streaming æ”¯æŒä¼˜é›…é€€å‡º&lt;/strong>&lt;/p>
&lt;p>æ”¯æŒäº†ä¼˜é›…é€€å‡ºåŠŸèƒ½ï¼Œç”¨äºè§£å†³å› ä¸ºæœåŠ¡å‡çº§/æ›´æ–°è€Œå¯¼è‡´çš„ä¸Šæ¸¸æŠ¥é”™é—®é¢˜ã€‚&lt;/p>
&lt;p>ç”¨æˆ·æ–‡æ¡£ï¼š&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/protocol/streaming/grpc/graceful_shutdown/">gRPC Streaming ä¼˜é›…é€€å‡º&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>JSON æ³›åŒ–è°ƒç”¨æ”¯æŒ gRPC Streaming&lt;/strong>&lt;/p>
&lt;p>JSON æ³›åŒ–è°ƒç”¨æ”¯æŒ gRPC Streaming æµå¼æ¥å£ï¼ˆä»…é™ clientï¼‰ï¼Œç»è¿‡ v0.10.0 è¯•ç”¨ï¼Œæ­£å¼å‘å¸ƒã€‚&lt;/p>
&lt;p>ç”¨æˆ·æ–‡æ¡£ï¼š&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/generic_streaming/">User Guide to Generic Call for Streaming&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ä½“éªŒä¼˜åŒ–">ä½“éªŒä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>gRPC Streaming æ—¥å¿—ä¼˜åŒ–&lt;/strong>&lt;/p>
&lt;p>å¯¹äºæµå¼ä¸²è”åœºæ™¯ï¼Œè‹¥ä¸‹æ¸¸ Stream å‡ºé”™æ˜¯ç”±äºä¸Šæ¸¸ Stream é€€å‡ºï¼Œå°†ä¼šåœ¨é”™è¯¯ä¸­åŒ…å«&amp;quot;[triggered by {serviceName}]&amp;ldquo;åç¼€ï¼Œæ–¹ä¾¿å®šä½é—®é¢˜ï¼›&lt;/p>
&lt;p>Send è¿”å›çš„ the stream is done é”™è¯¯å°†å˜æˆå¯¼è‡´æµè¢«å…³é—­çš„çœŸæ­£é”™è¯¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä»£ç ç”Ÿæˆå·¥å…· Kitex Tool&lt;/strong>&lt;/p>
&lt;p>&lt;strong>ç”Ÿæˆé€Ÿåº¦å’Œå·¥å…·å®‰è£…ä¼˜åŒ–&lt;/strong>ï¼šæ— éœ€å†å®‰è£…æˆ–å‡çº§ Thriftgo ï¼Œå†…ç½®åˆ° Kitexï¼Œåœ¨ IDL ç‰¹åˆ«åºå¤§çš„åœºæ™¯ï¼Œç”Ÿæˆé€Ÿåº¦æœ‰è¾ƒå¤§æå‡ã€‚&lt;/p>
&lt;p>&lt;strong>æœ€å°åŒ–äº§ç‰©ä½“ç§¯&lt;/strong>ï¼šäº§ç‰©ä½“ç§¯æœ€å°åŒ–å¯ä»¥ä½¿ç”¨ Frugalï¼Œå¦‚æœå¸Œæœ›ç°åº¦å¼€å¯ï¼Œæ”¯æŒæŒ‡å®šç»“æ„ä½“ä½¿ç”¨ Frugal åºåˆ—åŒ–ã€‚è¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/code_generation/">ä»£ç ç”Ÿæˆå·¥å…·&lt;/a>å…³äº -frugal-structã€-gen-frugal å‚æ•°çš„è¯´æ˜ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ä¸å…¼å®¹å˜æ›´-å¯¹99ç”¨æˆ·æ— å½±å“">ä¸å…¼å®¹å˜æ›´-å¯¹99%ç”¨æˆ·æ— å½±å“&lt;/h3>
&lt;p>Kitex ä¼šå°½é‡ä¿è¯å¸¸è§„ä½¿ç”¨æ–¹å¼çš„å…¼å®¹æ€§ï¼Œä¸ªåˆ«ç”¨æˆ·å¯èƒ½å¯¹ Kitex éƒ¨åˆ†ä»£ç å®šä¹‰æœ‰ä¾èµ–ï¼ŒKitex æœ¬æ¬¡ç‰ˆæœ¬è°ƒæ•´å¯¹è¿™éƒ¨åˆ†ç”¨æˆ·æœ‰å½±å“ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>åˆ é™¤ &lt;code>thrift.NewBinaryProtocol&lt;/code>&lt;/strong>&lt;/p>
&lt;p>&lt;code>thrift.NewBinaryProtocol&lt;/code>æ˜¯ Kitex å¯¹ Apache thrift.TProtocol æ¥å£çš„å®ç°ï¼Œå› ä¸º trans éƒ¨åˆ†ç›´æ¥ä½¿ç”¨ Kitex çš„ ByteBufferï¼Œç›¸æ¯” apache thrift.TBinaryProtocol æ€§èƒ½æ›´å¥½ã€‚åœ¨ v0.11.0 å·²ç»åŠ äº†å¼ƒç”¨æ³¨é‡Šã€‚&lt;/p>
&lt;p>&lt;strong>åˆ é™¤åŸå› &lt;/strong>: å› ä¸ºè¦å»é™¤ Apache Thrift ä¾èµ–ï¼Œæ‰€ä»¥éœ€è¦åˆ é™¤è¯¥å®ç°ã€‚&lt;/p>
&lt;p>&lt;strong>ç”¨æˆ·ä¿®æ”¹è¯´æ˜&lt;/strong>: è¯¥å®ç°æœ¬å°±æ˜¯é…å¥— Apache Codec ä½¿ç”¨ï¼Œå¦‚æœä½ è¿˜éœ€è¦ä¾èµ– Apache Codecï¼Œè¯·ç›´æ¥ä½¿ç”¨ Apache çš„TBinaryProtocolã€‚å¦‚æœè§‰å¾—å¯¹æ€§èƒ½æœ‰å½±å“ï¼Œå¯ä»¥æŠŠ Kitex æ—§ç‰ˆæœ¬å®ç° fork ä¸‹æ¥ï¼Œå‚è€ƒ github/cloudwego/kitex v0.10.0ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;github.com/apache/thrift/lib/go/thrift&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">tProt&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">thrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewTBinaryProtocol&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">thrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewTMemoryBufferLen&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1024&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;strong>åˆ é™¤ &lt;code>generic.ServiceInfo&lt;/code>&lt;/strong>&lt;/p>
&lt;p>æ³›åŒ–éƒ¨åˆ†åˆ é™¤ &lt;code>generic.ServiceInfo&lt;/code> APIã€‚&lt;/p>
&lt;p>&lt;strong>åˆ é™¤åŸå› &lt;/strong>: å› ä¸ºå¤š Service çš„æ”¯æŒéœ€è¦å¯¹æ³›åŒ–éƒ¨åˆ†å®šä¹‰åšé‡æ„ã€‚&lt;/p>
&lt;p>&lt;strong>ç”¨æˆ·ä¿®æ”¹è¯´æ˜&lt;/strong>: æ–° API ç”¨ &lt;code>generic.ServiceInfoWithGeneric&lt;/code> æ›¿ä»£ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;github.com/cloudwego/kitex/pkg/generic&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// removed&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">ServiceInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pcType&lt;/span> &lt;span style="color:#000">serviceinfo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">PayloadCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">serviceinfo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ServiceInfo&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// please use this instead&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">ServiceInfoWithGeneric&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">g&lt;/span> &lt;span style="color:#000">Generic&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">serviceinfo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ServiceInfo&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="full-release-log">&lt;strong>Full Release Log&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1541">#1541&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1633">#1633&lt;/a>] feat(ttstream): support ttheader streaming and streamv2 interface&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1623">#1623&lt;/a>] feat(gRPC): optimize gRPC error prompt and metrics, assisting in troubleshooting problems&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1556">#1556&lt;/a>] feat(gRPC): support gRPC graceful shutdown&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1467">#1467&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1627">#1627&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1619">#1619&lt;/a>] feat(generic): support thrift streaming(over gRPC) for json generic client&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1607">#1607&lt;/a>] feat(tool): kitex tool support gen frugal codec for certain struct&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1526">#1526&lt;/a>] feat(generic): support an option to remove go.tag annotation&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1536">#1536&lt;/a>] feat(generic): support an option to set IDL ParseMode for each client&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1510">#1510&lt;/a>] feat: register service with service level middleware&lt;/p>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1635">#1635&lt;/a>] optimize: add two function for binary protocol to get bufiox reader and writer&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1630">#1630&lt;/a>] optimize(tool): implement no recursive generate to support incremental update&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1617">#1617&lt;/a>] optimize(retry): optimize UpdatePolicy and add test cases to check invalid retry policy. &amp;lt;v0.11.0, if the FailurePolicy is nil and type is 0 or &amp;gt;1, will trigger nil panic. The bug has been fixed in v0.11.0, this pr is to add test cases and optimize UpdatePolicy to ignore the nil panic&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1606">#1606&lt;/a>] optimize(tool): use embedded thriftgo as default option&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1595">#1595&lt;/a>] optimize(tool): optimize pb tool code&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1599">#1599&lt;/a>] optimize(tool): call FastWriteNocopy in FastWrite to avoid misuse by users&lt;/p>
&lt;h3 id="refactor">Refactor:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1615">#1615&lt;/a>] refactor: get rid of apache thrift in go.mod&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1611">#1611&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1614">#1614&lt;/a>] refactor: move ttheader codec logic to gopkg&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1553">#1553&lt;/a>] refactor(codec/thrift): unified typecodec implementation and adjust new file layout&lt;/p>
&lt;h3 id="perf">Perf:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1581">#1581&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1628">#1628&lt;/a>] perf(timeout): refactor new rpctimeout implementation to improve performance&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1564">#1564&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1567">#1567&lt;/a>] perf: reduce object allocation for circuitbreak middleware and retry context&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1557">#1557&lt;/a>] perf(rpcinfo): remove lock for rpcinfo.RPCStats&lt;/p>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1622">#1622&lt;/a>] fix(generic): use jsoniter instead of sonic for json generic-call, since sonic doesn&amp;rsquo;t support map[interface{}]interface{}&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1562">#1562&lt;/a>] fix: deep copy function of the generated code cannot copy the empty string&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1602">#1602&lt;/a>] fix(gRPC): check if the type assertion succeed in ProtocolMatch to avoid panic&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1598">#1598&lt;/a>] fix(retry): fix issue that mixed retry cannot update its config correctly&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1590">#1590&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1572">#1572&lt;/a>] fix(generic): set default values for optional fields of primitive types with generic with dynamicgo&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1580">#1580&lt;/a>] fix(netpoll): fix timeout caused by partial use of the Read method of remote.ByteBuffer&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1574">#1574&lt;/a>] fix(trace): stream event handler ignore io.EOF event&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1563">#1563&lt;/a>] fix(generic): fix the issue where the generic client sets the parse mode of CombineServices and then requests causes &amp;ldquo;unknown service&amp;rdquo; error&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1568">#1568&lt;/a>] fix(wpool): fix the issue of wpool object allocation, and incorrect ctx causing profiler errors.&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1558">#1558&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1555">#1555&lt;/a>] fix(bthrift): fix the issue of no recursion conversion of unknown field type under bthrift&lt;/p>
&lt;h3 id="chore">Chore:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1593">#1593&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1560">#1560&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1561">#1561&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1559">#1559&lt;/a>] chore(test): fix data race issue, unstable issue and long time running issue of some test cases&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1634">#1634&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1632">#1632&lt;/a>][&lt;a href="https://github.com/cloudwego/kitex/pull/1573">#1573&lt;/a>] chore(dep): upgrade frugal, localsession and other cloudwego dependency versions&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1616">#1616&lt;/a>] chore(generic): remove deprecated apis/interfaces/variables&lt;/p></description></item><item><title>Blog: å¦‚ä½•è®©ä½ çš„ Kitex ç”Ÿæˆä»£ç å‡»è´¥ 99% çš„ç”¨æˆ·</title><link>https://www.cloudwego.io/zh/blog/2024/09/20/%E5%A6%82%E4%BD%95%E8%AE%A9%E4%BD%A0%E7%9A%84-kitex-%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81%E5%87%BB%E8%B4%A5-99-%E7%9A%84%E7%94%A8%E6%88%B7/</link><pubDate>Fri, 20 Sep 2024 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2024/09/20/%E5%A6%82%E4%BD%95%E8%AE%A9%E4%BD%A0%E7%9A%84-kitex-%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81%E5%87%BB%E8%B4%A5-99-%E7%9A%84%E7%94%A8%E6%88%B7/</guid><description>
&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;h3 id="ä¸ºä»€ä¹ˆè¦ç”Ÿæˆä»£ç ">ä¸ºä»€ä¹ˆè¦ç”Ÿæˆä»£ç &lt;/h3>
&lt;p>æ¡†æ¶å¼€å‘æœ‰ä¸¤ç§å¸¸è§çš„é£æ ¼ï¼š Code First å’Œ Schema First&lt;/p>
&lt;p>ç®€å•æ¥è¯´ï¼ŒCode First å°±æ˜¯å…ˆå†™ä»£ç ï¼Œå†ç”±ä»£ç ç”Ÿæˆæ•°æ®æ¨¡å‹å’Œæ¥å£è§„èŒƒï¼ˆæ¯”å¦‚å…ˆä»£ç å†™ä¸€ä¸ª http æ¥å£ï¼Œç„¶åç”¨ Swagger æ¥ç”Ÿæˆ API ä¿¡æ¯ï¼‰&lt;/p>
&lt;p>è€Œ RPC å¼€å‘æ›´å¤šæ˜¯ Schema First ï¼Œå› ä¸º RPC æœåŠ¡å¯èƒ½æ˜¯è·¨è¯­è¨€çš„ï¼Œä¸ä¸€å®šä¼šå…ˆå†™ä»£ç ï¼Œè€Œæ˜¯ç”¨ Thriftã€Protobuf è¿™äº›é€šç”¨çš„ IDL æ¥æè¿°æ¥å£å’Œç»“æ„ä½“ï¼Œå†ç”Ÿæˆå¯¹åº”è¯­è¨€ã€å¯¹åº”æ¡†æ¶çš„å…·ä½“ä»£ç ã€‚&lt;/p>
&lt;p>ï¼ˆbtwï¼Œç”¨ IDL ç”Ÿæˆ RPC ä»£ç é€šå¸¸ä¹Ÿæ¯”æ‰‹æ“ä¸€å †ç»“æ„ä½“å’Œ Getter Setter è¦æ–¹ä¾¿ä¸å°‘ï¼‰&lt;/p>
&lt;p>Kitex RPC å¼€å‘æ­¥éª¤ä¹Ÿæ˜¯å…ˆå†™ IDLï¼Œå†ç”± Kitex Tool ç”Ÿæˆ Golang ä»£ç ï¼š&lt;/p>
&lt;ol>
&lt;li>IDL é‡Œçš„ç»“æ„ä½“å®šä¹‰ä¼šè¢«ç”Ÿæˆä¸º Golang çš„æ¡©ç»“æ„ä½“ï¼ˆå’Œä¸€äº› Getter Setterï¼‰&lt;/li>
&lt;li>IDL é‡Œ Service å’Œ Method ä¼šè¢«ç”Ÿæˆä¸º NewKitexClientã€NewKitexServerã€KitexServiceInfo è¿™äº›æ¡†æ¶ä½¿ç”¨ç›¸å…³çš„è„šæ‰‹æ¶å‡½æ•°&lt;/li>
&lt;/ol>
&lt;p>ä½†å¦‚æœä½ ä»”ç»†è§‚å¯Ÿè¿‡ kitex_gen çš„å†…å®¹ï¼Œä¼šå‘ç°ä¸Šé¢ä»£ç å æ¯”å¹¶ä¸å¤šï¼Œä¸»è¦æ˜¯ FastReadã€FastWrite è¿™äº›åºåˆ—åŒ–ç›¸å…³çš„å‡½æ•°å äº†å¾ˆå¤šè¡Œã€‚&lt;/p>
&lt;p>è¿™æ˜¯å› ä¸ºé™æ€ç”Ÿæˆçš„åºåˆ—åŒ–æ–¹æ€§èƒ½ä¼šæ›´é«˜ä¸€äº›ã€‚ï¼ˆå¯ä»¥ hardcode ç”Ÿæˆ hardcode ç±»å‹ã€å­—æ®µåç§°ç­‰ï¼Œä¸ç”¨èµ°åå°„ã€å‡å°‘å‡½æ•°è°ƒç”¨ç­‰ç­‰&amp;hellip;..ï¼‰&lt;/p>
&lt;p>æ­¤å¤–ï¼Œä¸€äº› Kitex çš„åŠŸèƒ½ç‰¹æ€§ä¹Ÿæ˜¯åŸºäºç”Ÿæˆçš„ä»£ç æ¥å®ç°çš„ï¼Œä¾‹å¦‚ Unknown Fields å’Œ Field Mask&lt;/p>
&lt;p>æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³è¿è¡Œä¸€ä¸ª Kitex RPC æœåŠ¡ï¼Œå°±éœ€è¦æ ¹æ® IDL æ¥ç”Ÿæˆè¿™äº›æ¡©ä»£ç ã€‚&lt;/p>
&lt;h3 id="ç”Ÿæˆä»£ç é‡Œæœ‰ä»€ä¹ˆ">ç”Ÿæˆä»£ç é‡Œæœ‰ä»€ä¹ˆ&lt;/h3>
&lt;p>ä»¥ Thrift åœºæ™¯ä¸ºä¾‹ï¼ŒKitex Tool ç”Ÿæˆå†…å®¹çš„ç›®å½•å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex_gen/
â”œâ”€â”€ base
â”‚ â”œâ”€â”€ base.go // ç»“æ„ä½“æ¡©ä»£ç  + æ™®é€šçš„åºåˆ—åŒ–ä»£ç 
â”‚ â”œâ”€â”€ k-base.go // FastCodec åºåˆ—åŒ–ä»£ç 
â”‚ â””â”€â”€ k-consts.go
â””â”€â”€ test
â”œâ”€â”€ example.go // ç»“æ„ä½“æ¡©ä»£ç  + æ™®é€šçš„åºåˆ—åŒ–ä»£ç 
â”œâ”€â”€ k-consts.go
â”œâ”€â”€ k-example.go // FastCodec åºåˆ—åŒ–ä»£ç 
â””â”€â”€ myservice // åˆ›å»º Kitex Client/Server çš„è„šæ‰‹æ¶
â”œâ”€â”€ client.go
â”œâ”€â”€ invoker.go
â”œâ”€â”€ myservice.go
â””â”€â”€ server.go
&lt;/code>&lt;/pre>&lt;p>å…¶ä¸­ï¼Œç»“æ„ä½“ç›¸å…³çš„ä»£ç å æ®äº†å¤§éƒ¨åˆ†ä½“ç§¯ï¼Œä¾‹å¦‚ Getter Setterã€FastReadã€FastWriteï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æ–¹æ³•å&lt;/th>
&lt;th>æè¿°&amp;amp;ç”¨é€”&lt;/th>
&lt;th>CodeGen å†…å®¹é•¿åº¦&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>InitDefault&lt;/td>
&lt;td>Frugal åœºæ™¯éœ€è¦&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GetXXXField/SetXXXField/IsSetXXXX&lt;/td>
&lt;td>GetterSetterï¼Œéƒ¨åˆ† interface éœ€è¦&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Read/ReadFieldX/Write/writeFieldX&lt;/td>
&lt;td>åŸç”Ÿ Apache Codec&lt;/td>
&lt;td>é•¿&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>String&lt;/td>
&lt;td>Stringer&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>DeepEqual/FieldXXXDeepEqual&lt;/td>
&lt;td>set å»é‡æé€Ÿ&lt;/td>
&lt;td>é•¿&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>DeepCopy&lt;/td>
&lt;td>RPAL åœºæ™¯éœ€è¦&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ThriftService æ¨¡æ¿&lt;/td>
&lt;td>ServiceInterface æè¿°æ¥å£å®šä¹‰&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>XXXClientFactoryã€XXXClientProtocol&lt;/td>
&lt;td>æ—§çš„ ThriftClient ä»£ç ï¼Œä¸å†æœ‰ç”¨&lt;/td>
&lt;td>è¾ƒé•¿&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>XXXProcessor&lt;/td>
&lt;td>æ—§çš„ Thrift Processor ä»£ç ï¼Œä¸å†æœ‰ç”¨&lt;/td>
&lt;td>è¾ƒé•¿&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>XXXServiceMethodArgs/Result&lt;/td>
&lt;td>Thrift ä¸º Method çš„å…¥å‚å’Œè¿”å›å€¼å•ç‹¬ç”Ÿæˆçš„ç±»å‹&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GetFirstArgument/GetResult&lt;/td>
&lt;td>argsã€result ä¸“ç”¨&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>FastRead/FastReadFieldX/FastWrite/FastWriteNocopy/BLength/fastWriteFieldX/fieldXLength&lt;/td>
&lt;td>FastCodec ç¼–è§£ç &lt;/td>
&lt;td>é•¿&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GetOrSetBase/GetOrSetBaseResp&lt;/td>
&lt;td>ç‰¹æ®Šçš„ Base ç›¸å…³æ¥å£ï¼Œæ¡†æ¶å†…éƒ¨ä½¿ç”¨&lt;/td>
&lt;td>çŸ­&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="äº§ç‰©è¿‡å¤§ä¼šæ€ä¹ˆæ ·">äº§ç‰©è¿‡å¤§ä¼šæ€ä¹ˆæ ·&lt;/h3>
&lt;p>ç°åœ¨å¾ˆå¤šæœåŠ¡éƒ½æœ‰äº†è‡ªå·±çš„ IDL å¤§ä»“åº“ï¼Œåœ¨å­—èŠ‚çš„å†…éƒ¨åœºæ™¯ä¸­ï¼Œç”šè‡³å‡ºç°äº† 6.8G çš„è¶…å¤§å‹ IDL ä»“åº“ï¼ŒåŒ…å«äº†ä¸Šç™¾ä¸‡ä¸ª commit&lt;/p>
&lt;p>è¿™ç§æƒ…å†µä¸‹ï¼Œéšç€ä¸šåŠ¡è¿­ä»£ï¼ŒIDL çš„å†…å®¹æ–°å¢å’Œç›¸äº’å¼•ç”¨ä¸æ–­å¢åŠ ï¼ˆå¤§å®¶æ²¡äº‹éƒ½ä¸ä¼šå»åˆ  IDLï¼Œæ‰€ä»¥åªä¼šè¶Šæ¥è¶Šå¤§ï¼‰ï¼Œæ‰€ä»¥ç”Ÿæˆ kitex_gen ä¹‹åï¼Œä¸ç®¡æœ‰çš„æ²¡çš„ï¼Œäº§ç‰©ä½“ç§¯å¯èƒ½ä¼šéå¸¸å¤§&lt;/p>
&lt;p>ä½“ç§¯å¤ªå¤§äº†ï¼Œä¼šå¯¼è‡´ï¼š&lt;/p>
&lt;ol>
&lt;li>ç”Ÿæˆè€—æ—¶ä¹Ÿå¾ˆé•¿ï¼Œå½±å“ç ”å‘æ•ˆç‡&lt;/li>
&lt;li>Goland åŠ è½½ç´¢å¼•è¦å¾ˆä¹…ï¼Œæˆ–è€…æ ¹æœ¬æ— æ³•åŠ è½½ï¼Œæ²¡è‡ªåŠ¨è¡¥å…¨äº†ï¼Œä»£ç éƒ½ä¸çŸ¥é“æ€ä¹ˆå†™äº†&lt;/li>
&lt;li>Git æäº¤çš„æ—¶å€™å†…å®¹å·¨å¤§ï¼ŒGit ä»“åº“ä¹Ÿè¶Šæ¥è¶Šå¤§äº†ï¼Œå½“ Git ä»“åº“è¶…è¿‡ 500MB åï¼Œ&lt;a href="https://github.com/golang/go/issues/29210">ç”šè‡³å¯èƒ½ go get éƒ½æ‹‰ä¸ä¸‹æ¥äº†&lt;/a>&lt;/li>
&lt;li>ç¼–è¯‘å¾ˆæ…¢ã€ç”šè‡³ç¼–è¯‘æ—¶ç¬¦å·è¡¨è¿‡å¤§&lt;a href="https://github.com/golang/go/issues/17378">ç›´æ¥ç¼–è¯‘å¤±è´¥&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>æ‰€ä»¥è¿™ç§æ—¶å€™ï¼Œä¸å¾—ä¸æåˆ°äº§ç‰©ä¼˜åŒ–æ²»ç†äº†ï¼ˆé¡ºä¾¿èƒ½è®©ç”Ÿæˆé€Ÿåº¦æ›´å¿«ï¼‰&lt;/p>
&lt;h2 id="ä¼˜åŒ–æ‰‹æ®µ">ä¼˜åŒ–æ‰‹æ®µ&lt;/h2>
&lt;p>è¿‡å»åŠå¹´ï¼Œæˆ‘ä»¬å¯¹ç”Ÿæˆé€Ÿåº¦å’Œä½“ç§¯ä¼˜åŒ–è¿›è¡Œäº†ä¸€è½®æ¢ç´¢ï¼Œæ€»ç»“äº†ä¸å°‘æœ‰ç”¨çš„æ‰‹æ®µã€‚&lt;/p>
&lt;p>è™½ç„¶ç”±äºå†å²åŒ…è¢±æˆ–å…¶ä»–åŸå› ï¼Œæˆ‘ä»¬æ²¡æŠŠè¿™äº›æ‰‹æ®µç›´æ¥ä½œä¸º kitex tool çš„é»˜è®¤è¡Œä¸ºï¼Œä½†ä¹Ÿç»è¿‡äº†ç¨³å®šçš„éªŒè¯å’Œä¸€äº›å­—èŠ‚å†…éƒ¨åœºæ™¯çš„è½åœ°æ¥å…¥&lt;/p>
&lt;p>å¦‚æœä½ çš„æœåŠ¡ä¹Ÿå—ä»£ç ç”Ÿæˆçš„å›°æ‰°ï¼Œä¸‹é¢çš„æ–¹æ³•æ€»æœ‰ä¸€æ¬¾é€‚åˆä½ ~&lt;/p>
&lt;h3 id="idl-è£åˆ‡">IDL è£åˆ‡&lt;/h3>
&lt;p>ç‰¹ç‚¹ï¼šå¤§å¹…å‡å°‘äº§ç‰©ä½“ç§¯ã€æé«˜ç”Ÿæˆé€Ÿåº¦&lt;/p>
&lt;h4 id="ç®€ä»‹">ç®€ä»‹&lt;/h4>
&lt;p>ç®€å•æ¥è¯´ï¼Œå¾ˆå¤šé¡¹ç›®çš„ Thrift IDL æœ‰å¤§é‡å†—ä½™å†…å®¹ï¼Œåªéœ€è¦ç”Ÿæˆæ‰€æœ‰ Method ç›´æ¥æˆ–è€…é—´æ¥å¼•ç”¨åˆ°çš„ç»“æ„ä½“å°±å¥½äº†ï¼Œå…¶ä»–æ— å…³å†…å®¹å¯ä»¥å‰”é™¤æ‰ã€‚&lt;/p>
&lt;p>IDL è£åˆ‡å·¥å…·èƒ½è‡ªåŠ¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œä½¿å¾— Kitex ä»£ç ç”Ÿæˆé€Ÿåº¦å’Œäº§ç‰©ä½“ç§¯éƒ½å¾—åˆ°å¾ˆå¤§çš„ä¼˜åŒ–ã€‚æ ¹æ®ä¸€äº›å­—èŠ‚å†…éƒ¨å¤§ä»“åº“çš„è¯•ç‚¹ï¼Œç”Ÿæˆè€—æ—¶å‡åŠã€äº§ç‰©ä½“ç§¯å‡å°‘ 60%+ ï¼ˆä½ çš„ IDL è¶Šå¤§ï¼Œé‡Œé¢çš„å†—ä½™å†…å®¹è¶Šå¤šï¼Œæ•ˆæœè¶Šå¥½ï¼‰&lt;/p>
&lt;h4 id="ä½¿ç”¨">ä½¿ç”¨&lt;/h4>
&lt;p>åœ¨ kitex å‘½ä»¤æ‰§è¡Œæ—¶ï¼Œé¢å¤–æ·»åŠ  &lt;code>-thrift trim_idl&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex -module xx -thrift trim_idl xxxx.thrift
&lt;/code>&lt;/pre>&lt;p>å·¥å…·åœ¨æ‰§è¡Œæ—¶ï¼Œä¼šè§£æ IDL ç„¶ååªä¿ç•™æ‰€æœ‰ Method ç›´æ¥æˆ–é—´æ¥ç”¨åˆ°çš„ç»“æ„ä½“ï¼Œä»¥æœ€å¿«çš„é€Ÿåº¦ç”Ÿæˆæœ€ç®€æ´çš„äº§ç‰©ï¼Œå¹¶åŒæ—¶è¾“å‡ºä¸€ä¸ªè£åˆ‡æ•ˆæœçš„æŠ¥å‘Šï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_codegen_practices/wanring.jpg" alt="image">&lt;/p>
&lt;h4 id="è¿›é˜¶">è¿›é˜¶&lt;/h4>
&lt;blockquote>
&lt;p>æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼ŒæŸä¸ªè¶…å¤§ IDL æœ‰ 100 ä¸ª Methodï¼Œä½† A å›¢é˜Ÿåªç”¨å…¶ä¸­ 5 ä¸ª Methodï¼ŒB å›¢é˜Ÿåªç”¨å¦å¤– 10 ä¸ª Methodï¼Œå¯¹äºæ¯ä¸ªå›¢é˜Ÿè€Œè¨€ï¼Œä¸éœ€è¦ç”Ÿæˆ 100 ä¸ª Method ä»¥åŠæ‰€æœ‰çš„ç»“æ„ä½“&lt;/p>
&lt;/blockquote>
&lt;p>è£åˆ‡å·¥å…·æä¾›äº† -method ï¼Œç»†ç²’åº¦åˆ°æ–¹æ³•çº§åˆ«åšè£åˆ‡ï¼Œä»¥è§£å†³ä¸Šé¢æåˆ°çš„åœºæ™¯ï¼Œè¯¦è§&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/idl_trimmer">æŒ‡å®š Method è£åˆ‡&lt;/a>&lt;/p>
&lt;h3 id="no_fmt-æé€Ÿ">no_fmt æé€Ÿ&lt;/h3>
&lt;p>ç‰¹ç‚¹ï¼šä»£ç ç”Ÿæˆæé€Ÿ 50%&lt;/p>
&lt;h4 id="ç®€ä»‹-1">ç®€ä»‹&lt;/h4>
&lt;p>åœ¨åˆ†æä¸€äº›å¤æ‚ IDL åœºæ™¯ç”Ÿæˆæ…¢çš„ç«ç„°å›¾æ—¶ï¼Œå‘ç° Kitex Tool é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒ interesting çš„æƒ…å†µï¼šç”Ÿæˆä»£ç åï¼Œå¯¹äº§ç‰©è¿›è¡Œ go fmt æ•´ç†çš„è€—æ—¶å±…ç„¶å äº†ä¸€åŠ&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_codegen_practices/profile.png" alt="image">&lt;/p>
&lt;p>æ‰€ä»¥ï¼Œå¦‚æœä½ ä¸æ˜¯å¾ˆå…³å¿ƒäº§ç‰©ä»£ç çš„æ ¼å¼æ•´ä¸æ•´é½ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡è¿™ä¸ªæ“ä½œï¼Œç”Ÿæˆé€Ÿåº¦é©¬ä¸Šå°±å¿« 50% äº†&lt;/p>
&lt;p>è™½ç„¶å¾ˆç²—æš´ï¼Œä½†ç¡®å®å¾ˆæœ‰ç”¨ ğŸ˜‚&lt;/p>
&lt;p>ï¼ˆå½“ç„¶æˆ‘ä»¬ä¹Ÿè¯•è¿‡å¯¹ç«ç„°å›¾å·¦è¾¹çš„ template åº•å±‚çš„åå°„å¼€é”€åšä¼˜åŒ–ï¼Œé¢„ä¼°å¿« 20%ï¼Œä½†æ”¹é€ å’Œå½±å“æœ‰ç‚¹å¤§ã€‚ç›´æ¥æ— è„‘å»æ‰ no_fmt æé€Ÿ 50% åï¼Œé€Ÿåº¦å°±å·²ç»å¯ä»¥æ¥å—äº†ï¼Œæ‰€ä»¥å°±æ²¡ç»§ç»­æäº†ï¼‰&lt;/p>
&lt;p>å­—èŠ‚å†…éƒ¨çš„äº§ç‰©å¹³å°é€šè¿‡è¯¥æ–¹å¼ï¼Œä»£ç ç”Ÿæˆè€—æ—¶ P90 ä» 80s ä¸‹é™åˆ°äº† 20s ï¼ŒèŠ‚çº¦äº†äº† 60s (70%)&lt;/p>
&lt;h4 id="ä½¿ç”¨-1">ä½¿ç”¨&lt;/h4>
&lt;p>åœ¨ kitex å‘½ä»¤æ‰§è¡Œæ—¶ï¼Œé¢å¤–æ·»åŠ  &lt;code>-thrift no_fmt&lt;/code> å³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex -module xx -thrift no_fmt xxxx.thrift
&lt;/code>&lt;/pre>&lt;p>äº§ç‰©ä¼šæœ‰ä¸€äº›ç©ºè¡Œæˆ–è€…ç¼©è¿›ä¸Šçš„ä¸æ•´é½ï¼Œä½†å¾€å¾€ kitex_gen é‡Œé¢çš„å¤§é‡å†…å®¹éƒ½æ˜¯æ²¡äººçœ‹çš„ï¼Œæ‰€ä»¥ä¹Ÿæ— æ‰€è°“äº†&lt;/p>
&lt;h3 id="åˆ é™¤-processor">åˆ é™¤ Processor&lt;/h3>
&lt;p>ç‰¹ç‚¹ï¼šäº§ç‰©ä½“ç§¯å‡å°çº¦ 10%ï¼Œé€Ÿåº¦ç­‰æ¯”æå‡&lt;/p>
&lt;p>v0.10.0+ åçš„ kitex tool å·²é»˜è®¤ä½¿ç”¨è¯¥ç­–ç•¥&lt;/p>
&lt;h4 id="ç®€ä»‹-2">ç®€ä»‹&lt;/h4>
&lt;p>å› ä¸ºä¸€äº›å†å²åŸå› ï¼ˆä»¥å‰å¯¹ç…§ apache thrift çš„ä¸€äº›æ— ç”¨å®ç°ï¼‰ï¼Œkitex_gen ä¼šæœ‰äº›æ²¡ç”¨çš„ä»£ç ï¼Œå½¢å¦‚ XXXClientFactoryã€XXXClientProtocolã€XXXProcessorï¼š&lt;/p>
&lt;p>è¿™éƒ¨åˆ†ä»£ç åŸæœ¬æ˜¯ apache thrift åœºæ™¯ç”¨æ¥åˆ›å»º service å’Œ client çš„ï¼Œä½†åœ¨ kitex ä¸­ï¼Œä¼šå•ç‹¬ç”Ÿæˆ xxxservice ç›®å½•ï¼Œä»¥åŠ client.goã€server.go è¿™äº› kitex server å’Œ kitex client çš„å®ç°ã€‚&lt;/p>
&lt;p>ç»ç¡®è®¤ï¼Œåœ¨ Kitex åœºæ™¯ä¸‹ï¼Œè¿™éƒ¨åˆ†å†…å®¹å·²ç»å®Œå…¨æ²¡è¢«ä½¿ç”¨äº†ï¼ˆä¸šåŠ¡ä»£ç é‡Œä¹Ÿä¸ä¼šå¼•ç”¨åˆ°ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥ä»ç”Ÿæˆä»£ç é‡Œé€æ¸æŠŠè¿™äº›å†…å®¹ç§»é™¤æ‰ã€‚ä» IDL æµ‹è¯•çš„å¹³å‡å€¼æ¥çœ‹ï¼Œäº§ç‰©ä½“ç§¯ä¼˜åŒ–çº¦ 10%ï¼Œé€Ÿåº¦ç•¥å¾®æå‡&lt;/p>
&lt;h4 id="ä½¿ç”¨-2">ä½¿ç”¨&lt;/h4>
&lt;p>åœ¨ Kitex ä»£ç ç”Ÿæˆå·¥å…· v0.10.0 ä¹‹åï¼Œä¼šè‡ªåŠ¨ä¸ç”Ÿæˆè¿™éƒ¨åˆ†å†…å®¹&lt;/p>
&lt;p>å¦‚æœä½ çš„å·¥å…·æ˜¯æ—§ç‰ˆæœ¬ï¼Œæ·»åŠ  &lt;code>-thrift no_processor&lt;/code> å‚æ•°å³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex -module xx -thrift no_processor xxxx.thrift
&lt;/code>&lt;/pre>&lt;p>è¡¥å……è¯´æ˜&lt;/p>
&lt;p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æ”¾å¿ƒçš„å»æ‰è¿™éƒ¨åˆ†ä»£ç ï¼Œå› ä¸ºç¡®å®ç”¨ä¸åˆ°ã€‚ä½†ä»¥é˜²æ„å¤–ï¼Œå¦‚æœ v0.10.0 çš„é»˜è®¤å»é™¤è¡Œä¸ºç¡®å®å½±å“åˆ°ä½ çš„ä»£ç äº†ï¼Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ç­‰æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ &lt;code>-thrift no_processor=false&lt;/code> æ¥é˜»æ­¢è¿™ä¸€è¡Œä¸ºï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex -module xx -thrift no_processor=false xxxx.thrift
&lt;/code>&lt;/pre>&lt;p>å¹¶è”ç³» Cloudwego ç¤¾åŒºï¼Œè¿›è¡Œåç»­æ”¯æŒ&lt;/p>
&lt;h3 id="åˆ é™¤-deep-equal">åˆ é™¤ Deep Equal&lt;/h3>
&lt;p>ç‰¹ç‚¹ï¼šäº§ç‰©ä½“ç§¯å‡å°çº¦ 20%ï¼Œé€Ÿåº¦ç­‰æ¯”ä¾‹æå‡&lt;/p>
&lt;h4 id="ç®€ä»‹-3">ç®€ä»‹&lt;/h4>
&lt;p>Kitex å¯¹ Thrift IDL çš„ set ç±»å‹ç”Ÿæˆæ˜¯æ•°ç»„ï¼Œä¼šè¿›è¡Œå»é‡æ£€æŸ¥&lt;/p>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šä¸ºæ¯ä¸ªç»“æ„ä½“ç”Ÿæˆ DeepEqual æ–¹æ³•ï¼Œå› ä¸ºé™æ€ç”Ÿæˆçš„æ€§èƒ½å¥½ã€‚å¦‚æœä¸ç”Ÿæˆï¼Œå°±é»˜è®¤ç”¨åå°„åº“çš„ reflect.DeepEqual ï¼ˆæ€§èƒ½æ…¢ï¼‰&lt;/p>
&lt;p>å¦‚æœåœ¨ç”¨ä¸åˆ° set æˆ–ç”¨çš„ä¸å¤šçš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä¸ç”Ÿæˆ DeepEqual æ–¹æ³•æ¥èŠ‚çº¦ä½“ç§¯&lt;/p>
&lt;h4 id="ä½¿ç”¨-3">ä½¿ç”¨&lt;/h4>
&lt;p>æ·»åŠ å‚æ•° &lt;code>-thrift gen_deep_equal=false&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex -module xxx -thrift gen_deep_equal=false xxx.thrift
&lt;/code>&lt;/pre>&lt;h4 id="æ³¨æ„">æ³¨æ„&lt;/h4>
&lt;p>å‰”é™¤è¿™ä¸ªæ¥ä¼˜åŒ–äº§ç‰©çš„å‰ææ˜¯ä¸å¯¹ set æœ‰å¤§é‡ä½¿ç”¨ï¼Œå¦‚æœ set ä½¿ç”¨çš„åœ°æ–¹å¾ˆå¤šï¼Œæˆ–è€… set é‡Œçš„å…ƒç´ æ•°é‡å¾ˆå¤§ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæœ‰æ€§èƒ½ä¸‹é™çš„é—®é¢˜&lt;/p>
&lt;p>ä½†å¦‚æœä½ åœ¨ä½¿ç”¨ set ä¹‹å‰ï¼Œå·²ç»å¯¹å†™å…¥çš„å…ƒç´ åšäº†å»é‡æ£€æŸ¥ï¼Œé‚£å…¶å® Kitex æ¡†æ¶é‡Œçš„è¿™æ­¥äºŒæ¬¡æ£€æŸ¥å°±æ˜¯å¤šä½™çš„äº†ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ -thrift validate_set=false æ¥å…³é—­æ£€æŸ¥ï¼Œåè€ŒèŠ‚çº¦ä¸€æ¬¡å¤šä½™çš„è®¡ç®—å¼€é”€&lt;/p>
&lt;p>åç»­æˆ‘ä»¬ä¼šé’ˆå¯¹ Deep Equal ä»¥åŠ Set çš„å»é‡ç”¨æ³•åšæ›´åˆç†çš„å®ç°ï¼Œä¿è¯äº§ç‰©ç²¾ç®€é«˜æ•ˆ&lt;/p>
&lt;h3 id="åˆ é™¤-apache-codec">åˆ é™¤ Apache Codec&lt;/h3>
&lt;p>ç‰¹ç‚¹ï¼šäº§ç‰©ä½“ç§¯å‡å°çº¦ 50%ï¼Œé€Ÿåº¦ç­‰æ¯”ä¾‹æå‡&lt;/p>
&lt;h4 id="èƒŒæ™¯">èƒŒæ™¯&lt;/h4>
&lt;blockquote>
&lt;p>ä¸ºä»€ä¹ˆ Kitex ä»£ç é‡Œæœ‰ä¸¤å¥—ç¼–è§£ç &lt;/p>
&lt;/blockquote>
&lt;p>kitex_gen é‡Œä¼šç”Ÿæˆ Apache Codec å’Œ Fast Codec ä¸¤å¥—ç¼–è§£ç ã€‚Fast Codec æ€§èƒ½æ›´å¥½ï¼Œä½†éœ€è¦ä»åè®®é‡Œè¯»åˆ° payload size æ‰èƒ½ç”¨ï¼Œæ‰€ä»¥åªæœ‰ TTHeaderã€Framed åœºæ™¯èƒ½ç”¨
ç»å¤§å¤šæœåŠ¡éƒ½æ¥å…¥äº†ä½¿ç”¨ TTHeaderï¼Œæˆ–æ‰‹åŠ¨è®¾ç½®äº† Framedï¼Œæ‰€ä»¥ç›´æ¥ç”¨ Fast Codec&lt;/p>
&lt;p>è¿™å°±æœ‰äº†ä¸€ä¸ªæƒ³æ³•ï¼š å¯¹å¤§éƒ¨åˆ†æœåŠ¡ï¼ŒApache Codec å äº†å¿« 50% çš„ä½“ç§¯ï¼Œè€Œä¸”åŸºæœ¬æ²¡ç”¨ï¼Œåªæ˜¯ç”¨æ¥å…œåº•çš„
å¦‚æœèƒ½è®© Thrift Buffered ä¹Ÿèƒ½èµ° Fast Codecï¼Œå°±æ²¡å¿…è¦ä¿ç•™ Apache Codec äº†
å¯ä»¥æŠŠæœåŠ¡çš„é»˜è®¤åè®®ä» Buffered æ”¹ä¸º Framed&lt;/p>
&lt;h4 id="ç®€ä»‹-4">ç®€ä»‹&lt;/h4>
&lt;p>åœ¨ Kitex v0.10.0 é‡Œï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ª SkipDecoderï¼Œå¯ä»¥è®© Thrift Buffered åœºæ™¯ä¹Ÿèƒ½èµ° Fast Codec ç¼–è§£ç ï¼Œè€Œä¸éœ€è¦ Apache Codec å…œåº•äº†ï¼Œé€šè¿‡è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å°±å¯ä»¥åœ¨ä»“åº“é‡Œå°‘ç”Ÿæˆä¸€åŠçš„ä»£ç &lt;/p>
&lt;p>åŒæ—¶ Kitex v0.10.0 ä¹ŸæŠŠé»˜è®¤åè®®è®¾ç½®ä¸ºäº† Framedï¼Œè¿›ä¸€æ­¥å‡å°‘äº†çº¿ä¸Šçš„ Apache Codec ä½¿ç”¨ç©ºé—´ã€‚&lt;/p>
&lt;h4 id="ä½¿ç”¨-4">ä½¿ç”¨&lt;/h4>
&lt;p>ä¿è¯ä½ çš„ Kitex ç‰ˆæœ¬é«˜äº v0.10.0
é‡æ–°åšä»£ç ç”Ÿæˆï¼Œæ·»åŠ  &lt;code>-thrift no_default_serdes&lt;/code> å‚æ•°&lt;/p>
&lt;pre tabindex="0">&lt;code>kitex -module xxx -thrift no_default_serdes xxx.thrift
&lt;/code>&lt;/pre>&lt;p>è¿™æ ·ç”Ÿæˆçš„ä»£ç å°±æ²¡æœ‰ Apache Codec å†…å®¹ï¼Œå°‘äº†ä¸€å¤§åŠä½“ç§¯
å¼€å¯ Skip Decoderï¼Œåœ¨ NewClient æˆ– NewServer çš„æ—¶å€™æ·»åŠ å¦‚ä¸‹å‚æ•°ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>import (
&amp;#34;github.com/cloudwego/kitex/pkg/remote/codec/thrift&amp;#34;
&amp;#34;demo/kitex_gen/kitex/samples/echo/echoservice&amp;#34;
)
func main() {
cli := echoservice.MustNewClient(&amp;#34;kitex.samples.echo&amp;#34;,
client.WithPayloadCodec(thrift.NewThriftCodecWithConfig(thrift.FastRead|thrift.FastWrite|thrift.EnableSkipDecoder)),
)
srv := echoservice.NewServer(handler,
server.WithPayloadCodec(thrift.NewThriftCodecWithConfig(thrift.FrugalWrite|thrift.FrugalRead|thrift.EnableSkipDecoder)),
)
}
&lt;/code>&lt;/pre>&lt;p>è¿™æ ·ï¼Œå½“ä½ çš„æœåŠ¡æ”¶åˆ° Thrift Buffered æŠ¥æ–‡æ—¶ï¼Œä¼šé€šè¿‡ SkipDecoder + FastCodec å®Œæˆç¼–è§£ç ï¼Œä¸å†ä¾èµ– Apache Codec&lt;/p>
&lt;h4 id="æ³¨æ„-1">æ³¨æ„&lt;/h4>
&lt;p>Skip Decoder åŠŸèƒ½å·²ç»æ­£å¼å‘å¸ƒäº†ï¼Œä½†è¿˜éœ€æ‰‹åŠ¨å¼€å¯ã€‚åç»­è®¡åˆ’ Skip Decoder é»˜è®¤å¯ç”¨&lt;/p>
&lt;p>ä¸€æ—¦ä½¿ç”¨äº† &lt;code>-thrift no_default_serdes&lt;/code> ä»ç”Ÿæˆä»£ç é‡Œå»é™¤äº† Apache Codecï¼Œå¯¹åº”çš„ Kitex Client / Kitex Server è¦æ·»åŠ  Skip Decoder é…ç½®ï¼Œå¦åˆ™å½“æ”¶åˆ°å¯¹ç«¯çš„ Thrift Buffered æŠ¥æ–‡æ—¶ï¼Œä¼šæ— æ³•è§£æï¼Œæ‰€æœ‰è¯·æ±‚æŠ¥é”™å¤±è´¥ï¼&lt;/p>
&lt;p>Apache Codec çš„åºåˆ—åŒ–å®ç°æ˜¯è¯»ä¸€æ®µå†…å®¹è§£æä¸€æ®µå†…å®¹ï¼Œè€Œ Skip Decoder å’Œ Fast Codec çš„åºåˆ—åŒ–å®ç°éƒ½æ˜¯ä¸€æ¬¡è¯»å®Œæ‰€æœ‰å†…å®¹ç„¶åæ•´ä½“è§£æï¼Œè¿™æ ·è™½ç„¶é€Ÿåº¦æ›´å¿«äº†ï¼Œä½†å ç”¨å†…å­˜ä¼šå¤šä¸€äº›ã€‚ç»å¤§éƒ¨åˆ†æƒ…å†µæ— æ‰€è°“ã€‚ä½†å¦‚æœä½ çš„æœåŠ¡æ¯”è¾ƒç‰¹æ®Šï¼Œæ¯”å¦‚ä¸€æ¬¡è¯»çš„å†…å®¹éå¸¸å¤§ï¼Œä¸ºäº†é¿å…å†…å­˜è¿‡å¤§ï¼Œæ˜ç¡®è®¾ç½®è¿‡ç¦ç”¨ Fast Codecï¼Œé€šè¿‡ Apache Codec æ¥ç¼–è§£ç ï¼Œè¿™ç§åœºæ™¯ä¸‹ï¼Œè¯·è°¨æ…è€ƒè™‘è¿™ä¸ªç‰¹æ€§ã€‚&lt;/p>
&lt;h4 id="ä½ç‰ˆæœ¬å¦‚ä½•æ“ä½œ">ä½ç‰ˆæœ¬å¦‚ä½•æ“ä½œ&lt;/h4>
&lt;p>å¦‚æœ Kitex ç‰ˆæœ¬ä½äº v0.10.0ï¼Œæ²¡æœ‰ SkipDecoder èƒ½åŠ›æ¥å…œåº• Thrift Buffered åœºæ™¯ï¼Œä½†ä¹Ÿæƒ³åˆ é™¤ Apache Codec æ¥æ²»ç†äº§ç‰©ä½“ç§¯ï¼Œæ€è·¯å¦‚ä¸‹&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ç¡®ä¿ä½ çš„æœåŠ¡ï¼Œä»¥åŠä¸Šä¸‹æ¸¸æœåŠ¡ï¼Œéƒ½ä¸é‡‡ç”¨ Thrift Buffered åè®®ï¼Œå¦‚æœæ˜¯ Kitexï¼Œé‚£ä¹ˆæŠŠä»–ä»¬è‡³å°‘éƒ½è®¾ç½®ä¸º Framed åè®®ï¼Œè¿™æ ·å°±èµ°ä¸åˆ° Apache Codec çš„é€»è¾‘äº†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”Ÿæˆä»£ç æ·»åŠ  &lt;code>-thrift no_default_serdes&lt;/code> æ¥å‡å°‘ä¸€åŠçš„äº§ç‰©ä½“ç§¯&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>è¿™æ ·åšæœ‰ä¸€äº›é£é™©ç‚¹ï¼š&lt;/p>
&lt;p>å¦‚æœæŸä¸ªæœåŠ¡è€ƒè™‘æ¼äº†ï¼Œå‘é€äº† Buffered åè®®ï¼Œé‚£ä¹ˆè¿™äº›è¯·æ±‚éƒ½ä¼šå¤±è´¥&lt;/p>
&lt;p>å¦‚æœä½ çš„ä¸‹æ¸¸æœ‰ä¸€äº›å¾ˆæ—§çš„å…¶ä»–æ¡†æ¶ï¼ˆä¾‹å¦‚è€ç‰ˆæœ¬çš„ Java æ¡†æ¶ï¼‰ï¼Œä¸æ”¯æŒ Buffered åè®®ï¼Œé‚£ä¹ˆè¿™æ¡é“¾è·¯å°±ä¸èƒ½è¿™ä¹ˆæ&lt;/p>
&lt;p>æ‰€ä»¥æ¨èè¿˜æ˜¯å‡çº§ Kitex ç‰ˆæœ¬åˆ° v0.10.0ï¼Œç”¨ Skip Decoder çš„èƒ½åŠ›æ¥å…œåº•&lt;/p>
&lt;h3 id="frugal">Frugal&lt;/h3>
&lt;p>ç‰¹ç‚¹ï¼šäº§ç‰©ä½“ç§¯å‡å°çº¦ 90%ï¼Œé€Ÿåº¦ç­‰æ¯”ä¾‹æå‡&lt;/p>
&lt;h4 id="ç®€ä»‹-5">ç®€ä»‹&lt;/h4>
&lt;p>Frugal æ˜¯ä¸€æ¬¾åŠ¨æ€çš„ä¸éœ€è¦ç¼–è§£ç ä»£ç çš„ Thrift ç¼–è§£ç å™¨ï¼Œé€šè¿‡å¯ç”¨ slim æ¨¡æ¿ï¼ŒKitex å¯ä»¥åªç”Ÿæˆ Golang Typesï¼Œä¸Šæ–‡æåˆ°çš„ Apache Codec å’Œ Fast Codec éƒ½ä¸éœ€è¦äº†ï¼Œç¼–è§£ç åœ¨è¿è¡Œæ—¶é€šè¿‡åå°„æˆ– JIT å®ç°ã€‚è¿™æ ·å¯ä»¥å¤§å¹…å‡å°‘ç”Ÿæˆçš„ä»£ç é‡ï¼Œå‡å°‘ IDE åŠ è½½æ—¶é—´ï¼Œç›¸æ¯”æ­£å¸¸çš„ kitex_genï¼Œä½“ç§¯ç¼©å° 90%ï¼Œä¸”æ€§èƒ½ä»ç„¶è¾ƒé«˜ã€‚&lt;/p>
&lt;h4 id="ä½¿ç”¨-5">ä½¿ç”¨&lt;/h4>
&lt;p>è¯´æ¥è¯é•¿ï¼Œæ­¥éª¤ç›¸å¯¹è¾ƒå¤šï¼Œè¯¦è§ï¼šhttps://github.com/cloudwego/frugal&lt;/p>
&lt;h4 id="æ³¨æ„-2">æ³¨æ„&lt;/h4>
&lt;p>ç›®å‰ Frugal æ˜¯åŸºäº JIT å®ç°çš„ï¼Œæ‰€ä»¥ï¼š&lt;/p>
&lt;ul>
&lt;li>JIT é¦–æ¬¡ç¼–è§£ç è€—æ—¶ä¼šé•¿ä¸€äº›ï¼Œå¯èƒ½ä¼šå½±å“é¦–æ‰¹è¯·æ±‚çš„è€—æ—¶&lt;/li>
&lt;li>ä¹Ÿå¯ä»¥åœ¨æœåŠ¡å¯åŠ¨æ—¶å°±é€šè¿‡ Pretouch é¢„çƒ­ï¼Œä½†å½“ IDL éå¸¸å¤æ‚çš„æ—¶å€™ï¼Œå¯åŠ¨æ—¶é—´ä¼šå¢åŠ &lt;/li>
&lt;li>ç›®å‰ä¸æ”¯æŒ Unknown Fields ç‰¹æ€§&lt;/li>
&lt;li>åœ¨ ARM64 åœºæ™¯è¿˜å¤„åœ¨è¯•éªŒæ€§çš„æ”¯æŒä¸­&lt;/li>
&lt;/ul>
&lt;h4 id="å…¶ä»–">å…¶ä»–&lt;/h4>
&lt;p>è¿‘æœŸæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŸºäº Golang åå°„ç‰ˆçš„ Frugalï¼Œå¯¹ä¸åŒç³»ç»Ÿçš„å…¼å®¹æ€§è¾ƒå¥½ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šæœ‰å¤ªä¸¥é‡çš„é¦–æ¬¡è€—æ—¶ï¼Œåç»­ä¼šæ›´æ–°æ–‡æ¡£å’Œç›¸å…³ä½¿ç”¨æ–¹å¼&lt;/p>
&lt;p>é•¿æœŸè§„åˆ’ä¸­ï¼Œæˆ‘ä»¬æœŸæœ› Frugal èƒ½é€æ¸å¹¿æ³›è½åœ°ï¼Œè®©ç»å¤§å¤šæ•° Kitex é¡¹ç›®ä¸å†éœ€è¦ç”Ÿæˆå¤§é‡ä»£ç ï¼Œåªæœ‰å½“å¯¹æ€§èƒ½æœ‰æ›´é«˜è¦æ±‚çš„åœºæ™¯ï¼Œæ‰ä½¿ç”¨ FastCodec è¿™ç§é™æ€ç”Ÿæˆçš„ç¼–è§£ç ã€‚&lt;/p>
&lt;h3 id="è¿›é˜¶-å·¥å…·-sdk-åŒ–">è¿›é˜¶: å·¥å…· SDK åŒ–&lt;/h3>
&lt;p>é€Ÿåº¦é¢„è®¡ä¼˜åŒ– 10%~25%ï¼Œæ˜“ç”¨æ€§å’Œç»´æŠ¤æ€§æœ‰æå‡&lt;/p>
&lt;blockquote>
&lt;p>è¿™æ˜¯ä¸ªè¿›é˜¶åŠŸèƒ½ï¼Œå¦‚æœä½ æ˜¯æŸä¸ª Kitex Tool ç›¸å…³çš„ä»£ç ç”Ÿæˆé¡¹ç›®ç»´æŠ¤è€…ï¼Œå¯èƒ½ä¼šå¯¹ä½ æœ‰å¸®åŠ©&lt;/p>
&lt;/blockquote>
&lt;h4 id="ç®€ä»‹-6">ç®€ä»‹&lt;/h4>
&lt;p>å½“è¦ä½¿ç”¨ Kitex Tool ç”Ÿæˆä»£ç ï¼Œä»¥å¾€éƒ½åªèƒ½å®‰è£… Kitex Tool ï¼ˆä»¥åŠ Thriftgoã€Validator ç­‰å·¥å…·é“¾ï¼‰ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤æ¥è§¦å‘ã€‚ä¸€äº›ä»£ç ç”Ÿæˆé¡¹ç›®ï¼Œæ˜¯é€šè¿‡åœ¨ Golang ä»£ç é‡Œèµ·ä¸€ä¸ªè¿›ç¨‹ï¼Œé€šè¿‡ os.Exec æ¥è°ƒç”¨æœ¬åœ°çš„ Kitex Toolï¼Œå®ç°ä»£ç ç”Ÿæˆçš„ã€‚&lt;/p>
&lt;p>ä¹‹å‰è¿™æ ·è®¾è®¡æ˜¯æƒ³ç€èƒ½è·¨è¯­è¨€ã€æ’ä»¶è¿›ç¨‹å¯æ‹”æ’ï¼Œä¸è¿‡å®é™…åœºæ™¯ç”¨åˆ°çš„å¾ˆå°‘ã€‚æ‰€ä»¥åœ¨ v0.11.0 ä¹‹åï¼ŒKitex Tool æä¾›äº† SDK åŒ–è°ƒç”¨çš„èƒ½åŠ›ï¼Œå¯ä»¥é€šè¿‡å¼•å…¥ä¾èµ–åŒ… + Golang å‡½æ•°æ¥ç”Ÿæˆä»£ç ï¼Œè€Œæ— éœ€å†å®‰è£… Kitex Toolã€Thriftgoã€Validator æ’ä»¶ç­‰ä¸€ç³»åˆ—å·¥å…·é“¾äº†&lt;/p>
&lt;h4 id="ä½¿ç”¨-6">ä½¿ç”¨&lt;/h4>
&lt;p>é¦–å…ˆå¼•å…¥ä¾èµ–åŒ…ï¼š &lt;code>import &amp;quot;github.com/cloudwego/kitex/tool/cmd/kitex/sdk&amp;quot;&lt;/code>&lt;/p>
&lt;p>æ¥å£ç­¾åå¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>func RunKitexTool(wd string, plugins []plugin.SDKPlugin, kitexArgs ...string) error
&lt;/code>&lt;/pre>&lt;p>å‚æ•°å«ä¹‰ï¼š&lt;/p>
&lt;ul>
&lt;li>wdï¼šæƒ³åœ¨å“ªä¸ªè·¯å¾„ä¸‹æ‰§è¡Œ kitex tool å‘½ä»¤&lt;/li>
&lt;li>pluginsï¼šæƒ³åŒæ—¶å†…åµŒæ‰§è¡Œå“ªäº›æ’ä»¶ï¼Œä¾‹å¦‚ Validator æ’ä»¶ï¼Œä¹Ÿå®ç°äº†å¯¹åº”çš„æ¥å£ã€‚ä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œå†™ nil å³å¯&lt;/li>
&lt;li>kitexArgsï¼šæƒ³æ‰§è¡Œå“ªäº›å‚æ•°ï¼ŒæŒ‰ kitex tool çš„å¸¸è§„å†™æ³•æ¥ï¼Œç„¶åç©ºæ ¼æ‹†åˆ†æˆæ•°ç»„ä¼ å…¥å³å¯&lt;/li>
&lt;li>ä¸€ä¸ªä¾‹å­ï¼šæƒ³åœ¨å½“å‰ç›®å½•æ‰§è¡Œ kitex -module my_mod xxx.thriftï¼ŒæŒ‰ä¸‹é¢æ–¹å¼å†™å°±å¯ä»¥äº†&lt;/li>
&lt;li>err := sdk.RunKitexTool(os.Getwd(), nil, &amp;ldquo;-module&amp;rdquo;, &amp;ldquo;my_mod&amp;rdquo;, &amp;ldquo;xxx.thrift&amp;rdquo;)&lt;/li>
&lt;/ul>
&lt;p>é€‚ç”¨åœºæ™¯&lt;/p>
&lt;blockquote>
&lt;p>æ™®é€šå¼€å‘è€…ä¸ç”¨å¤ªå…³å¿ƒï¼Œæ—¥å¸¸ç”¨ä¸åˆ°&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ç§ä½¿ç”¨æ–¹å¼ä¸­ï¼Œä¸éœ€è¦å®‰è£… thriftgoï¼ˆè€Œä¸”ä¸ä¼šæœ‰è‡ªå‡çº§è¡Œä¸ºï¼‰ï¼Œç›´æ¥å†…åµŒ thriftgo å‡½æ•°è°ƒç”¨çœæ‰äº†è¿›ç¨‹è°ƒç”¨å’Œæ•°æ®ä¼ è¾“çš„å¼€é”€ï¼Œåœ¨ä¸€äº›å¤æ‚åœºæ™¯ï¼Œç”Ÿæˆé€Ÿåº¦èƒ½æé«˜ 10%~25%ï¼Œè€Œä¸”æ›´æ˜“äºç»´æŠ¤æˆ–é›†æˆä½¿ç”¨ã€‚&lt;/p>
&lt;p>å¦‚æœä½ åœ¨å¼€å‘æŸç§å°è£…äº† Kitex çš„ä»£ç ç”Ÿæˆå™¨æˆ–è€…ä»£ç ç”Ÿæˆå¹³å°ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥ä»£æ›¿ os.Exec è°ƒç”¨ Kitex å‘½ä»¤è¡Œï¼ŒåŒæ—¶ä¹Ÿçœå»äº†ç»´æŠ¤æœ¬åœ° kitex toolã€thriftgo äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p>
&lt;p>åç»­ Kitex Tool å°†é»˜è®¤å†…åµŒ Thriftgo SDKï¼Œå°±ä¸å†éœ€è¦å•ç‹¬å®‰è£… Thriftgo æˆ–è€…å…³ç³»å·¥å…·ç‰ˆæœ¬å…³ç³»äº†&lt;/p>
&lt;h2 id="æˆ‘ä»¬è¿˜åœ¨åšä»€ä¹ˆ">æˆ‘ä»¬è¿˜åœ¨åšä»€ä¹ˆ&lt;/h2>
&lt;p>ä¸€äº›è¿˜åœ¨æ¢ç´¢çš„äº§ç‰©ä¼˜åŒ–&amp;amp;ç”Ÿæˆæé€Ÿæ‰‹æ®µ&lt;/p>
&lt;h3 id="fastcodec-é«˜æ€§èƒ½é‡æ„">FastCodec é«˜æ€§èƒ½é‡æ„&lt;/h3>
&lt;p>æˆ‘ä»¬æ­£åœ¨é‡æ„ä¸€ç‰ˆ FastCodec çš„ä»£ç ç”Ÿæˆå®ç°ï¼Œé¢„æœŸä¼šå ç”¨æ›´å°‘çš„ä»£ç ä½“ç§¯ï¼Œå…·æœ‰æ›´å¥½çš„ç¼–è§£ç æ€§èƒ½ï¼Œå¹¶ä¸”ä¸ç°åœ¨çš„å®ç°å®Œå…¨å…¼å®¹ã€‚å¼€å‘å®Œæˆåï¼Œæˆ‘ä»¬ä¼šç”Ÿæˆè¿™å¥—æ›´å¥½çš„ FastCodec å†…å®¹ã€‚&lt;/p>
&lt;h3 id="å¢é‡ä»£ç æ›´æ–°">å¢é‡ä»£ç æ›´æ–°&lt;/h3>
&lt;p>æœ‰æ—¶å€™ä¸€ç»„ IDL æœ‰ä¸Šåƒä¸ªï¼Œä½†æ¯æ¬¡æ”¹åŠ¨ diff åªæœ‰ä¸€ç‚¹ï¼ˆæ¯”å¦‚æ·»åŠ äº†ä¸€ä¸ªå­—æ®µä¹‹ç±»çš„ï¼‰ï¼Œåˆ·æ–°ç”Ÿæˆä»£ç å°±è¦ç­‰ä¸Šå¾ˆä¹…ï¼Œå¤§éƒ¨åˆ†ç”Ÿæˆçš„å†…å®¹éƒ½å’Œä¹‹å‰æ²¡åŒºåˆ«ï¼Œåœ¨åšæ— ç”¨åŠŸã€‚å¦‚æœèƒ½å¯¹å˜åŠ¨çš„ IDL å•ç‹¬æ›´æ–°ï¼Œå°±èƒ½æå¤§ç¼©çŸ­æ—¶é—´&lt;/p>
&lt;p>ç›®å‰ Kitex Tool ä»æŠ€æœ¯ä¸Šæ˜¯å¯ä»¥åšåˆ°è¿™ç‚¹çš„ï¼Œä½†éœ€è¦ç»“åˆå…·ä½“çš„ç”Ÿæˆåœºæ™¯æ¥çœ‹å¦‚ä½•é›†æˆ&lt;/p>
&lt;h3 id="å†—ä½™å­—æ®µæ¶ˆé™¤">å†—ä½™å­—æ®µæ¶ˆé™¤&lt;/h3>
&lt;p>å½“å‰ç”±äºä»£ç äº§ç‰©è¿‡å¤§ã€ç‰ˆæœ¬ç®¡ç†å›°éš¾ç­‰åŸå› ï¼Œå„ä¸šåŠ¡çº¿å¾€å¾€ä½¿ç”¨ å…¬å…±ä»£ç ç”Ÿæˆä»“åº“æ¥ç®¡ç†ç”Ÿæˆäº§ç‰©ã€‚ä½†æ˜¯åŒä¸€å¥— IDL é¢å‘ä¸åŒæœåŠ¡åœºæ™¯å¾€å¾€æœ‰ä¸åŒçš„æ•°æ®å­—æ®µä¸‹å‘è§„åˆ™ï¼Œæ­¤æ—¶æŸä¸€ä½¿ç”¨å…¬å…±ç»“æ„ä½“çš„å®¢æˆ·ç«¯å°±ä¼šäº§ç”Ÿå†—ä½™å­—æ®µã€‚æ­¤å¤–ï¼Œéšç€ä¸šåŠ¡é€»è¾‘çš„è¿­ä»£ï¼ŒIDL ä¸­ä¹Ÿå¯èƒ½æœ‰å¤§é‡ äº‹å®ä¸Šæ— ç”¨ä½†æ˜¯å¹¶æœªåˆ é™¤çš„åºŸå¼ƒ Field å­—æ®µã€‚è¿™äº›æƒ…å†µéƒ½ä¼šè½¬åŒ–ä¸ºä¸å¿…è¦çš„ thrift ç¼–è§£ç å¼€é”€ï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡æ€§èƒ½ä¸‹é™ã€‚å› æ­¤æˆ‘ä»¬å¸Œæœ›é€šè¿‡æŸç§æ–¹å¼æ¥åˆ¤æ–­ä¸šåŠ¡ä¸»è¿›ç¨‹ä¸­ å®é™…æ²¡æœ‰ä½¿ç”¨åˆ°çš„å­—æ®µï¼Œå‰ç½®åˆ° kitex tool ä¸­è¿›è¡Œé¢„å¤„ç†ï¼Œæœ€ç»ˆä¼˜åŒ–æ‰å…¶äº§ç”Ÿçš„ä¸å¿…è¦æ€§èƒ½å¼€é”€ã€‚ï¼ˆå‰æ–‡æåˆ°çš„ IDL è£åˆ‡æ˜¯åˆ å‡æ²¡ç”¨çš„ç»“æ„ä½“ï¼Œè€Œè¿™ç§æ‰‹åŠ¨èƒ½æ›´ç²¾å‡†çš„æ¸…ç†æ— ç”¨çš„ç»“æ„ä½“å­—æ®µã€å¹¶å‡å°‘ç¼–è¯‘å’Œåºåˆ—åŒ–å¼€é”€ï¼‰&lt;/p></description></item><item><title>Blog: Kitex Release v0.11.0</title><link>https://www.cloudwego.io/zh/blog/2024/09/12/kitex-release-v0.11.0/</link><pubDate>Thu, 12 Sep 2024 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2024/09/12/kitex-release-v0.11.0/</guid><description>
&lt;blockquote>
&lt;p>å»ºè®®ç›´æ¥å‡çº§ Kitex ç‰ˆæœ¬åˆ° v0.11.3, å› ä¸ºæˆ‘ä»¬å¯¹ v0.11.0 é‡Œçš„ä¸€äº›æ€§èƒ½é—®é¢˜è¿›è¡Œäº†ä¼˜åŒ–&lt;/p>
&lt;/blockquote>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="æ–°ç‰¹æ€§">æ–°ç‰¹æ€§&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>é‡è¯•ï¼šæ–°å¢æ··åˆé‡è¯•åŠŸèƒ½&lt;/strong>ï¼šæ”¯æŒåŒæ—¶å¼€å¯ã€Œå¤±è´¥é‡è¯•ã€+ã€ŒBackup Requestã€ä¸¤ç§ç­–ç•¥ï¼Œèƒ½å¤Ÿåœ¨é™ä½é•¿å°¾è¯·æ±‚çš„åŒæ—¶æé«˜è¯·æ±‚çš„é‡è¯•æˆåŠŸç‡ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/retry/">è¯·æ±‚é‡è¯•&lt;/a>&lt;/li>
&lt;li>&lt;strong>è‡ªå®šä¹‰ Payload æ ¡éªŒ&lt;/strong>ï¼šä¸ºé¿å…ç¡¬ä»¶æ•…éšœæˆ–æ•°æ®ç¯¡æ”¹å¯¼è‡´æ”¶å‘çš„æ•°æ®ä¸ä¸€è‡´ï¼ŒKitex æä¾›äº†å¯¹ Payload æŠ¥æ–‡çš„æ ¡éªŒåŠŸèƒ½ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰æ‰©å±•ï¼Œä½¿ç”¨æ–¹å¼å‚è§: &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/payload_validator/">payload æ ¡éªŒ&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="åŠŸèƒ½ä¼˜åŒ–">åŠŸèƒ½ä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>Frugal ARM æ€§èƒ½ä¼˜åŒ–&lt;/strong>ï¼šFrugal æ”¯æŒäº†åŸºäºåå°„çš„é«˜æ€§èƒ½ç¼–è§£ç ï¼Œå‡çº§åˆ° Frugal v0.2.0 å³å¯&lt;/li>
&lt;li>&lt;strong>Kitex Tool ä»£ç ç”Ÿæˆæé€Ÿ&lt;/strong>ï¼šæä¾›äº† &lt;code>-rapid&lt;/code> å‚æ•°ï¼Œå¯ä»¥æ— éœ€å®‰è£… Thriftgo ï¼Œä¸”é€Ÿåº¦ç•¥æœ‰æé«˜ã€‚ä¸‹ä¸ªç‰ˆæœ¬ä¹‹åå°†ä½œä¸ºé»˜è®¤è¡Œä¸ºã€‚&lt;/li>
&lt;li>&lt;strong>å¤š Service å¤š Handler ç”Ÿæˆ&lt;/strong>ï¼šä»è¯¥ç‰ˆæœ¬å¼€å§‹ï¼ŒKitex Tool æ”¯æŒä¸ºæ¯ä¸ª service ç”Ÿæˆ handler å¹¶ç»Ÿä¸€æ³¨å†Œåˆ° serverï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/multi_service/multi_handler/">å¤š Service å¤š Handler ç”Ÿæˆ&lt;/a>&lt;/li>
&lt;li>&lt;strong>Streaming JSON æ³›åŒ–[è¯•ç”¨é˜¶æ®µ]&lt;/strong>ï¼šJSON æ³›åŒ–è°ƒç”¨æ”¯æŒäº† streaming æµå¼æ¥å£ï¼ˆä»…é™ clientï¼‰ï¼Œç›®å‰æ­£åœ¨æŒç»­ä¼˜åŒ–ä¸­ï¼Œå¹¶æœªæ­£å¼å‘å¸ƒï¼Œæœ‰å…´è¶£å¯ä»¥è¯•ç”¨ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/generic_streaming/">Generic Streaming&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;ol>
&lt;li>æ”¯æŒç‰ˆæœ¬ Go 1.18~1.23ï¼Œæœ€ä½æ”¯æŒå˜ä¸º Go 1.18ï¼Œå¦‚æœä½ çš„ Go ç‰ˆæœ¬è¿‡ä½ï¼Œç¼–è¯‘æ—¶ä¼šæœ‰æç¤ºï¼š&lt;code>note: module requires Go 1.18&lt;/code>&lt;/li>
&lt;li>é€æ­¥ç§»é™¤å¯¹ Apache Thrift çš„ä¾èµ–ï¼Œå°†å¯¹ Thrift ç¼–è§£ç ç›¸å…³çš„é€»è¾‘é€æ­¥æ”¶æ•›åˆ° github.com/cloudwego/gopkg/thrift åº“ä¸­&lt;/li>
&lt;/ol>
&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1509">#1509&lt;/a>] feat(retry): support Mixed Retry which integrating Failure Retry and Backup Request&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1478">#1478&lt;/a>] feat: customized payload validator&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1514">#1514&lt;/a>] feat(grpc): server returns cancel reason&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1513">#1513&lt;/a>] feat(tool): support updating import path for PkgInfo&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1425">#1425&lt;/a>] feat(tool): support generating multiple handlers for multiple services&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1491">#1491&lt;/a>] feat(grpc): add GetTrailerMetadataFromCtx&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1492">#1492&lt;/a>] feat: add GetCallee to kitexutil to get the service name of callee&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1479">#1479&lt;/a>] feat(tool): embed thriftgo into kitex tool&lt;/p>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1485">#1485&lt;/a>] optimize: add cachekey to discovery event for debug&lt;/p>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1525">#1525&lt;/a>] fix: move json-iterator back to support marshal &lt;code>map[any]any&lt;/code>&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1471">#1471&lt;/a>] fix(streaming): resolve ctx diverge in server-side streaming&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1515">#1515&lt;/a>] fix(gRPC): pass error when client transport is closed&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1501">#1501&lt;/a>] fix(generic): judge business error directly&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1503">#1503&lt;/a>] fix: return an unknown service/method exception to client correctly under multi_service server scenario&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1487">#1487&lt;/a>] fix(generic): fix a generic serviceInfo compatible issue&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1489">#1489&lt;/a>] fix(codec): wrap trans error for apache thrift read error&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1486">#1486&lt;/a>] fix(trans/netpoll): log when panic in onConnRead&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1476">#1476&lt;/a>] fix: fix GetServerConn interface assert for streamWithMiddleware&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1481">#1481&lt;/a>] fix(gonet): adjust gonet server read timeout to avoid read error&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1466">#1466&lt;/a>] fix: allow HEADERS frame with empty header block fragment&lt;/p>
&lt;h3 id="refactor">Refactor:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1512">#1512&lt;/a>] refactor: thrift and generic codec uses bufiox interface for encoding and decoding&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1490">#1490&lt;/a>] refactor: optimized apache codec without reflection&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1483">#1483&lt;/a>] refactor: use github.com/cloudwego/gopkg/protocol/thrift/apache&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1474">#1474&lt;/a>] refactor: rm apache thrift in internal/mocks&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1470">#1470&lt;/a>] refactor: rm apache thrift in pkg/generic &amp;amp; netpollmux&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1450">#1450&lt;/a>] refactor(generic): remove apache thrift.TProtocol from generic&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1441">#1441&lt;/a>] refactor: deprecate bthrift, use cloudwego/gopkg&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1455">#1455&lt;/a>] refactor(test): perf optimize and log loc correct&lt;/p>
&lt;h3 id="tests">Tests:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1469">#1469&lt;/a>] test: replace judgement of mem stats of client finalizer by closed count check&lt;/p>
&lt;h3 id="perf">Perf:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1527">#1527&lt;/a>] perf(grpc): bdp ping rate limit&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1511">#1511&lt;/a>] perf(thrift): encodeBasicThrift write logic didn&amp;rsquo;t use kitex BinaryProtocol&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1504">#1504&lt;/a>] perf(grpc): zero allocation in hot path&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1497">#1497&lt;/a>] perf: add option to enable spancache for fastpb&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1495">#1495&lt;/a>] perf(thrift): use kitex BinaryProtocol replace apache BinaryProtocol for apache thrift codec&lt;/p>
&lt;h3 id="chore">Chore:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1532">#1532&lt;/a>] chore: update dependency&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1522">#1522&lt;/a>] chore(generic): make generic streaming APIs internal&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1465">#1465&lt;/a>] chore(generic): add an external method to create service info for generic streaming client&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1468">#1468&lt;/a>] build: adapt to go1.23rc2&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1482">#1482&lt;/a>] chore(generic): add generic base using gopkg base&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1463">#1463&lt;/a>] chore: fix grpc keepalive test by start server responsiblly&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1462">#1462&lt;/a>] chore(test): fix xorshift64 in consist_test.go&lt;/p>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1454">#1454&lt;/a>] chore(ci): speed up multiple ci processes 8min -&amp;gt; 1min&lt;/p></description></item><item><title>Blog: Kitex Release v0.10.0</title><link>https://www.cloudwego.io/zh/blog/2024/06/12/kitex-release-v0.10.0/</link><pubDate>Wed, 12 Jun 2024 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2024/06/12/kitex-release-v0.10.0/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–&lt;/h3>
&lt;p>æ–°ç‰ˆæœ¬æ¢ç´¢äº†æ›´å¤šæ€§èƒ½ä¼˜åŒ–çš„æ–¹å‘å’Œéå¸¸è§„çš„ä¸€äº›ä¼˜åŒ–æ‰‹æ®µã€‚&lt;/p>
&lt;ol>
&lt;li>é•¿è¿æ¥æ± : 100 å¹¶å‘ qps æå‡ 4%, p99 é™ä½ 18%&lt;/li>
&lt;li>å¤šè·¯å¤ç”¨: 100 å¹¶å‘ qps æå‡ 7%, p99 é™ä½ 24%&lt;/li>
&lt;li>gRPC: 100 å¹¶å‘ qpsä¼˜åŒ– 8%ï¼Œp99ä¼˜åŒ– 10%&lt;/li>
&lt;/ol>
&lt;h3 id="ä»£ç äº§ç‰©ç²¾ç®€ä¼˜åŒ–">ä»£ç äº§ç‰©ç²¾ç®€ä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>ç§»é™¤éåºåˆ—åŒ–ä»£ç ï¼ˆé»˜è®¤ï¼‰&lt;/strong>ï¼šåŸ kitex_gen Thrift äº§ç‰©ä»£ç ä¸ºä¿æŒä¸ Apache çš„ä¸€è‡´æ€§ï¼Œä¼šç”Ÿæˆ Processor ä»£ç ï¼Œä½† Kitex å¹¶ä¸éœ€è¦è¿™äº›ä»£ç ã€‚ä¸ºè§£å†³å¤§å®¶çš„äº§ç‰©ç—›ç‚¹é—®é¢˜ï¼Œæ­¤ç‰ˆæœ¬é»˜è®¤å»é™¤è¿™éƒ¨åˆ†ä»£ç ï¼Œç”Ÿæˆé€Ÿåº¦æå‡çº¦10%ã€‚&lt;/li>
&lt;li>&lt;strong>ç§»é™¤ Apache Codec ä»£ç ï¼ˆé…ç½®ç§»é™¤ï¼‰&lt;/strong>ï¼šKitex æœ‰è‡ªå®šä¹‰çš„ FastCodec ä»£ç ï¼Œæ—§ç‰ˆæœ¬ä»…åœ¨ Buffered åŒ…éœ€è¦ä½¿ç”¨ Apache Codecã€‚Kitex æ–°ç‰ˆæœ¬å®ç° SkipDecoderï¼Œåœ¨å¼€å¯åå°±å¯ä»¥å®Œå…¨ä¸ä¾èµ– Apache Codecï¼Œè¿›è€Œç§»é™¤ä»£ç ï¼Œäº§ç‰©ä½“ç§¯å¯å‡å°‘çº¦50%ã€‚ä½¿ç”¨æ–¹å¼è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/skip_decoder/">SkipDecoder&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="æ–°ç‰¹æ€§">æ–°ç‰¹æ€§&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>Thrift æŒ‰éœ€åºåˆ—åŒ–&lt;/strong>ï¼šæ”¯æŒå®šä¹‰ FieldMask å®ç°æ•°æ®æŒ‰éœ€åºåˆ—åŒ–ï¼ˆå­—æ®µè£å‰ªã€åˆå¹¶ï¼ŒRPCæ€§èƒ½ä¼˜åŒ–ç­‰ï¼‰ï¼Œè¯¦è§ &lt;a href="https://github.com/cloudwego/thriftgo/tree/main/fieldmask">Thrift FieldMask RFC&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3 id="åŠŸèƒ½ä¼˜åŒ–">åŠŸèƒ½ä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>ç†”æ–­&lt;/strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ç†”æ–­çš„é”™è¯¯ç±»å‹&lt;/li>
&lt;li>&lt;strong>å¼‚å¸¸é‡è¯•&lt;/strong>ï¼šä»£ç é…ç½®çš„è‡ªå®šä¹‰ç»“æœé‡è¯•å¢åŠ  ctx å‚æ•°ï¼Œæ–¹ä¾¿ç”¨æˆ·ç»“åˆ ctx ä¿¡æ¯åˆ¤æ–­æ˜¯å¦é‡è¯•&lt;/li>
&lt;li>&lt;strong>ç§»é™¤ä¸€è‡´æ€§å“ˆå¸Œä¸­çš„ç¼“å­˜&lt;/strong>ï¼šè§£å†³hash keyåˆ†æ•£å¯¼è‡´çš„å»¶è¿Ÿå˜é«˜ã€å†…å­˜ä¸Šæ¶¨çš„é—®é¢˜ã€‚ç§»é™¤ç¼“å­˜åï¼Œé¢å¯¹ Key ç‰¹åˆ«åˆ†æ•£ç”šè‡³æ¥è¿‘éšæœºåˆ†å¸ƒçš„åœºæ™¯ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½å†…å­˜å ç”¨ä¸ç®¡ç†ç¼“å­˜çš„æ¶ˆè€—ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="ç”¨æˆ·ä½“éªŒä¼˜åŒ–">ç”¨æˆ·ä½“éªŒä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>Kitex å·¥å…·å…¼å®¹æ€§æ£€æµ‹&lt;/strong>ï¼šä¼˜åŒ–è¿‡å»äº§ç‰©å¼•å…¥æ–°å®šä¹‰å¯¼è‡´çš„ undefined ç¼–è¯‘é—®é¢˜ã€‚Kitex å·¥å…·åœ¨ç”Ÿæˆä»£ç å‰ä¼šæ£€æŸ¥ go.mod ä¸­ä½¿ç”¨çš„ Kitex ç‰ˆæœ¬ã€‚è‹¥ Kitex å·¥å…·å’Œ Kitex ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œåˆ™ä¸ä¼šç”Ÿæˆä»£ç å¹¶ç»™å‡ºç›¸åº”çš„å‡é™çº§æç¤ºã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1370">#1370&lt;/a>] feat(loadbalance): do not cache all the keys for Consistent Hash&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1359">#1359&lt;/a>] feat:(generic) jsonpb using dynamicgo support parse IDL from memory&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1353">#1353&lt;/a>] feat(retry): add ctx param for customized result retry funcs&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1352">#1352&lt;/a>] feat: add option to specify ip version for default HTTPResolver&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1316">#1316&lt;/a>] feat(kitex tool): support dependencies compatibility checking&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1346">#1346&lt;/a>] feat(generic): set dynamicgo parse mode&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1336">#1336&lt;/a>] feat(tool): fast-codec supports Thrift Fieldmask&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1313">#1313&lt;/a>, #1378] feat(thrift codec): implement skipDecoder to enable Frugal and FastCodec for standard Thrift Buffer Protocol&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1257">#1257&lt;/a>] feat: CBSuite custom GetErrorType func&lt;/li>
&lt;/ol>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1349">#1349&lt;/a>] optimize(gRPC): gRPC onError uses CtxErrorf to print log with information in ctx&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1326">#1326&lt;/a>] optimize(tool): remove thrift processor for less codegen&lt;/li>
&lt;/ol>
&lt;h3 id="perf">Perf:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1369">#1369&lt;/a>] perf(thrift): optimized skip decoder&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1314">#1314&lt;/a>] perf: use dirtmake to reduce memclr cost&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1322">#1322&lt;/a>] perf(codec): support fast write nocopy when using netpoll link buffer&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1276">#1276&lt;/a>] perf: linear allocator for fast codec ReadString/ReadBinary&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1320">#1320&lt;/a>] perf(codec): fast codec use batch alloc&lt;/li>
&lt;/ol>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1379">#1379&lt;/a>] fix: fix a bug &amp;ldquo;unknown service xxx&amp;rdquo; when using generic client by not writing IDLServiceName when it&amp;rsquo;s generic service&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1368">#1368&lt;/a>] fix(remote): modify the error message thrown when no target service is found&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1374">#1374&lt;/a>] fix: init default values when using liner allocator&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1361">#1361&lt;/a>] fix: span cache re-cap bytes when using Make&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1362">#1362&lt;/a>] fix(payloadCodec): replace the registered PayloadCodec if the type is same when using WithPayloadCodec for server-side&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1364">#1364&lt;/a>] fix: fix grpc compressor mcache free panic when data is empty&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1328">#1328&lt;/a>] fix(gRPC): release connection in DoFinish for grpc streaming to close the short connection&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1307">#1307&lt;/a>] fix(connpool): kitex long pool reset idleList element to nil to prevent conn leak&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1294">#1294&lt;/a>] fix(netpollmux): fix a bug that disables multi-service by assigning the first svcInfo to targetSvcInfo&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1308">#1308&lt;/a>] fix(generic): not write generic method name for binary generic exception to align with method names of services not using binary generic&lt;/li>
&lt;/ol>
&lt;h3 id="refactor">Refactor:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1344">#1344&lt;/a>] refactor(tool): export thriftgo template definition in kitextool&lt;/li>
&lt;/ol>
&lt;h3 id="chore">Chore:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1385">#1385&lt;/a>] chore: update dynamicgo to v0.2.8&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1383">#1383&lt;/a>] chore: upgrade netpoll to v0.6.1&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1376">#1376&lt;/a>] chore: integration test use go 1.20 to solve the compatibility issue of official gRPC in kitex-tests repo&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1355">#1355&lt;/a>] chore: upgrade netpoll to v0.6.1 pre-release version&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1338">#1338&lt;/a>] chore: correct the comment of FreezeRPCInfo&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1347">#1347&lt;/a>] chore: use runtimex to replace choleraehyq/pid&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1342">#1342&lt;/a>] chore: update sonic/loader to v0.1.1&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1334">#1334&lt;/a>] chore: update dynamicgo to v0.2.3&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1324">#1324&lt;/a>] chore: update dynamicgo and sonic version&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1317">#1317&lt;/a>] chore: frugal v0.1.15 (with migrated iasm)&lt;/li>
&lt;/ol>
&lt;hr>
&lt;p>&lt;strong>Thanks a lot to those community contributors who submit some pull requests or share your ideas for this version:&lt;/strong>
@XiaoYi-byte&lt;/p></description></item><item><title>Blog: kitexcallï¼šç”¨ JSON å‘èµ· RPC è¯·æ±‚çš„å‘½ä»¤è¡Œç¥å™¨</title><link>https://www.cloudwego.io/zh/blog/2024/05/31/kitexcall%E7%94%A8-json-%E5%8F%91%E8%B5%B7-rpc-%E8%AF%B7%E6%B1%82%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%A5%9E%E5%99%A8/</link><pubDate>Fri, 31 May 2024 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2024/05/31/kitexcall%E7%94%A8-json-%E5%8F%91%E8%B5%B7-rpc-%E8%AF%B7%E6%B1%82%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%A5%9E%E5%99%A8/</guid><description>
&lt;h2 id="èƒŒæ™¯">èƒŒæ™¯&lt;/h2>
&lt;p>Kitex æ˜¯å­—èŠ‚è·³åŠ¨åŸºç¡€æ¶æ„æœåŠ¡æ¡†æ¶å›¢é˜Ÿæ¨å‡ºçš„ Go å¾®æœåŠ¡ RPC æ¡†æ¶ï¼Œæ”¯æŒ Thriftã€Kitex Protobufã€gRPC ç­‰æ¶ˆæ¯åè®®ï¼Œå…·æœ‰é«˜æ€§èƒ½ã€å¼ºå¯æ‰©å±•çš„ç‰¹ç‚¹ã€‚Kitex äº 2021 å¹´ 9 æœˆæ­£å¼å¼€æºåï¼Œå·²åœ¨å¤šå®¶å¤–éƒ¨ä¼ä¸šæˆåŠŸè½åœ°ï¼Œä¸ºä»–ä»¬å¸¦æ¥äº†çœŸå®çš„æˆæœ¬ã€æ€§èƒ½å’Œç¨³å®šæ€§æ”¶ç›Šã€‚
ç„¶è€Œï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªç—›ç‚¹æ˜¯ï¼Œä¸ºäº†éªŒè¯ Server ç«¯ä»£ç ï¼Œå‘èµ· RPC æµ‹è¯•è¯·æ±‚çš„æµç¨‹æ¯”è¾ƒç¹çã€‚&lt;/p>
&lt;h2 id="ç—›ç‚¹">ç—›ç‚¹&lt;/h2>
&lt;p>ç»™ Kitex æœåŠ¡å‘é€ RPC æµ‹è¯•è¯·æ±‚çš„è¿‡ç¨‹é€šå¸¸åŒ…æ‹¬ï¼š&lt;/p>
&lt;ol>
&lt;li>ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ï¼šæ ¹æ® IDL æ–‡ä»¶ç”Ÿæˆ Kitex Client ç›¸å…³ä»£ç ã€‚&lt;/li>
&lt;li>æ„é€ æµ‹è¯•è¯·æ±‚ï¼šæ„å»ºè¯·æ±‚ã€è°ƒç”¨æ–¹æ³•ã€å¤„ç†å“åº”ã€‚&lt;/li>
&lt;li>é…ç½®å¤šç§é€‰é¡¹ï¼šè®¾ç½®ä¼ è¾“åè®®ã€å…ƒä¿¡æ¯ã€å¼‚å¸¸å¤„ç†ç­‰ã€‚
è¿™ä¸€è¿‡ç¨‹ä¸ä»…è€—æ—¶ï¼Œä¸”åœ¨é¢‘ç¹æµ‹è¯•æ—¶ï¼Œæ¯æ¬¡éƒ½éœ€ä¿®æ”¹å’Œç¼–è¯‘ä»£ç ï¼Œæ•ˆç‡è¾ƒä½ã€‚ä¸€ä¸ªèƒ½ç®€åŒ–è¿™äº›æ­¥éª¤ã€å¿«é€Ÿå‘é€ RPC è¯·æ±‚çš„å·¥å…·ï¼Œå°†å¤§å¹…æå‡å¼€å‘æ•ˆç‡ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="kitexcall-ä»‹ç»">kitexcall ä»‹ç»&lt;/h2>
&lt;blockquote>
&lt;p>è¯¦æƒ…å¯ä»¥å‚è€ƒï¼šhttps://github.com/kitex-contrib/kitexcall&lt;/p>
&lt;/blockquote>
&lt;p>ä¸ºäº†ç®€åŒ–å¼€å‘è€…çš„å·¥ä½œï¼Œç¤¾åŒºæ¨å‡ºäº† kitexcall è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼ŒåŸºäº Kitex æä¾›çš„ JSON æ³›åŒ–è°ƒç”¨ï¼Œæå¤§åœ°ç®€åŒ–äº† Kitex å®¢æˆ·ç«¯çš„ç¼–å†™è¿‡ç¨‹ã€‚å¼€å‘è€…åªéœ€é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œæ“ä½œï¼Œå°±å¯ä»¥è½»æ¾å‘èµ· Kitex è¯·æ±‚ï¼Œè€Œä¸å†éœ€è¦ç¼–å†™ç¹ççš„ä»£ç ã€‚&lt;/p>
&lt;p>kitexcall ç›®å‰å·²å‘å¸ƒ v0.1.1 ç‰ˆæœ¬ï¼Œå…·å¤‡ä»¥ä¸‹åŠŸèƒ½ç‰¹ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>æ”¯æŒ Thrift/Protobufï¼šå¯ä»¥å¤„ç† Thrift å’Œ Protobuf æ ¼å¼çš„ IDLã€‚&lt;/li>
&lt;li>æ”¯æŒå¤šç§ä¼ è¾“åè®®ï¼šåŒ…æ‹¬ Bufferedã€TTHeaderã€Framedã€TTHeaderFramedï¼Œæœªæ¥è¿˜å°†æ”¯æŒ gRPCã€‚&lt;/li>
&lt;li>çµæ´»çš„å®¢æˆ·ç«¯é€‰é¡¹ï¼šæ”¯æŒæŒ‡å®šå¸¸ç”¨çš„å®¢æˆ·ç«¯é€‰é¡¹ï¼Œå¦‚ &lt;code>client.WithHostPorts&lt;/code>ã€‚&lt;/li>
&lt;li>å¤šç§æ•°æ®è¾“å…¥æ–¹å¼ï¼šè¯·æ±‚æ•°æ®å¯ä»¥ä»å‘½ä»¤è¡Œå‚æ•°æˆ–æœ¬åœ°æ–‡ä»¶è¯»å–ã€‚&lt;/li>
&lt;li>å…ƒä¿¡æ¯ä¼ é€’ï¼šæ”¯æŒå•è·³é€ä¼ å’ŒæŒç»­é€ä¼ çš„å…ƒä¿¡æ¯ï¼Œå¹¶æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„åå‘é€ä¼ å…ƒä¿¡æ¯ã€‚&lt;/li>
&lt;li>ä¸šåŠ¡å¼‚å¸¸å¤„ç†ï¼šæ¥æ”¶å¹¶å¤„ç†ä¸šåŠ¡è‡ªå®šä¹‰çš„å¼‚å¸¸é”™è¯¯ç å’Œä¿¡æ¯ã€‚&lt;/li>
&lt;li>å¤šç§è¾“å‡ºæ ¼å¼ï¼šé»˜è®¤è¾“å‡ºäººç±»å‹å¥½çš„å¯è¯»æ ¼å¼ï¼Œæœªæ¥å°†æ”¯æŒå¯è§£æçš„æ ¼å¼ï¼Œä¾¿äºä¸å…¶ä»–è‡ªåŠ¨åŒ–å·¥å…·é›†æˆã€‚
ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ kitexcall å‘èµ·ä¸€ä¸ª Kitex è¯·æ±‚ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹&lt;/h2>
&lt;p>é¦–å…ˆå®‰è£… kitexcall å‘½ä»¤è¡Œå·¥å…·ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">go&lt;/span> &lt;span style="color:#000">install&lt;/span> &lt;span style="color:#000">github&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">com&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">/&lt;/span>&lt;span style="color:#000">kitex&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">contrib&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">/&lt;/span>&lt;span style="color:#000">kitexcall&lt;/span>&lt;span style="color:#a40000">@&lt;/span>&lt;span style="color:#000">latest&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»¥ &lt;a href="https://github.com/cloudwego/kitex-examples">kitex-examples&lt;/a> çš„ Echo æœåŠ¡ä¸ºä¾‹ï¼Œå°†å…¶ IDL æ–‡ä»¶ä¿å­˜ä¸º echo.thriftã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">namespace&lt;/span> &lt;span style="color:#204a87;font-weight:bold">go&lt;/span> &lt;span style="color:#000">api&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">Request&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000">message&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">Response&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000">message&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">service&lt;/span> &lt;span style="color:#000">Echo&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Response&lt;/span> &lt;span style="color:#000">Echo&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">Request&lt;/span> &lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ºæ–¹ä¾¿æµ‹è¯•ï¼Œä½ å¯ä»¥ç”¨å¦‚ä¸‹æ­¥éª¤åœ¨æœ¬æœºå¯åŠ¨è¿™ä¸ª Echo æœåŠ¡ï¼ˆé»˜è®¤ç›‘å¬ 8888 ç«¯å£ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">$&lt;/span> &lt;span style="color:#000">git&lt;/span> &lt;span style="color:#000">clone&lt;/span> &lt;span style="color:#000">https&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#8f5902;font-style:italic">//github.com/cloudwego/kitex-examples.git&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">$&lt;/span> &lt;span style="color:#000">cd&lt;/span> &lt;span style="color:#000">kitex&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">examples&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">/&lt;/span>&lt;span style="color:#000">basic&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">/&lt;/span>&lt;span style="color:#000">server&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">$&lt;/span> &lt;span style="color:#204a87;font-weight:bold">go&lt;/span> &lt;span style="color:#000">run&lt;/span> &lt;span style="color:#000;font-weight:bold">.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">Info&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#000">KITEX&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">server&lt;/span> &lt;span style="color:#000">listen&lt;/span> &lt;span style="color:#000">at&lt;/span> &lt;span style="color:#000">addr&lt;/span>&lt;span style="color:#000;font-weight:bold">=[::]:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">8888&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿ç”¨ kitexcall å‘èµ·è¯·æ±‚éå¸¸ç®€å•ï¼Œåªè¦åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®š IDL æ–‡ä»¶ã€æ–¹æ³•åç§°ã€è¯·æ±‚æŠ¥æ–‡ï¼ˆJSON æ ¼å¼ï¼‰å’Œ Server åœ°å€å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">kitexcall&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">idl&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">path&lt;/span> &lt;span style="color:#000">echo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">thrift&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">m&lt;/span> &lt;span style="color:#000">echo&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">d&lt;/span> &lt;span style="color:#a40000">&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;message&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;hello&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#a40000">&amp;#39;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">e&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">127.0.0.1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">8888&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå°±å¯ä»¥çœ‹åˆ° kitexcall è¾“å‡ºæœåŠ¡ç«¯è¿”å›çš„å“åº”æŠ¥æ–‡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">Status&lt;/span>&lt;span style="color:#000;font-weight:bold">]:&lt;/span> &lt;span style="color:#000">Success&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;message&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;hello&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœä½ å¸Œæœ›ä»æ–‡ä»¶ä¸­è¯»å…¥è¯·æ±‚æ•°æ®ï¼Œä¹Ÿå¯ä»¥å…ˆåˆ›å»ºè¯·æ±‚æ•°æ®æ–‡ä»¶ input.jsonï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;message&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;hello&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¹¶åœ¨ kitexcall çš„å‚æ•°ä¸­ç”¨ -f å‚æ•°æŒ‡å®šæ–‡ä»¶åï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">kitexcall&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">idl&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">path&lt;/span> &lt;span style="color:#000">echo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">thrift&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">m&lt;/span> &lt;span style="color:#000">echo&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">f&lt;/span> &lt;span style="color:#000">input&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">json&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">e&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">127.0.0.1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">8888&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="åŸç†ç®€ä»‹">åŸç†ç®€ä»‹&lt;/h2>
&lt;p>kitexcall å·¥å…·åŸºäº Kitex æä¾›çš„ JSON æ³›åŒ–è°ƒç”¨å®ç°ã€‚å…¶åŸç†ç®€å•ä»‹ç»å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>Descriptor Provider&lt;/li>
&lt;/ol>
&lt;p>kitexcall ä½¿ç”¨ Kitex æä¾›çš„ DescriptorProvider æ¥å£æ¥è§£æ Thrift æˆ– Protobuf çš„ IDL æ–‡ä»¶ï¼Œè·å–æœåŠ¡å®šä¹‰ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>æ³›åŒ–å¯¹è±¡åˆ›å»º&lt;/li>
&lt;/ol>
&lt;p>è§£æ IDL æ–‡ä»¶åï¼Œkitexcall åˆ›å»ºæ³›åŒ–å¯¹è±¡ï¼ˆå¦‚ JSONThriftGeneric æˆ– JSONPbGenericï¼‰ï¼Œå°† JSON æ•°æ®è½¬æ¢ä¸ºå†…éƒ¨è¯·æ±‚æ ¼å¼ï¼Œå¹¶å°†å“åº”æ•°æ®è½¬æ¢å› JSON æ ¼å¼ã€‚&lt;/p>
&lt;ol start="3">
&lt;li>å®¢æˆ·ç«¯åˆå§‹åŒ–&lt;/li>
&lt;/ol>
&lt;p>kitexcall ä½¿ç”¨æ³›åŒ–å¯¹è±¡å’Œå®¢æˆ·ç«¯é€‰é¡¹ï¼ˆå¦‚ä¼ è¾“åè®®ã€å…ƒä¿¡æ¯å¤„ç†ç­‰ï¼‰æ¥åˆ›å»ºæ³›åŒ–å®¢æˆ·ç«¯ã€‚è¯¥å®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨ IDL æ–‡ä»¶ä¸­å®šä¹‰çš„ä»»ä½•æœåŠ¡æ–¹æ³•ã€‚&lt;/p>
&lt;ol start="4">
&lt;li>è¯·æ±‚æ„å»ºä¸å‘é€&lt;/li>
&lt;/ol>
&lt;p>kitexcall ä»å‘½ä»¤è¡Œè¾“å…¥æˆ–æ–‡ä»¶ä¸­è¯»å– JSON æ ¼å¼çš„è¯·æ±‚æ•°æ®ï¼Œæ„å»ºè¯·æ±‚å¯¹è±¡å¹¶å‘é€è¯·æ±‚ï¼ŒåŒæ—¶è®¾ç½®ä¼ è¾“åè®®å’Œå…ƒä¿¡æ¯ã€‚&lt;/p>
&lt;ol start="5">
&lt;li>å“åº”å¤„ç†
æ¥æ”¶åˆ°å“åº”åï¼Œkitexcall å°†å…¶æ ¼å¼åŒ–ä¸º JSON å¹¶è¾“å‡ºã€‚å¦‚æœå¯ç”¨äº†å…ƒä¿¡æ¯å›ä¼ æœºåˆ¶ï¼Œè¿˜ä¼šè¾“å‡ºä»æœåŠ¡ç«¯è¿”å›çš„å…ƒä¿¡æ¯ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="æœªæ¥å±•æœ›">æœªæ¥å±•æœ›&lt;/h2>
&lt;p>kitexcall ä½œä¸ºä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„é¡¹ç›®ï¼Œè‡´åŠ›äºç®€åŒ–å¼€å‘è€…ä½¿ç”¨ Kitex è¿›è¡Œ RPC è°ƒç”¨çš„è¿‡ç¨‹ã€‚æœªæ¥ï¼Œæˆ‘ä»¬è®¡åˆ’åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œæ”¹è¿›å’Œæ‰©å±•ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>è®¡åˆ’æ”¯æŒ gRPCï¼ˆå«åŸºäº gRPC/HTTP2 çš„ Thrift Streamingï¼‰åè®®ï¼Œä»¥é€‚åº”æ›´å¤šçš„ä½¿ç”¨åœºæ™¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ”¯æŒé€šè¿‡æœåŠ¡å‘ç°è·å– Kitex Server åœ°å€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨ Kitex Server æ”¯æŒ Reflection èƒ½åŠ›ä¹‹åï¼Œkitexcall å°†è·Ÿè¿›ï¼Œå®ç°æ— éœ€ IDL æ–‡ä»¶ï¼Œå³å¯è·å–æœåŠ¡è¯¦æƒ…å’Œè¿›è¡ŒæœåŠ¡è°ƒç”¨ï¼Œä½¿ç”¨å°†ä¼šæ›´åŠ ä¾¿æ·ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ”¯æŒå¯è§£æçš„è¾“å‡ºæ ¼å¼ï¼ˆå¦‚ JSONï¼‰ï¼Œä»¥ä¾¿ä¸å…¶ä»–è‡ªåŠ¨åŒ–å·¥å…·é›†æˆï¼ˆä¾‹å¦‚ CI/CDã€IDE æ’ä»¶ç­‰åœºæ™¯ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>æ¬¢è¿å¯¹ Kitex å’Œ kitexcall æ„Ÿå…´è¶£çš„å¼€å‘è€…åŠ å…¥ç¤¾åŒºï¼Œå…±åŒè´¡çŒ®ä»£ç å’Œåˆ›æ„ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œåœ¨å¤§å®¶çš„å…±åŒåŠªåŠ›ä¸‹ï¼Œkitexcall å°†æˆä¸º Kitex å¼€å‘è€…æ‰‹ä¸­çš„ä¸€æŠŠåˆ©å™¨ï¼Œè®©å¾®æœåŠ¡å¼€å‘å˜å¾—æ›´åŠ é«˜æ•ˆå’Œä¾¿æ·ã€‚è®¿é—® &lt;a href="https://github.com/kitex-contrib/kitexcall">kitexcall&lt;/a> äº†è§£æ›´å¤šä¿¡æ¯ï¼Œå¹¶åŠ å…¥æˆ‘ä»¬å§ï¼&lt;/p>
&lt;h3 id="é¡¹ç›®åœ°å€">é¡¹ç›®åœ°å€&lt;/h3>
&lt;p>GitHubï¼šhttps://github.com/cloudwego&lt;/p></description></item><item><title>Blog: Kitex æ”¯æŒ Dubbo åè®®ï¼šåŠ©åŠ›å¤šè¯­è¨€äº‘åŸç”Ÿç”Ÿæ€èåˆ</title><link>https://www.cloudwego.io/zh/blog/2024/03/16/kitex-%E6%94%AF%E6%8C%81-dubbo-%E5%8D%8F%E8%AE%AE%E5%8A%A9%E5%8A%9B%E5%A4%9A%E8%AF%AD%E8%A8%80%E4%BA%91%E5%8E%9F%E7%94%9F%E7%94%9F%E6%80%81%E8%9E%8D%E5%90%88/</link><pubDate>Sat, 16 Mar 2024 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2024/03/16/kitex-%E6%94%AF%E6%8C%81-dubbo-%E5%8D%8F%E8%AE%AE%E5%8A%A9%E5%8A%9B%E5%A4%9A%E8%AF%AD%E8%A8%80%E4%BA%91%E5%8E%9F%E7%94%9F%E7%94%9F%E6%80%81%E8%9E%8D%E5%90%88/</guid><description>
&lt;h2 id="èƒŒæ™¯">èƒŒæ™¯&lt;/h2>
&lt;p>Kitex æ˜¯å­—èŠ‚è·³åŠ¨åŸºç¡€æ¶æ„æœåŠ¡æ¡†æ¶å›¢é˜Ÿæ¨å‡ºçš„ Go å¾®æœåŠ¡ RPC æ¡†æ¶ï¼Œæ”¯æŒ Thriftã€Kitex Protobufã€gRPC ç­‰æ¶ˆæ¯åè®®ï¼Œå…·æœ‰é«˜æ€§èƒ½ã€å¼ºå¯æ‰©å±•çš„ç‰¹ç‚¹ã€‚äº 2021 å¹´ 9 æœˆæ­£å¼å¼€æºåï¼Œå·²åœ¨å¤šå®¶å¤–éƒ¨ä¼ä¸šæˆåŠŸè½åœ°ï¼Œä¸ºä»–ä»¬å¸¦æ¥äº†çœŸå®çš„æˆæœ¬ã€æ€§èƒ½å’Œç¨³å®šæ€§æ”¶ç›Šã€‚&lt;/p>
&lt;p>å¾ˆå¤šä¼ä¸šç”¨æˆ·åœ¨ä½¿ç”¨ Kitex æ”¹é€ æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ Kitex èƒ½ä¸ç°æœ‰çš„ Dubbo æ¡†æ¶å®ç°çš„æœåŠ¡è¿›è¡Œé€šä¿¡ï¼Œè¿™ä¸ CloudWeGo ç¤¾åŒºç§¯ææ‹“å±•ç”Ÿæ€çš„ç›®æ ‡ä¸è°‹è€Œåˆï¼Œå› æ­¤ Dubbo äº’é€šé¡¹ç›® &lt;a href="https://github.com/kitex-contrib/codec-dubbo">codec-dubbo&lt;/a> åº”è¿è€Œç”Ÿã€‚&lt;/p>
&lt;p>åœ¨ç¤¾åŒºåŒå­¦çš„çƒ­æƒ…å¸®åŠ©ä¸‹ï¼Œç›®å‰ codec-dubbo èƒ½åšåˆ° Kitex ä¸ Dubbo-Javaï¼ŒKitex ä¸ Dubbo-Go äº’é€šï¼Œæ”¯æŒ Dubbo ç”¨æˆ·å‘ Kitex è¿ç§»ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Dubbo_interoperate/kitex_dubbo_interoperate.png" alt="image">&lt;/p>
&lt;p>æœ¬æ–‡å°†ä»¥æ–¹æ­£è¯åˆ¸åˆ©ç”¨ Kitex ä¸ codec-dubbo æˆåŠŸè¿›è¡ŒæœåŠ¡æ”¹é€ ä¸ºä¾‹ï¼Œå¯¹æ”¹é€ è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„ codec-dubbo ä¸»è¦åŠŸèƒ½è¿›è¡Œé˜è¿°ï¼Œå¹¶ç®€è¦åˆ†æå…¶ä¸­çš„å®ç°ç»†èŠ‚ã€‚&lt;/p>
&lt;h2 id="ä¼ä¸šè½åœ°æ¡ˆä¾‹">ä¼ä¸šè½åœ°æ¡ˆä¾‹&lt;/h2>
&lt;p>æ–¹æ­£è¯åˆ¸åŸæœ‰çš„æœåŠ¡é‡‡ç”¨ Java å’Œ Dubbo æ¡†æ¶ç¼–å†™ï¼Œä¸¤è€…ç¨³å®šä¸”ç»è¿‡äº†å¤§é‡åœºæ™¯çš„éªŒè¯ï¼Œç¬¦åˆä»–ä»¬çš„ç”Ÿäº§å’Œå¼€å‘éœ€æ±‚ã€‚ä»¥è¯·æ±‚é‡è¾ƒå¤§çš„å°æ–¹ä¸ªè‚¡è¯¦æƒ…é¡µä¸ºä¾‹ï¼Œé«˜å³°æœŸçš„æ¥å£ QPS åœ¨ 3-4kï¼Œä½¿ç”¨ 16 å° 16 Core 64G è™šæ‹Ÿæœºè¿›è¡Œæ‰¿è½½ã€‚&lt;/p>
&lt;p>éšç€äº‘åŸç”Ÿæ¶æ„çš„å…´èµ·ï¼Œå‡­å€Ÿå†…å­˜å ç”¨ä¸æ‰§è¡Œæ•ˆç‡çš„ä¼˜åŠ¿ä»¥åŠå¤©ç„¶é€‚é…äº‘åŸç”Ÿï¼ŒGo é€æ¸æˆä¸ºæ„å»ºä¼ä¸šæœåŠ¡çš„é‡è¦æŠ€æœ¯é€‰é¡¹ã€‚ä¸ºäº†æ›´å¥½åœ°é™æœ¬å¢æ•ˆï¼Œç»¼åˆè€ƒè™‘æˆæœ¬ã€æ€§èƒ½å’Œç¨³å®šæ€§ç­‰å› ç´ åï¼Œä»–ä»¬å†³å®šåœ¨æ–°å»ºåº”ç”¨ä¸Šç”± Java è½¬å‘ Goï¼Œå¼•å…¥ Kitexï¼ŒHertz ç­‰ CloudWeGo é¡¹ç›®è¿›è¡ŒæœåŠ¡å¼€å‘ä¸é‡æ„ï¼Œå¹¶æ•´ä½“è¿ç§»è‡³ Kubernetes ç¯å¢ƒã€‚&lt;/p>
&lt;p>åœ¨é‡æ„è¿‡ç¨‹ä¸­ï¼Œcodec-dubbo å‡­å€Ÿæ¥è¿‘åŸç”Ÿ Kitex + Thrift çš„ä½¿ç”¨ä½“éªŒä»¥åŠå¯¹ Dubbo æ¦‚å¿µçš„è‰¯å¥½æ”¯æŒï¼Œé™ä½äº†ä½¿ç”¨å’Œç†è§£æˆæœ¬ï¼ŒæˆåŠŸå¸®åŠ©ä»–ä»¬è§£å†³äº† Kitex &amp;lt;-&amp;gt; Dubbo çš„äº’é€šé—®é¢˜ï¼Œè®© Kitex æœåŠ¡é¡ºåˆ©è°ƒç”¨åŸæœ‰çš„ Dubbo æœåŠ¡ã€‚&lt;/p>
&lt;p>ç›®å‰ï¼Œä½¿ç”¨äº† codec-dubbo çš„ Kitex æœåŠ¡å·²æˆåŠŸä¸Šçº¿ï¼Œç¨³å®šè¿è¡Œä¸¤ä¸ªæœˆã€‚è¿˜æ˜¯ä»¥å°æ–¹ä¸ªè‚¡è¯¦æƒ…é¡µä¸ºä¾‹ï¼ŒKitex å’Œ Hertz æ‰¿è½½äº†è¯¥é¡µé¢ä¸€åŠå·¦å³çš„æ¥å£ï¼Œåœ¨ QPS ä¸å˜çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦æä¾› 12 ä¸ª 4 Core 4G Podï¼Œé™ä½èµ„æºå ç”¨æ•ˆæœæ˜¾è‘—ã€‚&lt;/p>
&lt;h2 id="codec-dubbo-åŠŸèƒ½ç‰¹æ€§">codec-dubbo åŠŸèƒ½ç‰¹æ€§&lt;/h2>
&lt;h3 id="dubbo-åè®®ç¼–è§£ç å™¨">Dubbo åè®®ç¼–è§£ç å™¨&lt;/h3>
&lt;p>Dubbo æœåŠ¡ä¸»è¦ä½¿ç”¨ Dubbo åè®®è¿›è¡Œé€šä¿¡ï¼Œä¸ºäº†æ”¯æŒ Kitex &amp;lt;-&amp;gt; Dubbo äº’é€šï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Kitex ä¸­å®ç° Dubbo åè®®ã€‚å¾—ç›Šäº Kitex ä¼˜ç§€çš„æ‰©å±•æ€§ï¼Œcodec-dubbo æ ¹æ® Kitex æä¾›çš„ Codec æ¥å£å®ç°äº† DubboCodec è¿™ä¸€æ ¸å¿ƒç¼–è§£ç å™¨ï¼Œåªéœ€åœ¨åˆå§‹åŒ–æ—¶æ³¨å…¥ DubboCodec ä¾¿èƒ½ä½¿ç”¨ Dubbo åè®®ã€‚&lt;/p>
&lt;h3 id="ç±»å‹æ˜ å°„ä¸æ‹“å±•">ç±»å‹æ˜ å°„ä¸æ‹“å±•&lt;/h3>
&lt;h4 id="ç±»å‹æ˜ å°„">ç±»å‹æ˜ å°„&lt;/h4>
&lt;p>Dubbo ä¸»è¦ä½¿ç”¨ Hessian2 åºåˆ—åŒ–åè®®è¿›è¡Œ Payload çš„ç¼–è§£ç ï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯è‡ªæè¿°åºåˆ—åŒ–ç±»å‹ï¼Œå³ä¸ä¾èµ–å¤–éƒ¨ Schema æˆ–æ¥å£å®šä¹‰ã€‚åºåˆ—åŒ–è¿‡ç¨‹ä¾èµ–ç¼–ç¨‹è¯­è¨€ç±»å‹å’Œ Hessian2 ç±»å‹ä¹‹é—´çš„æ˜ å°„ï¼Œä»¥ Go ç±»å‹è½¬åŒ–ä¸º Java ç±»å‹ä¸ºä¾‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Dubbo_interoperate/types_convert_process.png" alt="image">&lt;/p>
&lt;p>ç»è¿‡åˆ†æï¼Œæˆ‘ä»¬å‘ç° Hessian2 çš„åŸºç¡€ç±»å‹ç³»ç»Ÿä¸ Thrift åŸºæœ¬é‡åˆã€‚ä¸ºäº†ä¿è¯ Kitex + codec-dubbo çš„ä½¿ç”¨ä½“éªŒä¸ Kitex + Thrift åŸºæœ¬ä¸€è‡´ï¼Œæˆ‘ä»¬åŸºäº Thrift IDL æ¥ç”Ÿæˆ Kitex Dubbo-Hessian2 è„šæ‰‹æ¶ä»£ç ï¼Œæ­¤æ—¶ç±»å‹è½¬åŒ–è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Dubbo_interoperate/types_convert_process_with_thrift.png" alt="image">&lt;/p>
&lt;p>å‚è€ƒ Dubbo å®˜æ–¹çš„ &lt;a href="https://github.com/apache/dubbo-go-hessian2">dubbo-go-hessian2&lt;/a> ç±»å‹æ˜ å°„ï¼Œcodec-dubbo æä¾›å¦‚ä¸‹ç±»å‹æ˜ å°„(æ­¤å¤„ä»…åŒ…å«éƒ¨åˆ†æ˜ å°„ï¼Œæ›´å¤šæ³¨æ„äº‹é¡¹è¯·å‚è€ƒ codec-dubbo Readme )ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">&lt;strong>THRIFT ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>Go ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>HESSIAN2 ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>JAVA ç±»å‹&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">i32&lt;/td>
&lt;td style="text-align: center">int32&lt;/td>
&lt;td style="text-align: center">int&lt;/td>
&lt;td style="text-align: center">java.lang.Integer&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">double&lt;/td>
&lt;td style="text-align: center">float64&lt;/td>
&lt;td style="text-align: center">double&lt;/td>
&lt;td style="text-align: center">java.lang.Double&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">java.lang.String&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">list&lt;i32>&lt;/td>
&lt;td style="text-align: center">[]int32&lt;/td>
&lt;td style="text-align: center">list&lt;/td>
&lt;td style="text-align: center">List&lt;Integer>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">list&lt;double>&lt;/td>
&lt;td style="text-align: center">[]float64&lt;/td>
&lt;td style="text-align: center">list&lt;/td>
&lt;td style="text-align: center">List&lt;Double>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">list&lt;string>&lt;/td>
&lt;td style="text-align: center">[]string&lt;/td>
&lt;td style="text-align: center">list&lt;/td>
&lt;td style="text-align: center">List&lt;String>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">map&amp;lt;bool, i32&amp;gt;&lt;/td>
&lt;td style="text-align: center">map[bool]int32&lt;/td>
&lt;td style="text-align: center">map&lt;/td>
&lt;td style="text-align: center">Map&amp;lt;Boolean, Integer&amp;gt;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">map&amp;lt;bool, double&amp;gt;&lt;/td>
&lt;td style="text-align: center">map[bool]float64&lt;/td>
&lt;td style="text-align: center">map&lt;/td>
&lt;td style="text-align: center">Map&amp;lt;Boolean, Double&amp;gt;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">map&amp;lt;bool, string&amp;gt;&lt;/td>
&lt;td style="text-align: center">map[bool]string&lt;/td>
&lt;td style="text-align: center">map&lt;/td>
&lt;td style="text-align: center">Map&amp;lt;Boolean, String&amp;gt;&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æ ¹æ® codec-dubbo æä¾›çš„ç±»å‹æ˜ å°„ï¼Œæˆ‘ä»¬èƒ½å¾ˆè½»æ¾åœ°å°† Dubbo æ¥å£å®šä¹‰è½¬åŒ–ä¸º Thrift IDLï¼Œå¹¶ä½¿ç”¨ Kitex å‘½ä»¤è¡Œå·¥å…·ç”Ÿæˆé¡¹ç›®è„šæ‰‹æ¶ä»£ç ï¼Œæœ€ç»ˆæ³¨å…¥ DubboCodec å®Œæˆ Kitex -&amp;gt; Dubbo çš„é€šä¿¡ã€‚ä»¥ä¸‹æ–¹ Dubbo æ¥å£å®šä¹‰ä¸ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">package&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">org.cloudwego.kitex.samples.api&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">interface&lt;/span> &lt;span style="color:#000">GreetProvider&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetResponse&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Greet&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">throws&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Exception&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">class&lt;/span> &lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">implements&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Serializable&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">this&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#c4a000">req&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">class&lt;/span> &lt;span style="color:#000">GreetResponse&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">implements&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Serializable&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetResponse&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">this&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#c4a000">resp&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹åº”çš„ api.thrift æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼Œéœ€è¦æ³¨æ„åˆ°å…¶ä¸­çš„ç»“æ„ä½“å®šä¹‰éƒ½éœ€è¦åŠ ä¸Š &lt;code>JavaClassName&lt;/code> çš„æ³¨è§£ï¼Œå¯¹åº” Dubbo æ¥å£å®šä¹‰ä¸­çš„ package + ç±»åã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-thrift" data-lang="thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">required&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;org.cloudwego.kitex.samples.api.GreetRequest&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetResponse&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">required&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;org.cloudwego.kitex.samples.api.GreetResponse&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">service&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetService&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetResponse&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Greet&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿ç”¨ Kitex å‘½ä»¤è¡Œå·¥å…·ï¼Œå¹¶æŒ‡å®šåè®®ä¸º Hessian2ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kitex -module demo-client -protocol Hessian2 ./api.thrift
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹ååˆå§‹åŒ– DubboCodec å¹¶å°†å…¶æ³¨å…¥ Kitex ï¼Œåˆ©ç”¨ç”Ÿæˆä»£ç ç¼–å†™ä»¥ä¸‹ Client ç«¯ä»£ç å³å¯å®ç° Kitex -&amp;gt; Dubbo è°ƒç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">javaClass&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;org.cloudwego.kitex.samples.api.GreetProvider&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">greetservice&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewClient&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;helloworld&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// æŒ‡å®šæƒ³è¦è®¿é—®çš„æœåŠ¡ç«¯åœ°å€ï¼Œä¹Ÿæ”¯æŒ ZooKeeper æœåŠ¡å‘ç°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithHostPorts&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;127.0.0.1:21000&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// é…ç½® DubboCodec&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// æŒ‡å®šæƒ³è¦è°ƒç”¨çš„ Dubbo Interface&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">dubbo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewDubboCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dubbo&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithJavaClassName&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">javaClass&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87">panic&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Greet&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Background&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">hello&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">Req&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;world&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">})&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">klog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Error&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">klog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Infof&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;resp: %s&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Resp&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Kitex + codec-dubbo Server ç«¯æµç¨‹ä¸ Client ç«¯åŸºæœ¬ç±»ä¼¼ï¼Œå…·ä½“ä¾‹å­å¯å‚è€ƒé¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h4 id="ç±»å‹æ‹“å±•">ç±»å‹æ‹“å±•&lt;/h4>
&lt;p>Hessian2 schema-free çš„ç‰¹æ€§å¯¼è‡´ Dubbo çš„å®ç°â€œè¿‡äºçµæ´»â€ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹ã€‚ä¸ºäº†é€‚é… Dubbo Hessian2 çš„ç±»å‹ä½¿ç”¨çµæ´»æ€§ï¼Œcodec-dubbo æ”¯æŒç±»å‹æ‹“å±•ï¼Œå…¶ä¸­ä¸»è¦åŒ…æ‹¬è‡ªå®šä¹‰æ˜ å°„ä¸ Java å¸¸ç”¨ç±»å‹æ‹“å±•ã€‚&lt;/p>
&lt;h5 id="è‡ªå®šä¹‰æ˜ å°„">è‡ªå®šä¹‰æ˜ å°„&lt;/h5>
&lt;p>Java çš„åŸºç¡€ç±»å‹æœ‰ä¸ä¹‹å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œä¾‹å¦‚ &lt;code>boolean&lt;/code> ä¸ &lt;code>java.lang.Boolean&lt;/code>ã€‚ç±»å‹æ˜ å°„ä¸­é»˜è®¤å°† Go çš„ ç±»å‹æ˜ å°„åˆ° Java çš„ &lt;code>java.lang.Boolean&lt;/code> ç±»å‹å¹¶ä¸èƒ½è¦†ç›–åˆ°ä½¿ç”¨ &lt;code>boolean&lt;/code> çš„æƒ…å†µã€‚&lt;/p>
&lt;p>ä¸ºäº†ç»Ÿä¸€ç”¨æˆ·ä½¿ç”¨ä½“éªŒï¼Œè®©ä»–ä»¬åœ¨ Kitex ä¾§åªéœ€ä½¿ç”¨ &lt;code>bool&lt;/code> ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Thrift çš„æ–¹æ³•å®šä¹‰åé¢åŠ ä¸Š &lt;code>hessian.argsType=&amp;quot;boolean&amp;quot;&lt;/code> æ³¨è§£ï¼Œåˆ©ç”¨ thriftgo çš„ IDL åå°„åŠŸèƒ½ï¼Œæå‰ç”Ÿæˆ IDL å…ƒä¿¡æ¯å¹¶æ³¨å…¥ codec-dubboï¼Œä¾¿å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å°†é»˜è®¤æ˜ å°„ç±»å‹ &lt;code>java.lang.Boolean&lt;/code> æ”¹å†™æˆ &lt;code>boolean&lt;/code> ã€‚å…·ä½“ Thrift å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-thrift" data-lang="thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">service&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoService&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">bool&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoBoolean&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">bool&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">hessian.argsType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;boolean&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ &lt;code>boolean&lt;/code> å’Œ &lt;code>java.lang.Boolean&lt;/code> ç±»ä¼¼ï¼Œå…¶ä»– Java åŸºç¡€ç±»å‹å’ŒåŒ…è£…ç±»å‹ä¹Ÿèƒ½é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œè‡ªå®šä¹‰æ˜ å°„ï¼Œæ­¤æ—¶ codec-dubbo æä¾›çš„å®Œæ•´ç±»å‹æ˜ å°„å¦‚ä¸‹ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">&lt;strong>THRIFT ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>GO ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>HESSIAN2 ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>é»˜è®¤ JAVA ç±»å‹&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>å¯æ‹“å±• JAVA ç±»å‹&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">i32&lt;/td>
&lt;td style="text-align: center">int32&lt;/td>
&lt;td style="text-align: center">int&lt;/td>
&lt;td style="text-align: center">java.lang.Integer&lt;/td>
&lt;td style="text-align: center">int&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">double&lt;/td>
&lt;td style="text-align: center">float64&lt;/td>
&lt;td style="text-align: center">double&lt;/td>
&lt;td style="text-align: center">java.lang.Double&lt;/td>
&lt;td style="text-align: center">double float / java.lang.Float&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">java.lang.String&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">list&lt;i32>&lt;/td>
&lt;td style="text-align: center">[]int32&lt;/td>
&lt;td style="text-align: center">list&lt;/td>
&lt;td style="text-align: center">List&lt;Integer>&lt;/td>
&lt;td style="text-align: center">int[] / ArrayList&lt;Integer>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">list&lt;double>&lt;/td>
&lt;td style="text-align: center">[]float64&lt;/td>
&lt;td style="text-align: center">list&lt;/td>
&lt;td style="text-align: center">List&lt;Double>&lt;/td>
&lt;td style="text-align: center">double[] / ArrayList&lt;Double> float[]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">list&lt;string>&lt;/td>
&lt;td style="text-align: center">[]string&lt;/td>
&lt;td style="text-align: center">list&lt;/td>
&lt;td style="text-align: center">List&lt;String>&lt;/td>
&lt;td style="text-align: center">String[] / ArrayList&lt;String>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">map&amp;lt;bool, i32&amp;gt;&lt;/td>
&lt;td style="text-align: center">map[bool]int32&lt;/td>
&lt;td style="text-align: center">map&lt;/td>
&lt;td style="text-align: center">Map&amp;lt;Boolean, Integer&amp;gt;&lt;/td>
&lt;td style="text-align: center">HashMap&amp;lt;Boolean, Integer&amp;gt;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">map&amp;lt;bool, double&amp;gt;&lt;/td>
&lt;td style="text-align: center">map[bool]float64&lt;/td>
&lt;td style="text-align: center">map&lt;/td>
&lt;td style="text-align: center">Map&amp;lt;Boolean, Double&amp;gt;&lt;/td>
&lt;td style="text-align: center">HashMap&amp;lt;Boolean, Double&amp;gt;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">map&amp;lt;bool, string&amp;gt;&lt;/td>
&lt;td style="text-align: center">map[bool]string&lt;/td>
&lt;td style="text-align: center">map&lt;/td>
&lt;td style="text-align: center">Map&amp;lt;Boolean, String&amp;gt;&lt;/td>
&lt;td style="text-align: center">HashMap&amp;lt;Boolean, String&amp;gt;&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h5 id="java-å¸¸ç”¨ç±»å‹æ‹“å±•">java å¸¸ç”¨ç±»å‹æ‹“å±•&lt;/h5>
&lt;p>ç”±äº Thrift ç±»å‹çš„å±€é™æ€§ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨ Java ç±»åº“ä¸­æä¾›çš„å¸¸ç”¨ç±»å‹ã€‚ä¸ºæ­¤ï¼Œcodec-dubbo åœ¨ &lt;a href="https://github.com/kitex-contrib/codec-dubbo/tree/main/java">codec-dubbo/java&lt;/a> åŒ…ä¸­ç»´æŠ¤äº† Thrift ä¸æ”¯æŒçš„ Java ç±»å‹(ä¾‹å¦‚ &lt;code>java.lang.Object&lt;/code> ã€ &lt;code>java.util.Date&lt;/code> )ä»¥åŠä¸ä¹‹å¯¹åº”çš„ &lt;a href="https://github.com/kitex-contrib/codec-dubbo/blob/main/java/java.thrift">java.thrift&lt;/a> ï¼ŒåŒæ—¶å€ŸåŠ© thriftgo æä¾›çš„ idl-ref åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ Thrift IDL ä¸­å¼•ç”¨è¿™äº›ç±»å‹å¹¶ç”Ÿæˆç›¸åº”ä»£ç ã€‚å½“å‰çš„ java.thrift å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-thrift" data-lang="thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Object&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;java.lang.Object&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Date&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;java.util.Date&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Exception&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;java.lang.Exception&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ºäº†å¯ç”¨è¿™äº›ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Thrift IDL ä¸­ä½¿ç”¨ &lt;code>include &amp;quot;java.thrift&amp;quot;&lt;/code> å¯¼å…¥å®ƒä»¬ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨ Kitex å‘½ä»¤è¡Œå·¥å…·ç”Ÿæˆä»£ç æ—¶æ·»åŠ  &lt;code>-hessian2 java_extension&lt;/code> å‚æ•°æ¥æ‹‰å–è¯¥æ‹“å±•åŒ…ã€‚&lt;/p>
&lt;p>Kitex å‘½ä»¤è¡Œå·¥å…·ä¼šè‡ªåŠ¨ä¸‹è½½ java.thrift ï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨ä¸‹è½½åæ”¾åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ã€‚å¼•ç”¨ java.thrift ä¸­ç±»å‹çš„ Thrift IDL ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-thrift" data-lang="thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">include&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;java.thrift&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">service&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoService&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">// java.lang.Object
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoString2ObjectMap&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">map&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">java.Object&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">// java.util.Date
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoDate&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">java.Date&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ–¹æ³•é‡è½½">æ–¹æ³•é‡è½½&lt;/h3>
&lt;p>Go åŸç”Ÿä¸æ”¯æŒæ–¹æ³•é‡è½½ï¼Œåªèƒ½é€šè¿‡å®šä¹‰å¤šä¸ªæ–¹æ³•æ¥è¾¾åˆ°ç±»ä¼¼é‡è½½çš„æ•ˆæœã€‚ä¸ºäº†å°† Go ä¸­çš„å¤šä¸ªæ–¹æ³•æ˜ å°„åˆ° Java ä¸­çš„é‡è½½æ–¹æ³•ï¼Œä¸è‡ªå®šä¹‰æ˜ å°„ä¸€èŠ‚ç±»ä¼¼ï¼Œæˆ‘ä»¬åœ¨ Thrift çš„æ–¹æ³•å®šä¹‰åé¢åŠ ä¸Š &lt;code>JavaMethodName&lt;/code> æ ‡ç­¾ï¼Œå€ŸåŠ© thriftgo çš„ IDL åå°„åŠŸèƒ½åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å°† Go ä¾§åŸæœ¬çš„æ–¹æ³•åæ”¹å†™æˆ &lt;code>JavaMethodName&lt;/code> æŒ‡å®šçš„ Java ä¾§ä¸­çš„é‡è½½æ–¹æ³•ã€‚&lt;/p>
&lt;p>ä»¥ Java ä¾§çš„ EchoMethod ä¸ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethod&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">Boolean&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethod&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">Integer&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethod&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethod&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">Boolean&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Integer&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req2&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ç¼–å†™å¦‚ä¸‹ Thrift å®šä¹‰ï¼Œå³å¯å®Œæˆ Go ä¸ Java é—´çš„é‡è½½æ–¹æ³•æ˜ å°„ï¼Œæ³¨æ„åˆ° &lt;code>JavaMethodName&lt;/code> å’Œ &lt;code>hessian.argsType&lt;/code> å¯ä»¥åŒæ—¶ä½¿ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-thrift" data-lang="thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">service&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoService&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethodA&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">bool&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaMethodName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;EchoMethod&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethodB&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i32&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaMethodName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;EchoMethod&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethodC&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i32&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaMethodName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;EchoMethod&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">hessian.argsType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;int&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">EchoMethodD&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">bool&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i32&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">req2&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">JavaMethodName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;EchoMethod&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å¼‚å¸¸å¤„ç†">å¼‚å¸¸å¤„ç†&lt;/h3>
&lt;p>codec-dubbo å°† Java ä¸­çš„å¼‚å¸¸æ˜ å°„ä¸º Go ä¸­çš„é”™è¯¯ï¼Œè¿™äº›é”™è¯¯ç»Ÿä¸€å®ç°ä»¥ä¸‹æ¥å£ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">Throwabler&lt;/span> &lt;span style="color:#204a87;font-weight:bold">interface&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Error&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">GetStackTrace&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#000">StackTraceElement&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ ¹æ® Dubbo å®˜æ–¹æ¨èçš„å¼‚å¸¸å¤„ç†å®è·µä»¥åŠä¼ä¸šç”¨æˆ·ç›®å‰çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å°†å¼‚å¸¸åˆ’åˆ†ä¸ºå¸¸è§å¼‚å¸¸ä¸è‡ªå®šä¹‰å¼‚å¸¸ï¼ŒåŒæ—¶å…¼é¡¾ç”¨æˆ·çš„åŸºç¡€éœ€æ±‚ä»¥åŠå¯æ‰©å±•éœ€æ±‚ã€‚&lt;/p>
&lt;h4 id="å¸¸è§å¼‚å¸¸">å¸¸è§å¼‚å¸¸&lt;/h4>
&lt;p>codec-dubbo åœ¨ &lt;a href="https://github.com/kitex-contrib/codec-dubbo/tree/main/pkg/hessian2/exception">pkg/hessian2/exception&lt;/a> åŒ…ä¸­æä¾›äº† Java å¸¸è§çš„å¼‚å¸¸ï¼Œç›®å‰æ”¯æŒ &lt;code>java.lang.Exception&lt;/code> ã€‚&lt;/p>
&lt;p>å¸¸è§å¼‚å¸¸æ— éœ€ Kitex å‘½ä»¤è¡Œå·¥å…·çš„æ”¯æŒï¼Œç›´æ¥å¼•ç”¨å³å¯ï¼Œä»¥ä¸‹æ˜¯ Client ç«¯æå–å¼‚å¸¸å’Œ Server ç«¯è¿”å›å¼‚å¸¸çš„ç¤ºä¾‹ã€‚&lt;/p>
&lt;h5 id="clientç«¯æå–å¼‚å¸¸">Clientç«¯æå–å¼‚å¸¸&lt;/h5>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">resp&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Greet&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Background&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">hello&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">Req&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;world&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">})&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// FromError è¿”å› Throwabler&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">exceptionRaw&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">hessian2_exception&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FromError&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">!&lt;/span>&lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// è§†ä½œå¸¸è§„é”™è¯¯å¤„ç†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">else&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// è‹¥ä¸å…³å¿ƒ exceptionRaw çš„å…·ä½“ç±»å‹ï¼Œç›´æ¥è°ƒç”¨ Throwabler æä¾›çš„æ–¹æ³•å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">klog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Errorf&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;get %s type Exception&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">exceptionRaw&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// è‹¥æƒ³è·å¾— exceptionRaw çš„å…·ä½“ç±»å‹ï¼Œéœ€è¦è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä½†å‰ææ˜¯å·²çŸ¥è¯¥å…·ä½“ç±»å‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">exception&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">exceptionRaw&lt;/span>&lt;span style="color:#000;font-weight:bold">.(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">hessian2_exception&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Exception&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h5 id="serverç«¯è¿”å›å¼‚å¸¸">Serverç«¯è¿”å›å¼‚å¸¸&lt;/h5>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">s&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">GreetServiceImpl&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">Greet&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Context&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">req&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">hello&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GreetRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">resp&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">hello&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GreetResponse&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">hessian2_exception&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewException&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Your detailed message&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="è‡ªå®šä¹‰å¼‚å¸¸">è‡ªå®šä¹‰å¼‚å¸¸&lt;/h4>
&lt;p>Java ä¸­çš„è‡ªå®šä¹‰å¼‚å¸¸å¾€å¾€ä¼šç»§æ‰¿ä¸€ä¸ªåŸºç¡€å¼‚å¸¸ï¼Œè¿™é‡Œä»¥ &lt;code>CustomizedException&lt;/code> ä¸ºä¾‹ï¼Œ&lt;code>CustomizedException&lt;/code> ç»§æ‰¿äº† &lt;code>java.lang.Exception&lt;/code> ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">class&lt;/span> &lt;span style="color:#000">CustomizedException&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">extends&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Exception&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">private&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">final&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">customizedMessage&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">public&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">CustomizedException&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">String&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">customizedMessage&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">super&lt;/span>&lt;span style="color:#000;font-weight:bold">();&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">this&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#c4a000">customizedMessage&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">customizedMessage&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾—ç›Šäº thriftgo æ”¯æŒç”ŸæˆåµŒå¥—ç»“æ„ä½“ï¼Œä¸ºäº†åœ¨ Kitex ä¾§å®šä¹‰ä¸ä¹‹å¯¹åº”çš„å¼‚å¸¸ï¼Œæˆ‘ä»¬åœ¨ Thrift ä¸­ç¼–å†™å¦‚ä¸‹å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-thrift" data-lang="thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">exception&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">CustomizedException&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">// thrift.nested=â€œtrueâ€ æ³¨è§£è®© thriftgo ç”ŸæˆåµŒå¥—ç»“æ„ä½“
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">required&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">java.Exception&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">exception&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>&lt;span style="color:#000">thrift.nested&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;true&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">required&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">customizedMessage&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}(&lt;/span>&lt;span style="color:#000">JavaClassName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;org.cloudwego.kitex.samples.api.CustomizedException&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„ &lt;code>exception&lt;/code> å­—æ®µçš„æ³¨è§£ &lt;code>thrift.nested=&amp;quot;true&amp;quot;&lt;/code> ï¼Œå®ƒè®© thriftgo ç”ŸæˆåµŒå¥—ç»“æ„ä½“ï¼Œè¾¾åˆ°ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœã€‚&lt;/p>
&lt;p>å’Œ Java å¸¸ç”¨ç±»å‹æ‰©å±•ä¸€æ ·ï¼Œéœ€è¦åœ¨ä½¿ç”¨ kitex è„šæ‰‹æ¶å·¥å…·ç”Ÿæˆä»£ç æ—¶æ·»åŠ  &lt;code>-hessian2 java_extension&lt;/code> å‚æ•°æ¥æ‹‰å–æ‹“å±•åŒ…ï¼Œç”Ÿæˆä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">EchoCustomizedException&lt;/span> &lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">java&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Exception&lt;/span> &lt;span style="color:#4e9a06">`thrift:&amp;#34;exception,1,required&amp;#34; frugal:&amp;#34;1,required,java.Exception&amp;#34; json:&amp;#34;exception&amp;#34;`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">CustomizedMessage&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#4e9a06">`thrift:&amp;#34;customizedMessage,2,required&amp;#34; frugal:&amp;#34;2,required,string&amp;#34; json:&amp;#34;customizedMessage&amp;#34;`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿ç”¨æ–¹æ³•ä¸å¸¸è§å¼‚å¸¸ä¸€è‡´ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚&lt;/p>
&lt;h3 id="æœåŠ¡æ³¨å†Œä¸å‘ç°">æœåŠ¡æ³¨å†Œä¸å‘ç°&lt;/h3>
&lt;p>Dubbo åŒæ—¶æä¾›&lt;strong>æ¥å£çº§&lt;/strong>ä¸&lt;strong>åº”ç”¨çº§&lt;/strong>æœåŠ¡æ³¨å†Œå‘ç°æ¨¡å‹ï¼Œæ ¹æ®ä¼ä¸šç”¨æˆ·å½“å‰çš„ç”Ÿäº§ç¯å¢ƒéœ€è¦ï¼Œæˆ‘ä»¬é€‰æ‹©ä¼˜å…ˆå®ç°åŸºäº zookeeper çš„&lt;strong>æ¥å£çº§&lt;/strong>æ¨¡å‹ï¼šDubbo registry-zookeeperã€‚&lt;/p>
&lt;p>ä¸æˆ‘ä»¬ç†ŸçŸ¥çš„åº”ç”¨çº§æ¨¡å‹ä¸åŒï¼Œæ¥å£çº§æ¨¡å‹éœ€è¦ç»´æŠ¤æ¥å£å =&amp;gt; æœåŠ¡(ä¸åŒäºå¾®æœåŠ¡ï¼Œæ›´æ¥è¿‘ Handler )çš„æ˜ å°„å…³ç³»ï¼Œä¸€ä¸ªæ¥å£åä¼šæ˜ å°„åˆ°å¤šä¸ªæœåŠ¡ ï¼Œè¿™äº›æœåŠ¡å¯èƒ½ä¼šå­˜åœ¨äºåŒä¸€ä¸ªè¿›ç¨‹ä¸­ã€‚&lt;/p>
&lt;p>è€ƒè™‘åˆ° Dubbo çš„æ¥å£çº§æœåŠ¡æ¨¡å‹ä¸ Kitex çš„æœåŠ¡æ¨¡å‹å·®åˆ«è¾ƒå¤§ï¼Œä¸” Dubbo registry-zookeeper åº”ç»‘å®š codec-dubbo ä½¿ç”¨ï¼Œå› æ­¤ä¸è€ƒè™‘ä¿®æ”¹ kitex-contrib ä¸­åŸæœ‰çš„ registry-zookeeperï¼Œè®© dubbo registry-zookeeper æˆä¸º codec-dubbo çš„ä¸€ä¸ªå­ go module ç»Ÿä¸€è¿›è¡Œå¼€å‘ä¸ç»´æŠ¤ã€‚&lt;/p>
&lt;p>ç»¼åˆè€ƒè™‘ Dubbo æ¥å£çº§æœåŠ¡æ¨¡å‹ã€Kitex API ä¸ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒï¼Œæˆ‘ä»¬æä¾›ä»¥ä¸‹çš„é…ç½®å±‚æ¬¡ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;a href="https://github.com/kitex-contrib/codec-dubbo/blob/main/registries/zookeeper/registry/options.go">registry/options.go&lt;/a> ä¸ &lt;a href="https://github.com/kitex-contrib/codec-dubbo/blob/main/registries/zookeeper/resolver/options.go">resolver/options.go&lt;/a> ä¸­çš„ WithServers å’Œ WithRegistryGroup å‡½æ•°æä¾›æ³¨å†Œä¸­å¿ƒçº§åˆ«çš„é…ç½®ï¼Œåˆ†åˆ«æŒ‡å®š zookeeper çš„åœ°å€å’Œè¿™äº› zookeeper æ‰€å±çš„ç»„ã€‚ç”¨æˆ·ä½¿ç”¨è¿™äº›å‡½æ•°ç”Ÿæˆ Kitex ä¸­ &lt;code>registry.Registry&lt;/code> å’Œ &lt;code>discovery.Resolver&lt;/code> å®ä¾‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœåŠ¡çº§åˆ«çš„é…ç½®ç”± &lt;code>client.WithTag&lt;/code> ä¸ &lt;code>server.WithRegistryInfo&lt;/code> è¿›è¡Œä¼ é€’ï¼Œ&lt;a href="https://github.com/kitex-contrib/codec-dubbo/blob/main/registries/common.go">registries/common.go&lt;/a> æä¾› Tag keys ï¼Œè¿™äº› key ä¸ Dubbo ä¸­çš„æœåŠ¡å…ƒæ•°æ®ä¸€ä¸€å¯¹åº”ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="resolver-ç¤ºä¾‹">resolver ç¤ºä¾‹&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">intfName&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;org.cloudwego.kitex.samples.api.GreetProvider&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">res&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">resolver&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewZookeeperResolver&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// æŒ‡å®š zookeeper æœåŠ¡å™¨çš„åœ°å€ï¼Œå¯æŒ‡å®šå¤šä¸ªï¼Œè¯·è‡³å°‘æŒ‡å®šä¸€ä¸ª&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">resolver&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithServers&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;127.0.0.1:2181&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87">panic&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">cli&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">greetservice&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewClient&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;helloworld&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// é…ç½® ZookeeperResolver&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithResolver&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">res&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// æŒ‡å®šæƒ³è¦è°ƒç”¨çš„ dubbo Interface&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithTag&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">registries&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">DubboServiceInterfaceKey&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">intfName&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87">panic&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// ä½¿ç”¨ cli è¿›è¡Œ RPC è°ƒç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="registry-ç¤ºä¾‹">registry ç¤ºä¾‹&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">intfName&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;org.cloudwego.kitex.samples.api.GreetProvider&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">reg&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">registry&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewZookeeperRegistry&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// æŒ‡å®š zookeeper æœåŠ¡å™¨çš„åœ°å€ï¼Œå¯æŒ‡å®šå¤šä¸ªï¼Œè¯·è‡³å°‘æŒ‡å®šä¸€ä¸ª&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">registry&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithServers&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;127.0.0.1:2181&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87">panic&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">svr&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">greetservice&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewServer&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87">new&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">GreetServiceImpl&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">server&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithRegistry&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">reg&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// é…ç½®dubbo URLå…ƒæ•°æ®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">server&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WithRegistryInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">kitex_registry&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Info&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Tags&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">map&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">registries&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">DubboServiceInterfaceKey&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">intfName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// applicationè¯·ä¸dubboæ‰€è®¾ç½®çš„ApplicationConfigä¿æŒä¸€è‡´ï¼Œæ­¤å¤„ä»…ä¸ºç¤ºä¾‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">registries&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">DubboServiceApplicationKey&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;application-name&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// å¯åŠ¨ svr&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>Kitex æ”¯æŒäº† Dubbo åè®®ï¼Œæ˜¯ CloudWeGo åŠ©åŠ›å¤šè¯­è¨€äº‘åŸç”Ÿç”Ÿæ€èåˆçš„ä¸€å¤§æ­¥ï¼Œè§£å†³äº†ä¼—å¤šä¼ä¸šç”¨æˆ· Java è½¬ Go ã€ Java ä¸ Go å¹¶å­˜çš„ç—›ç‚¹ï¼Œæ¬¢è¿å¤§å®¶è¯•ç”¨å’Œæ¥å…¥ï¼›å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥åŠ å…¥æˆ‘ä»¬çš„é£ä¹¦ç”¨æˆ·ç¾¤ï¼Œæˆ–è€…åœ¨ Github ä¸Šç»™æˆ‘ä»¬æåé¦ˆã€‚&lt;/p></description></item><item><title>Blog: Kitex Release v0.9.0</title><link>https://www.cloudwego.io/zh/blog/2024/03/04/kitex-release-v0.9.0/</link><pubDate>Mon, 04 Mar 2024 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2024/03/04/kitex-release-v0.9.0/</guid><description>
&lt;p>v0.9.0 é’ˆå¯¹ Thrift æä¾›äº†ä¸¤ä¸ªé‡è¦çš„åŠŸèƒ½ï¼šThrift Streaming å’Œ Multi-Serviceï¼Œå‘å¸ƒå¤šä¸ª RC ç‰ˆæœ¬åœ¨å†…éƒ¨è¯•ç‚¹æ”¶é›†åé¦ˆï¼Œæ‰€ä»¥æ­£å¼ç‰ˆæœ¬å§—å§—æ¥è¿Ÿã€‚&lt;/p>
&lt;p>ä¸‹é¢å°±é‡è¦å˜æ›´åšä¸€äº›ä»‹ç»ï¼š&lt;/p>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>&lt;strong>1. Thrift Streaming&lt;/strong>&lt;/p>
&lt;p>åŸºäº gRPC(HTTP2) çš„ Thrift Streaming åŠŸèƒ½æ­£å¼ Releaseï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ Thrift IDL å®šä¹‰è‡ªå·±çš„ Streaming è¯·æ±‚ï¼Œä¸ºä¿æŒ IDL è§£æçš„å…¼å®¹æ€§ï¼ŒKitex çš„ Streaming æ–¹æ³•çš„å®šä¹‰é€šè¿‡æ³¨è§£çš„æ–¹å¼ï¼Œä½¿ç”¨æ–¹å¼è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/protocol/streaming/grpc/thrift_streaming/">Thrift Streaming Usage&lt;/a>ã€‚æœ¬ç‰ˆæœ¬ä¹Ÿå¯¹ Streaming è¯·æ±‚çš„ç›‘æ§ä¸ŠæŠ¥åšäº†æ”¹è¿›ï¼ŒåŒæ ·é€‚ç”¨äº gRPC-Protobufã€‚æ³¨æ„ï¼ŒThrift ä¸»è¦ç”¨äºç»“æ„ä½“åºåˆ—åŒ–ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ Thrift æ¶ˆæ¯åè®®ã€‚&lt;/p>
&lt;p>ç”±äº HTTP2 åè®®çš„å¤æ‚æ€§å¯¹æ€§èƒ½æœ‰ä¸€å®šæœ‰å½±å“ï¼Œåç»­è®¡åˆ’å‘å¸ƒè‡ªç ” Streaming åè®®æå‡æ€§èƒ½ã€‚&lt;/p>
&lt;p>&lt;strong>2. å®Œæ•´çš„ Thrift MultiService æ”¯æŒ&lt;/strong>&lt;/p>
&lt;p>åœ¨ v0.8.0 ç‰ˆæœ¬ä¸­ï¼ŒKitex å¯¹ gRPC å¯¹é½äº†å¤š Service çš„èƒ½åŠ›ï¼Œè€Œ Thrift å¤š Service ä¹‹å‰ä¸ºä¿è¯åè®®çš„å…¼å®¹æ€§æä¾›äº† &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/combine_service/">Combine Service&lt;/a> æ”¯æŒï¼Œä½†è¯¥åŠŸèƒ½çš„ä½¿ç”¨è¦æ±‚ä¸åŒ IDL Service çš„æ–¹æ³•ä¸èƒ½ç›¸åŒï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„å¤š Serviceã€‚æœ¬æ¬¡ç‰ˆæœ¬ä¸­ Kitex åŸºäº TTHeader æä¾›äº†åè®®å±‚é¢çœŸæ­£çš„å¤š Service åŠŸèƒ½ï¼Œæ”¯æŒåœ¨ä¸€ä¸ª Server é‡Œæ³¨å†Œå¤šä¸ª Thrift IDL Serviceï¼ŒåŒæ—¶å…¼å®¹æ—§çš„ CombineServiceã€‚ä½¿ç”¨æ–¹å¼è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/multi_service/">Multi-Service&lt;/a>ã€‚&lt;/p>
&lt;p>æ³¨ï¼šThrift Multi-Service éœ€ä½¿ç”¨ TTHeader ä¼ è¾“åè®®ã€‚&lt;/p>
&lt;p>&lt;strong>3. Frugal å¯¹ ARM64 çš„å®éªŒæ€§æ”¯æŒ&lt;/strong>&lt;/p>
&lt;p>æ”¯æŒåœ¨ ARM64 æœºå™¨ä¸Šä½¿ç”¨ Frugalï¼Œæš‚æ—¶æ˜¯ Fallback æ”¯æŒã€‚&lt;/p>
&lt;p>&lt;strong>4. æœåŠ¡ç«¯è¶…æ—¶&lt;/strong>&lt;/p>
&lt;p>å¢åŠ  &lt;code>server.WithEnableContextTimeout&lt;/code> option æ”¯æŒåœ¨æœåŠ¡ç«¯ç»™ context å¢åŠ  timeoutï¼ŒåŒæ—¶æ–°ç‰ˆæœ¬é‡Œï¼ŒKitex ä¼šé»˜è®¤é€ä¼  Client è¶…æ—¶é…ç½®ç»™ä¸‹æ¸¸ Serverã€‚è¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/timeout/">è¶…æ—¶é…ç½®&lt;/a>ã€‚&lt;/p>
&lt;p>æ³¨ï¼šéœ€ä½¿ç”¨ TTHeader ä¼ è¾“åè®®ã€‚&lt;/p>
&lt;p>&lt;strong>5. KitexProtobuf åè®®æ”¯æŒ JSON æ³›åŒ–è°ƒç”¨&lt;/strong>&lt;/p>
&lt;p>ä¸ Thrift çš„ JSON æ³›åŒ–è°ƒç”¨ä½¿ç”¨æ–¹å¼ä¸€æ ·ï¼Œæ–°ç‰ˆæœ¬å¯¹ KitexProtobuf ä¹Ÿåšäº†åŒæ ·çš„æ”¯æŒã€‚è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/#jsonpbgeneric">JSONPbGeneric&lt;/a>ã€‚&lt;/p>
&lt;p>æ³¨ï¼šéœ€ä½¿ç”¨ TTHeader ä¼ è¾“åè®®ã€‚&lt;/p>
&lt;p>&lt;strong>6. è´Ÿè½½å‡è¡¡æ–°å¢ç­–ç•¥&lt;/strong>&lt;/p>
&lt;p>æ–°å¢ Alias Method çš„è´Ÿè½½å‡è¡¡æ–¹æ³•ï¼Œæ¥å‡å°‘æƒé‡éšæœºè´Ÿè½½å‡è¡¡ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚é€šè¿‡ &lt;code>client.WithLoadBalancer(loadbalance.NewWeightedRandomWithAliasMethodBalancer())&lt;/code> æŒ‡å®šã€‚&lt;/p>
&lt;h3 id="ç‰¹åˆ«çš„å˜æ›´">ç‰¹åˆ«çš„å˜æ›´&lt;/h3>
&lt;p>v0.9.0 è¦æ±‚ Go ç‰ˆæœ¬å¿…é¡» &amp;gt;= 1.17ï¼Œä¸å†å…¼å®¹ Go &amp;lt;= v1.16 (ç¨³å®šæ€§è¦æ±‚å¿…é¡»å‡çº§ golang.org/x/ åº“å¼•å…¥çš„ Go ç‰ˆæœ¬é™åˆ¶)&lt;/p>
&lt;h2 id="é…ç½®ä¸­å¿ƒçš„æ‰©å±•ç”Ÿæ€å®Œå–„">&lt;strong>é…ç½®ä¸­å¿ƒçš„æ‰©å±•ç”Ÿæ€å®Œå–„&lt;/strong>&lt;/h2>
&lt;blockquote>
&lt;p>æ³¨æ„ä¸ v0.9.0 ç‰ˆæœ¬æ— å…³ï¼Œä»…åŒæ­¥ç¤¾åŒºæ‰©å±•çš„çŠ¶æ€&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>ä¸»æµçš„é…ç½®ä¸­å¿ƒå¯¹æ¥å‡å®Œæˆ Release&lt;/strong>&lt;/p>
&lt;p>Kitex å¯¹è¶…æ—¶ã€é‡è¯•ã€ç†”æ–­ã€é™æµçš„ç­–ç•¥æ”¯æŒé€šè¿‡è¿œç¨‹é…ç½®ä¸­å¿ƒæ¥æ§åˆ¶ï¼Œæ„Ÿè°¢ç¤¾åŒºçš„è´¡çŒ®è€…ä»¬ï¼Œç›®å‰&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/third-party/config-center/">ä¸»æµçš„é…ç½®ä¸­å¿ƒ&lt;/a>å‡å·²å®Œæˆæ‰©å±•å¯¹æ¥å¹¶ Releaseï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/third-party/config-center/">é…ç½®ä¸­å¿ƒ&lt;/a>ã€‚&lt;/p>
&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1208">#1208&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/1251">#1251&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/1230">#1230&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/1226">#1226&lt;/a>] feat: support thrift streaming (replacing the protobuf payload of GRPC/HTTP2 with thrift binary)&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1217">#1217&lt;/a>] feat: support thrift and pb multi service&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1268">#1268&lt;/a>] feat(thrift): support frugal fallback for arm&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/951">#951&lt;/a>] feat(bizerr): support returning biz status error for json/map generic server&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1199">#1199&lt;/a>] feat(loadbalance): add loadbalancer using Alias Method (#1184)&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1244">#1244&lt;/a>] feat(timeout): add option server.WithEnableContextTimeout to enable server timeout&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1228">#1228&lt;/a>] feat(streaming): Adding Recv/End events to streaming requests to improve trace information&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1062">#1062&lt;/a>] feat(generic): supports JSON and Map generic call for the KitexProtobuf protocol, &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/basic_usage/#jsonpbgeneric">doc&lt;/a>&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1225">#1225&lt;/a>] feat(timeout): support timeout transparent transmission by default when using TTHeader transport protocol&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1211">#1211&lt;/a>] feat(hessian2): support nested struct for hessian2 customized Exception&lt;/li>
&lt;/ol>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1222">#1222&lt;/a>] optimize(frugal): enable frugal by default when the generated code is using slim template&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1209">#1209&lt;/a>] optimize: split encoder interface to customize meta and payload encoding implementation&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1206">#1206&lt;/a>] optimize(tool): add IsDir judge in readTemplate and add template register func&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1198">#1198&lt;/a>] optimize(kitexutil): add util api for getting real request and response&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1197">#1197&lt;/a>] optimize(kitexutil): add GetCallerIP util method in kitexutil to fetch Caller IP&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1195">#1195&lt;/a>] optimize(error): more specific instruction when panic in server handler&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1235">#1235&lt;/a>] optimize(tool): add IDLName field in PackageInfo for cwgo tool rendering&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1238">#1238&lt;/a>] optimize(bizerr): support biz status error for streaming mode&lt;/li>
&lt;/ol>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1236">#1236&lt;/a>] fix(hessian2): correct code-ref behavior when thrift file is not in project dir&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1234">#1234&lt;/a>] fix(hessian2): still perform replacement on handler.go when -service is not specified for hessian2&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1232">#1232&lt;/a>] fix(gRPC): append &amp;ldquo;h2&amp;rdquo; to next proto in gRPC tlsConfig to enable protocol negotiation in TLS&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1215">#1215&lt;/a>] fix: bugfix for hessian2 tpl codegen&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1203">#1203&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/1205">#1205&lt;/a>] fix: fix the issue where disabling rpcinfo reuse on the server side does not take effect&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1227">#1227&lt;/a>] fix: idl-ref overwritten when using hessian2&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1194">#1194&lt;/a>] fix(retry): always set RespOp &amp;amp;&amp;amp; preventive panic to avoid dead loop&lt;/li>
&lt;/ol>
&lt;h3 id="chore--tests">Chore &amp;amp; Tests&lt;/h3>
&lt;ol>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1273">#1273&lt;/a>] chore: upgrade netpoll to v0.6.0&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1263">#1263&lt;/a>] chore: update sonic to v1.11.1&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1255">#1255&lt;/a>] chore: upgrade netpoll to v0.6.0 pre-release version&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1252">#1252&lt;/a>] chore: upgrade golang.org/x/net&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1254">#1254&lt;/a>] chore: upgrade sonic to v1.11.0 to support go1.22&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1231">#1231&lt;/a>] chore: frugal support go1.22&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1220">#1220&lt;/a>] test: correct the cachekey in the benchmark test of balancer&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1196">#1196&lt;/a>] test: add just biz handler message error&lt;/li>
&lt;/ol>
&lt;hr>
&lt;p>&lt;strong>Thanks a lot to those community contributors who submit some pull requests or share your ideas for this version:&lt;/strong>
@DMwangnima @jizhuozhi @NX-Official @jieqiboh @Lvnszn @Skyenought&lt;/p></description></item><item><title>Blog: Kitex ä¸¤å‘¨å¹´å›é¡¾ â€” èƒ½åŠ›å‡çº§ã€ç¤¾åŒºåˆä½œä¸æœªæ¥å±•æœ›</title><link>https://www.cloudwego.io/zh/blog/2023/11/30/kitex-%E4%B8%A4%E5%91%A8%E5%B9%B4%E5%9B%9E%E9%A1%BE-%E8%83%BD%E5%8A%9B%E5%8D%87%E7%BA%A7%E7%A4%BE%E5%8C%BA%E5%90%88%E4%BD%9C%E4%B8%8E%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B/</link><pubDate>Thu, 30 Nov 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/11/30/kitex-%E4%B8%A4%E5%91%A8%E5%B9%B4%E5%9B%9E%E9%A1%BE-%E8%83%BD%E5%8A%9B%E5%8D%87%E7%BA%A7%E7%A4%BE%E5%8C%BA%E5%90%88%E4%BD%9C%E4%B8%8E%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B/</guid><description>
&lt;blockquote>
&lt;p>æœ¬ç¯‡æ–‡ç« æ˜¯ CloudWeGo ä¸¤å‘¨å¹´åº†å…¸ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä»Šå¤©çš„åˆ†äº«ä¸»è¦åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼Œé¦–å…ˆæ˜¯ &lt;a href="http://github.com/cloudwego/kitex">Kitex&lt;/a> çš„èƒ½åŠ›å‡çº§ï¼Œçœ‹ä¸€ä¸‹è¿‡å»ä¸€å¹´åœ¨&lt;strong>æ€§èƒ½&lt;/strong>ã€&lt;strong>åŠŸèƒ½&lt;/strong>å’Œ&lt;strong>æ˜“ç”¨æ€§&lt;/strong>è¿™ä¸ªæ–¹é¢ä¸Šçš„ä¸€äº›è¿›å±•ã€‚ç¬¬äºŒä¸ªæ˜¯ç¤¾åŒºåˆä½œé¡¹ç›®çš„è¿›å±•ï¼Œç‰¹åˆ«æ˜¯å…¶ä¸­ä¸¤ä¸ªé‡ç‚¹é¡¹ç›® &lt;strong>Kitex-Dubbo äº’é€š&lt;/strong>ä»¥åŠ&lt;strong>é…ç½®ä¸­å¿ƒé›†æˆ&lt;/strong>ã€‚ç¬¬ä¸‰ä¸ªæ˜¯ç»™å¤§å®¶å‰§é€ä¸€ä¸‹æˆ‘ä»¬ç›®å‰åœ¨åšä»¥åŠè®¡åˆ’åšçš„ä¸€äº›äº‹æƒ…ã€‚&lt;/p>
&lt;h2 id="èƒ½åŠ›å‡çº§">èƒ½åŠ›å‡çº§&lt;/h2>
&lt;h3 id="æ€§èƒ½">æ€§èƒ½&lt;/h3>
&lt;p>åœ¨2021å¹´9æœˆï¼Œæˆ‘ä»¬æ›¾å‘å¸ƒäº†ä¸€ç¯‡&lt;a href="https://www.cloudwego.io/zh/blog/2020/05/24/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8%E5%9C%A8-go-%E7%BD%91%E7%BB%9C%E5%BA%93%E4%B8%8A%E7%9A%84%E5%AE%9E%E8%B7%B5/">å­—èŠ‚è·³åŠ¨ Go RPCæ¡†æ¶ Kitex æ€§èƒ½ä¼˜åŒ–å®è·µ&lt;/a>ï¼Œ
è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•é€šè¿‡è‡ªç ”ç½‘ç»œåº“ &lt;a href="http://github.com/cloudwego/netpoll">Netpoll&lt;/a>ã€åŠè‡ªç ”çš„ Thrift ç¼–è§£ç å™¨ fastCodec æ¥ä¼˜åŒ– &lt;a href="http://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ€§èƒ½ã€‚&lt;/p>
&lt;p>è‡ªé‚£æ—¶èµ·ï¼Œæå‡ Kitex æ ¸å¿ƒè¯·æ±‚é“¾è·¯ä¸Šçš„æ€§èƒ½å°±éå¸¸å›°éš¾äº†ï¼Œå®é™…ä¸Šæˆ‘ä»¬æ˜¯è¦åŠªåŠ›ï¼Œåœ¨ä¸æ–­åœ°æ·»åŠ æ–°åŠŸèƒ½çš„åŒæ—¶ï¼Œé¿å… Kitex æ€§èƒ½ä¸‹é™ã€‚&lt;/p>
&lt;p>å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¸€ç›´æ²¡æœ‰åœæ­¢ä¼˜åŒ– Kitex æ€§èƒ½çš„å°è¯•ã€‚åœ¨å­—èŠ‚å†…éƒ¨ï¼Œæˆ‘ä»¬å·²ç»åœ¨è¯•éªŒã€æ¨å¹¿ä¸€äº›åœ¨æ ¸å¿ƒé“¾è·¯ä¸Šçš„æ€§èƒ½æå‡ï¼Œç¨åä¼šå†ç»™å„ä½ä»‹ç»ã€‚&lt;/p>
&lt;h4 id="åŸºäº-dynamicgo-çš„æ³›åŒ–è°ƒç”¨">åŸºäº DynamicGo çš„æ³›åŒ–è°ƒç”¨&lt;/h4>
&lt;p>é¦–å…ˆä»‹ç»ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ€§èƒ½ä¼˜åŒ–ï¼šåŸºäº &lt;a href="http://github.com/cloudwego/dynamicgo">DynamicGo&lt;/a> çš„æ³›åŒ–è°ƒç”¨ã€‚&lt;strong>æ³›åŒ–è°ƒç”¨&lt;/strong>æ˜¯ Kitex çš„ä¸€ä¸ªé«˜çº§ç‰¹æ€§ï¼Œèƒ½å¤Ÿåœ¨ä¸é¢„å…ˆç”Ÿæˆ SDK ä»£ç ï¼ˆä¹Ÿå°±æ˜¯ Kitex Clientï¼‰çš„å‰æä¸‹ï¼Œä½¿ç”¨ Kitex Generic Client ç›´æ¥è°ƒç”¨ç›®æ ‡æœåŠ¡çš„ APIã€‚&lt;/p>
&lt;p>ä¾‹å¦‚å­—èŠ‚è·³åŠ¨å†…éƒ¨çš„ æ¥å£æµ‹è¯•å·¥å…·ã€API ç½‘å…³ç­‰ï¼Œå°±ä½¿ç”¨äº† Kitex çš„æ³›åŒ– Clientï¼Œèƒ½å¤Ÿæ¥æ”¶ä¸€ä¸ª HTTP è¯·æ±‚ï¼ˆè¯·æ±‚ä½“æ˜¯ JSON æ ¼å¼ï¼‰ï¼Œè½¬æ¢æˆ Thrift Binary åï¼Œå‘é€ç»™ Kitex Serverã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/generic_call.jpeg" alt="image">&lt;/p>
&lt;p>å…¶å®ç°æ–¹æ¡ˆæ˜¯ä¾èµ–ä¸€ä¸ª &lt;code>map[string]interface{}&lt;/code> ä½œä¸ºæ³›å‹å®¹å™¨ï¼Œè¯·æ±‚æ—¶å…ˆå°† json è½¬æ¢ä¸º mapï¼Œåœ¨åŸºäº Thrift IDL å®Œæˆ map -&amp;gt; thrift çš„è½¬æ¢ï¼›å¯¹å“åº”çš„å¤„ç†åˆ™åè¿‡æ¥ã€‚&lt;/p>
&lt;ul>
&lt;li>è¿™æ ·åšçš„å¥½å¤„æ˜¯çµæ´»æ€§é«˜ï¼Œä¸éœ€è¦ä¾èµ–é¢„å…ˆç”Ÿæˆçš„é™æ€ä»£ç ï¼Œåªéœ€è¦æœ‰ IDL å°±å¯ä»¥è¯·æ±‚ç›®æ ‡æœåŠ¡ï¼›&lt;/li>
&lt;li>ä½†æ˜¯å…¶ä»£ä»·æ˜¯æ€§èƒ½è¾ƒå·®ï¼Œè¿™æ ·ä¸€ä¸ªæ³›å‹å®¹å™¨ä¾èµ– Go çš„ GC å’Œ å†…å­˜ç®¡ç†ï¼Œå¼€é”€å·¨å¤§ï¼Œä¸ä»…éœ€è¦åˆ†é…å¤§é‡å†…å­˜ï¼Œè¿˜éœ€è¦å¤šæ¬¡æ•°æ®æ‹·è´ã€‚&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤æˆ‘ä»¬å¼€å‘äº† &lt;a href="http://github.com/cloudwego/dynamicgo">DynamicGo&lt;/a>ï¼Œå¯ç”¨äºæå‡åè®®è½¬æ¢çš„æ€§èƒ½ã€‚é¡¹ç›® &lt;a href="https://github.com/cloudwego/dynamicgo/blob/main/introduction.md">introduction&lt;/a> é‡Œæœ‰éå¸¸è¯¦ç»†çš„ä»‹ç»ï¼Œè¿™é‡Œåªç»™å¤§å®¶ä»‹ç»å…¶æ ¸å¿ƒè®¾è®¡æ€è·¯ï¼šåŸºäº&lt;strong>åŸå§‹å­—èŠ‚æµ&lt;/strong>ï¼ŒåŸåœ°å®Œæˆ&lt;strong>æ•°æ®å¤„ç†å’Œè½¬æ¢&lt;/strong>ã€‚&lt;/p>
&lt;p>&lt;a href="http://github.com/cloudwego/dynamicgo">DynamicGo&lt;/a> é€šè¿‡æ± åŒ–æŠ€æœ¯ï¼Œèƒ½å®ç°åªéœ€è¦é¢„åˆ†é…ä¸€æ¬¡å†…å­˜ï¼Œå¹¶ä½¿ç”¨ SSEã€AVX ç­‰ SIMD æŒ‡ä»¤é›†è¿›è¡ŒåŠ é€Ÿï¼Œæœ€ç»ˆå®ç°äº†éå¸¸å¯è§‚çš„æ€§èƒ½æå‡ã€‚&lt;/p>
&lt;p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç›¸æ¯”åŸæ³›åŒ–è°ƒç”¨çš„å®ç°ï¼Œåœ¨ 6KB æ•°æ®çš„ç¼–è§£ç æµ‹è¯•ä¸­ï¼Œæ€§èƒ½æå‡äº† &lt;strong>4~9 å€&lt;/strong>ï¼Œç”šè‡³ä¼˜äºé¢„å…ˆç”Ÿæˆçš„é™æ€ä»£ç ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/dynamicgo.png" alt="image">&lt;/p>
&lt;p>å…¶å®é™…åŸç†å¾ˆç®€å•ï¼šæ ¹æ®è§£æ IDL ç”Ÿæˆç±»å‹æè¿°ç¬¦ Descriptorï¼Œæ‰§è¡Œå¦‚ä¸‹åè®®è½¬æ¢è¿‡ç¨‹&lt;/p>
&lt;ol>
&lt;li>æ¯æ¬¡ä» JSON å­—èŠ‚æµä¸­è¯»å–ä¸€ä¸ª Key/Value pairï¼›&lt;/li>
&lt;li>æ ¹æ® IDL Descriptor é‡Œæ‰¾åˆ° key å¯¹åº”çš„ Thrift å­—æ®µï¼›&lt;/li>
&lt;li>æŒ‰ç›¸åº”ç±»å‹çš„ Thrift ç¼–ç è§„èŒƒå®Œæˆ Value çš„ç¼–ç ï¼Œå¹¶å†™å…¥è¾“å‡ºå­—èŠ‚æµï¼›&lt;/li>
&lt;li>å¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°å¤„ç†å®Œæ•´ä¸ª JSONã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;a href="http://github.com/cloudwego/dynamicgo">DynamicGo&lt;/a> é™¤äº†å¯ä»¥ä¼˜åŒ– JSON/Thrift çš„åè®®è½¬æ¢ï¼Œè¿˜æä¾›äº† Thrift DOM æ–¹å¼ç”¨äºä¼˜åŒ–æ•°æ®ç¼–æ’åœºæ™¯çš„æ€§èƒ½ã€‚ä¾‹å¦‚æŠ–éŸ³æŸä¸šåŠ¡å›¢é˜Ÿéœ€è¦æ“¦é™¤è¯·æ±‚ä¸­çš„è¿è§„æ•°æ®ï¼Œä½†ä»…é™è¯·æ±‚ä¸­çš„æŸä¸€ä¸ªå­—æ®µï¼›ä½¿ç”¨ DynamicGo çš„ Thrift DOM API å°±éå¸¸é€‚åˆï¼Œå¯ä»¥å®ç° 10 å€çš„æ€§èƒ½æå‡ï¼Œè¯¦æƒ…å¯å‚è€ƒ DynamicGo çš„æ–‡æ¡£ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚&lt;/p>
&lt;h4 id="frugal---åŸºäº-jit-çš„é«˜æ€§èƒ½-thrift-ç¼–è§£ç å™¨">Frugal - åŸºäº JIT çš„é«˜æ€§èƒ½ Thrift ç¼–è§£ç å™¨&lt;/h4>
&lt;p>&lt;a href="http://github.com/cloudwego/frugal">Frugal&lt;/a> æ˜¯ä¸€ä¸ª åŸºäº &lt;strong>JIT&lt;/strong> ç¼–è¯‘æŠ€æœ¯çš„é«˜æ€§èƒ½ Thrift ç¼–è§£ç å™¨ã€‚&lt;/p>
&lt;p>Thrift å®˜æ–¹ä»¥åŠ Kitex é»˜è®¤çš„ç¼–è§£ç å™¨éƒ½æ˜¯åŸºäºè§£æ Thrift IDLï¼Œç”Ÿæˆç›¸åº”çš„ç¼–è§£ç  Go ä»£ç ã€‚é€šè¿‡ JIT æŠ€æœ¯ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨&lt;strong>è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆ&lt;/strong>æ€§èƒ½æ›´å¥½çš„ç¼–è§£ç ä»£ç ï¼š
ç”Ÿæˆæ›´ç´§å‡‘çš„æœºå™¨ç ã€å‡å°‘ cache missã€å‡å°‘ branch missï¼Œç”¨ &lt;strong>SIMD&lt;/strong> æŒ‡ä»¤æ¥åŠ é€Ÿï¼Œä½¿ç”¨åŸºäºå¯„å­˜å™¨çš„å‡½æ•°è°ƒç”¨ï¼ˆGo é»˜è®¤æ˜¯åŸºäºæ ˆï¼‰ã€‚&lt;/p>
&lt;p>è¿™é‡Œç»™å‡ºäº†ç¼–è§£ç æµ‹è¯•çš„æ€§èƒ½æŒ‡æ ‡ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/frugal_performance.png" alt="image">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œ&lt;a href="http://github.com/cloudwego/frugal">Frugal&lt;/a> æ€§èƒ½æ˜¾è‘—é«˜äºä¼ ç»Ÿæ–¹å¼ã€‚&lt;/p>
&lt;p>é™¤äº†æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œç”±äºå¯ä»¥ä¸ç”Ÿæˆç¼–è§£ç ä»£ç ï¼Œä¹Ÿæœ‰é¢å¤–çš„å¥½å¤„ã€‚&lt;/p>
&lt;p>ä¸€æ–¹é¢&lt;strong>ä»“åº“æ›´ç®€æ´&lt;/strong>äº†ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œç”Ÿæˆçš„ä»£ç æœ‰ 700MBï¼Œåˆ‡æ¢åˆ° frugal ååªæœ‰ 37Mï¼Œå¤§çº¦åªæœ‰åŸæ¥çš„ 5%ï¼Œåœ¨ä»“åº“ç»´æŠ¤æ–¹é¢å‹åŠ›å¤§å¹…ç¼©å°ï¼Œä¿®æ”¹ IDL ä»¥åä¹Ÿä¸ä¼šç”Ÿæˆä¸€å¤§å †å®é™…ä¸Šæ— æ³• review çš„ä»£ç ï¼›
å¦ä¸€æ–¹é¢ IDE çš„&lt;strong>åŠ è½½é€Ÿåº¦&lt;/strong>ã€é¡¹ç›®çš„&lt;strong>ç¼–è¯‘é€Ÿåº¦&lt;/strong>ä¹Ÿèƒ½æ˜¾è‘—æé«˜ã€‚&lt;/p>
&lt;p>å…¶å® Frugal å»å¹´å°±å·²ç»å‘å¸ƒäº†ï¼Œä½†æ˜¯å½“æ—¶çš„æ—©æœŸç‰ˆæœ¬è¦†ç›–ä¸å¤Ÿå……åˆ†ã€‚ä»Šå¹´æˆ‘ä»¬é‡ç‚¹ä¼˜åŒ–äº†å®ƒçš„ç¨³å®šæ€§ï¼Œä¿®å¤äº†æ‰€æœ‰å·²çŸ¥é—®é¢˜ï¼Œ
æœ€è¿‘å‘ç‰ˆçš„ v0.1.12 ç‰ˆæœ¬ï¼Œå¯ä»¥ç¨³å®šåœ°ä½¿ç”¨åœ¨ç”Ÿäº§ä¸šåŠ¡ä¸Šã€‚ä¾‹å¦‚å­—èŠ‚è·³åŠ¨ç”µå•†ä¸šåŠ¡çº¿ï¼ŒæŸæœåŠ¡çš„å³°å€¼ QPS çº¦ 25Kï¼Œå·²ç»å…¨é‡åˆ‡æ¢åˆ° Frugalï¼Œç¨³å®šè¿è¡Œäº†æ•°æœˆã€‚&lt;/p>
&lt;p>&lt;a href="http://github.com/cloudwego/frugal">Frugal&lt;/a> ç›®å‰æ”¯æŒ Go1.16 ~ Go1.21ï¼Œæš‚æ—¶åªæ”¯æŒ AMD64 æ¶æ„ï¼Œæœªæ¥ä¹Ÿå°†æ”¯æŒ ARM64 æ¶æ„ï¼›æˆ‘ä»¬å¯èƒ½ä¼šåœ¨æœªæ¥æŸä¸ªç‰ˆæœ¬å°† Frugal ä½œä¸º Kitex çš„é»˜è®¤ç¼–è§£ç å™¨ã€‚&lt;/p>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>Kitex åœ¨è¿‡å»ä¸€å¹´ä¸­ä» v0.4.3 å‡çº§åˆ° v0.7.2ï¼Œå…¶ä¸­ Feature ç›¸å…³çš„ Pull Request å…±æœ‰ 40 å¤šä¸ªï¼Œæ¶µç›–äº†&lt;strong>å‘½ä»¤è¡Œå·¥å…·&lt;/strong>ã€&lt;strong>gRPC&lt;/strong>ã€&lt;strong>Thrift ç¼–è§£ç &lt;/strong>ã€&lt;strong>é‡è¯•&lt;/strong>ã€&lt;strong>æ³›åŒ–è°ƒç”¨&lt;/strong>ã€&lt;strong>æœåŠ¡æ²»ç†é…ç½®&lt;/strong>ç­‰å¤šä¸ªæ–¹é¢ï¼Œè¿™é‡Œé‡ç‚¹ä»‹ç»å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ç‰¹æ€§ã€‚&lt;/p>
&lt;h4 id="fallback---ä¸šåŠ¡è‡ªå®šä¹‰é™çº§">Fallback - ä¸šåŠ¡è‡ªå®šä¹‰é™çº§&lt;/h4>
&lt;p>é¦–å…ˆæ˜¯ Kitex åœ¨ v0.5.0 ç‰ˆæœ¬æ–°å¢çš„ fallback åŠŸèƒ½ã€‚&lt;/p>
&lt;p>éœ€æ±‚èƒŒæ™¯æ˜¯ï¼Œä¸šåŠ¡ä»£ç åœ¨ RPC è¯·æ±‚å¤±è´¥ã€æ— æ³•è·å¾—å“åº”æ—¶ï¼Œå¾€å¾€éœ€è¦æ‰§è¡Œä¸€äº›é™çº§ç­–ç•¥ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ä¿¡æ¯æµä¸šåŠ¡ï¼ŒAPI æ¥å…¥å±‚åœ¨è¯·æ±‚æ¨èæœåŠ¡æ—¶ï¼Œå¦‚é‡åˆ°å¶å‘é”™è¯¯ï¼ˆä¾‹å¦‚è¶…æ—¶ï¼‰ï¼Œç®€å•ç²—æš´çš„åšæ³•æ˜¯å‘Šè¯‰ç”¨æˆ·å‡ºé”™äº†ï¼Œè®©ç”¨æˆ·é‡è¯•ï¼Œä½†è¿™æ ·ä½“éªŒå°±å¾ˆå·®ã€‚ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é™çº§ç­–ç•¥æ˜¯ï¼Œå°è¯•è¿”å›ä¸€äº›çƒ­é—¨æ¡ç›®ï¼Œç”¨æˆ·å‡ ä¹æ— æ„Ÿï¼Œä½“éªŒç›¸å¯¹å°±å¥½äº†å¾ˆå¤šã€‚&lt;/p>
&lt;p>æ—§ç‰ˆ Kitex çš„é—®é¢˜æ˜¯ï¼Œä¸šåŠ¡è‡ªå®šä¹‰çš„ ä¸­é—´ä»¶ åœ¨ç†”æ–­ã€è¶…æ—¶ç­‰å†…ç½®ä¸­é—´ä»¶ä¹‹åï¼Œå› æ­¤æ— æ³•åœ¨ middleware é‡Œå®ç°é™çº§ç­–ç•¥ï¼Œåªèƒ½ç›´æ¥ä¿®æ”¹ä¸šåŠ¡ä»£ç ï¼Œä¾µå…¥æ€§è¾ƒå¤§ï¼Œä¸”éœ€è¦ä¿®æ”¹æ¯ä¸€å¤„æ–¹æ³•è°ƒç”¨ï¼Œå®¹æ˜“é—æ¼ã€‚åœ¨æ–°å¢è°ƒç”¨æŸæ–¹æ³•çš„ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæ²¡æœ‰æœºåˆ¶ä¿è¯ä¸è¢«é—æ¼ã€‚&lt;/p>
&lt;p>é€šè¿‡æ–°å¢çš„ fallback åŠŸèƒ½ï¼Œ å…è®¸ä¸šåŠ¡&lt;strong>åœ¨åˆå§‹åŒ– Client æ—¶æŒ‡å®šä¸€ä¸ª fallback æ–¹æ³•&lt;/strong>æ¥å®ç°é™çº§ç­–ç•¥ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨ç¤ºä¾‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/fallback_example.png" alt="image">&lt;/p>
&lt;p>åˆå§‹åŒ– client æ—¶æŒ‡å®šçš„è¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ¯æ¬¡è¯·æ±‚ç»“æŸå‰è¢«è°ƒç”¨ï¼Œå¯ä»¥è·å¾—è¿™æ¬¡è¯·æ±‚çš„ contextã€è¯·æ±‚å‚æ•°ã€å“åº”ï¼ŒåŸºäºæ­¤å®ç°è‡ªå®šä¹‰çš„é™çº§ç­–ç•¥ï¼Œè¿™æ ·å°±æŠŠç­–ç•¥çš„å®ç°éƒ½æ”¶æ•›èµ·æ¥äº†ã€‚&lt;/p>
&lt;h4 id="thrift-fastcodec---æ”¯æŒ-unknown-fields">Thrift FastCodec - æ”¯æŒ unknown fields&lt;/h4>
&lt;p>åœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚é“¾è·¯å¾€å¾€æ¶‰åŠå¤šä¸ªèŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>ä»¥é“¾è·¯ A -&amp;gt; B -&amp;gt; C -&amp;gt; D ä¸ºä¾‹ï¼ŒA èŠ‚ç‚¹çš„æŸä¸ª struct éœ€è¦é€šè¿‡ Bã€C é€ä¼ åˆ° D èŠ‚ç‚¹ã€‚åœ¨ä»¥å¾€çš„å®ç°é‡Œï¼Œå¦‚æœåœ¨ A æ–°å¢ä¸€ä¸ªå­—æ®µï¼Œä¾‹å¦‚ &lt;code>Extra&lt;/code>ï¼Œ
æˆ‘éœ€è¦ä½¿ç”¨&lt;strong>æ–°çš„ IDL é‡æ–°ç”Ÿæˆæ‰€æœ‰èŠ‚ç‚¹çš„ä»£ç &lt;/strong>ï¼Œé‡æ–°éƒ¨ç½²ï¼Œæ‰èƒ½åœ¨ D èŠ‚ç‚¹è·å¾— Extra å­—æ®µçš„å€¼ã€‚æ•´ä¸ªæµç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ›´æ–°å‘¨æœŸä¹Ÿæ¯”è¾ƒé•¿ï¼Œå¦‚æœä¸­é—´èŠ‚ç‚¹æ˜¯å…¶ä»–å›¢é˜Ÿçš„æœåŠ¡ï¼Œè¿˜éœ€è¦è·¨å›¢é˜Ÿåè°ƒï¼Œéå¸¸åƒåŠ›ã€‚&lt;/p>
&lt;p>åœ¨ Kitex v0.5.2 é‡Œï¼Œæˆ‘ä»¬åœ¨è‡ªç ”çš„ fastCodec é‡Œå®ç°äº† Unknown Fields è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚åŒæ ·æ˜¯ A -&amp;gt; B -&amp;gt; C -&amp;gt; D è¿™ä¸ªé“¾è·¯ï¼ŒBã€CèŠ‚ç‚¹ä»£ç ä¸å˜ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œåœ¨è§£ææ—¶ï¼Œå‘ç°æœ‰ä¸ªå­—æ®µ id=2ï¼Œåœ¨ struct é‡Œæ‰¾ä¸åˆ°å¯¹åº”çš„å­—æ®µï¼Œäºæ˜¯å°±å†™å…¥è¿™ä¸ªæœªå¯¼å‡ºçš„ &lt;code>_unknownFields&lt;/code> å­—æ®µï¼ˆå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª byte slice çš„åˆ«åï¼‰ï¼›&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/old_code.png" alt="image">&lt;/p>
&lt;p>è€Œ Aã€D æœåŠ¡æ˜¯ç”¨æ–° IDL é‡æ–°ç”Ÿæˆè¿‡çš„ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼ŒåŒ…å«äº† Extra å­—æ®µï¼Œå› æ­¤è§£æåˆ° id=2 çš„å­—æ®µæ—¶ï¼Œå¯ä»¥å†™åˆ°è¿™ä¸ª Extra å­—æ®µï¼Œä¸šåŠ¡ä»£ç å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/new_code.png" alt="image">&lt;/p>
&lt;p>æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ v0.7.0 è¿˜å¯¹è¿™ä¸ªç‰¹æ€§è¿›è¡Œäº†ä¸€æ¬¡æ€§èƒ½ä¼˜åŒ–ï¼Œä½¿ç”¨ã€Œæ— åºåˆ—åŒ–ã€ï¼ˆç›´æ¥æ‹·è´å­—èŠ‚æµï¼‰çš„æ–¹å¼ï¼Œå°† unknown fields çš„ç¼–è§£ç æ€§èƒ½æå‡äº†çº¦ 6~7 å€ã€‚&lt;/p>
&lt;h4 id="åŸºäº-gls-çš„-session-ä¼ é€’æœºåˆ¶">åŸºäº GLS çš„ Session ä¼ é€’æœºåˆ¶&lt;/h4>
&lt;p>å¦ä¸€ä¸ªå€¼å¾—ç»™å„ä½ä»‹ç»çš„ç‰¹æ€§ä¹Ÿå’Œé•¿é“¾è·¯æœ‰å…³ã€‚&lt;/p>
&lt;p>åœ¨å­—èŠ‚å†…éƒ¨ï¼Œæˆ‘ä»¬ç”¨ LogID æ¥è¿½è¸ªæ•´ä¸ªè°ƒç”¨é“¾ï¼Œè¿™å°±è¦æ±‚é“¾è·¯ä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½æŒ‰è¦æ±‚é€ä¼ è¿™ä¸ªç¥¨æ®ã€‚åœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼ŒLogID ä¸æ˜¯æ”¾åœ¨è¯·æ±‚ä½“é‡Œï¼Œè€Œæ˜¯ä»¥ metadataï¼ˆå…ƒæ•°æ®ï¼‰çš„å½¢å¼é€ä¼ ã€‚&lt;/p>
&lt;p>ä»¥ A -&amp;gt; B -&amp;gt; C è¿™ä¸ªé“¾è·¯ä¸ºä¾‹ï¼ŒA è°ƒç”¨ B çš„ &lt;code>A_Call_B&lt;/code> æ–¹æ³•ï¼Œä¼ å…¥çš„ LogID ä¼šå­˜æ”¾åœ¨ handler å…¥å‚çš„ &lt;code>ctx&lt;/code> é‡Œï¼›B åœ¨è¯·æ±‚ C æ—¶ï¼Œæ­£ç¡®çš„ç”¨æ³•æ˜¯ï¼Œå°†è¿™ä¸ª &lt;code>ctx&lt;/code> ä¼ ç»™ &lt;code>clientC.B_Call_C&lt;/code> æ–¹æ³•ï¼Œè¿™æ ·æ‰èƒ½æŠŠ LogID ç»§ç»­ä¼ é€’ä¸‹å»ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/call_example.png" alt="image">&lt;/p>
&lt;p>ä½†æ˜¯å®é™…æƒ…å†µå¾€å¾€æ˜¯ï¼Œè¯·æ±‚ C æœåŠ¡çš„ä»£ç è¢«å¤šå±‚åŒ…è£…ï¼Œ&lt;strong>ctx çš„é€ä¼ å°±å®¹æ˜“è¢«é—æ¼&lt;/strong>ï¼›æˆ‘ä»¬é‡åˆ°çš„æƒ…å†µæ›´éº»çƒ¦ï¼Œå¯¹ C æœåŠ¡çš„è¯·æ±‚æ˜¯ç”±ç¬¬ä¸‰æ–¹åº“å®Œæˆçš„ï¼Œè€Œè¯¥åº“çš„æ¥å£å°±ä¸æ”¯æŒä¼ å…¥ ctxï¼Œè€Œè¿™æ ·çš„ä»£ç æ”¹é€ æˆæœ¬å¾ˆé«˜ï¼Œå¯èƒ½éœ€è¦åè°ƒå¤šä¸ªå›¢é˜Ÿæ‰èƒ½å®Œæˆã€‚&lt;/p>
&lt;p>ä¸ºäº†è§£å†³è¿™ä¸ªç—›ç‚¹ï¼Œæˆ‘ä»¬å¼•å…¥äº†åŸºäº GLSï¼ˆgoroutine local storageï¼‰çš„ session ä¼ é€’æœºåˆ¶ã€‚å…·ä½“æ–¹æ¡ˆæ˜¯ï¼š&lt;/p>
&lt;ol>
&lt;li>åœ¨ Kitex Server è¿™è¾¹ï¼Œæ”¶åˆ°è¯·æ±‚åï¼Œå…ˆå°† context å¤‡ä»½åœ¨ GLS é‡Œï¼Œç„¶åå†è°ƒç”¨ Handler ï¼Œä¹Ÿå°±æ˜¯ä¸šåŠ¡ä»£ç ï¼›&lt;/li>
&lt;li>åœ¨ä¸šåŠ¡ä»£ç é‡Œè°ƒç”¨ client å‘é€è¯·æ±‚æ—¶ï¼Œå…ˆæ£€æŸ¥å…¥å‚çš„ ctx é‡Œæ˜¯å¦åŒ…å«æœŸæœ›çš„ç¥¨æ®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä» GLS çš„å¤‡ä»½é‡Œå–å‡ºï¼Œå†å‘å‡ºè¯·æ±‚ã€‚&lt;/li>
&lt;/ol>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“ä¾‹å­ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/GLS_example.png" alt="image">&lt;/p>
&lt;p>è¯´æ˜ï¼š&lt;/p>
&lt;ol>
&lt;li>åˆå§‹åŒ– Server çš„æ—¶å€™æ‰“å¼€ &lt;code>ContextBackup&lt;/code> å¼€å…³&lt;/li>
&lt;li>åˆå§‹åŒ– Client çš„æ—¶å€™æŒ‡å®šä¸€ä¸ª &lt;code>backupHandler&lt;/code>&lt;/li>
&lt;li>æ¯æ¬¡å‘å‡ºè¯·æ±‚å‰ï¼Œä¼šè°ƒç”¨è¯¥ handlerï¼Œæ£€æŸ¥å…¥å‚æ˜¯å¦åŒ…å«äº† &lt;code>LogID&lt;/code>&lt;/li>
&lt;li>å¦‚æœä¸åŒ…å«ï¼Œä»å¤‡ä»½çš„ &lt;code>ctx&lt;/code> é‡Œè¯»å‡ºï¼Œåˆå¹¶åˆ°å½“å‰ &lt;code>ctx&lt;/code> é‡Œè¿”å›ï¼ˆè¿”å› &lt;code>useNewCtx = true&lt;/code> è¡¨ç¤º Kitex åº”ä½¿ç”¨è¿™ä¸ªæ–°çš„ &lt;code>ctx&lt;/code> å‘è¯·æ±‚ï¼‰&lt;/li>
&lt;/ol>
&lt;p>åœ¨å¼€å¯ä¸Šè¿°è®¾ç½®åï¼Œå³ä½¿ä¸šåŠ¡ä»£ç ä½¿ç”¨äº†é”™è¯¯çš„ contextï¼Œä¹Ÿèƒ½å¤Ÿä¸²è”èµ·æ•´ä¸ªé“¾è·¯ã€‚&lt;/p>
&lt;p>æœ€åå†ä»‹ç»ä¸‹ server åˆå§‹åŒ–çš„ async å‚æ•°ï¼Œå®ƒè§£å†³çš„æ˜¯åœ¨ handler é‡Œæ–°å»º goroutine é‡Œå‘é€è¯·æ±‚çš„æƒ…å†µã€‚
ç”±äºä¸æ˜¯åŒä¸€ä¸ª goroutineï¼Œæ— æ³•ç›´æ¥å…±äº« Local Storageï¼›æˆ‘ä»¬å€Ÿé‰´ pprof ç»™ goroutine æŸ“è‰²çš„æœºåˆ¶ï¼Œå°†å¤‡ä»½çš„ ctx ä¹Ÿä¼ é€’ç»™æ–°çš„ goroutineï¼Œè¿™æ ·å°±å®ç°äº†åœ¨&lt;strong>å¼‚æ­¥åœºæ™¯&lt;/strong>ä¹Ÿèƒ½&lt;strong>éšå¼ä¼ é€’ç¥¨æ®&lt;/strong>çš„èƒ½åŠ›ã€‚&lt;/p>
&lt;h3 id="æ˜“ç”¨æ€§">æ˜“ç”¨æ€§&lt;/h3>
&lt;p>é™¤äº†é«˜æ€§èƒ½å’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆæ³¨é‡æé«˜ Kitex çš„æ˜“ç”¨æ€§ã€‚&lt;/p>
&lt;h4 id="æ–‡æ¡£">æ–‡æ¡£&lt;/h4>
&lt;p>ä¼—æ‰€çš†çŸ¥ï¼Œç¨‹åºå‘˜æœ€è®¨åŒçš„ä¸¤ä»¶äº‹ï¼šä¸€æ˜¯å†™æ–‡æ¡£ï¼ŒäºŒæ˜¯åˆ«äººä¸å†™æ–‡æ¡£ã€‚å› æ­¤æˆ‘ä»¬å¾ˆæ³¨é‡é™ä½ç¼–å†™æ–‡æ¡£çš„å¯åŠ¨æˆæœ¬ï¼Œå¹¶åŠªåŠ›æ¨è¿›æ–‡æ¡£å»ºè®¾ã€‚&lt;/p>
&lt;p>åœ¨å­—èŠ‚è·³åŠ¨å†…éƒ¨ï¼ŒKitex çš„æ–‡æ¡£æ˜¯ä»¥é£ä¹¦çŸ¥è¯†åº“çš„å½¢å¼ç»„ç»‡çš„ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°é›†æˆåˆ°é£ä¹¦çš„æœç´¢ï¼Œæ–¹ä¾¿å­—èŠ‚å‘˜å·¥æŸ¥è¯¢ï¼›ç”±äºé£ä¹¦æ–‡æ¡£æ›´æ–°æ–¹ä¾¿ï¼Œå› æ­¤æ¯”å®˜ç½‘æ–‡æ¡£æ›´æ–°æ›´åŠæ—¶ï¼›æ–°åŠŸèƒ½åœ¨å¼€å‘æ—¶å¾€å¾€ä¹Ÿæ˜¯å…ˆåœ¨é£ä¹¦çŸ¥è¯†åº“ä¸­æ’°å†™æ–‡æ¡£ï¼Œæœ‰äº›æ²¡æœ‰åŠæ—¶åŒæ­¥åˆ°å®˜ç½‘ã€‚å„ç§åŸå› å¯¼è‡´å†…å¤–ä¸¤ä¸ªåˆ†æ”¯å·®åˆ«è¶Šæ¥è¶Šå¤§ã€‚&lt;/p>
&lt;p>å› æ­¤æœ€è¿‘ä¸¤ä¸ªå­£åº¦ï¼Œæˆ‘ä»¬å‘èµ·äº†æ–°ä¸€è½®æ–‡æ¡£ä¼˜åŒ–å·¥ä½œï¼šæ ¹æ®ç”¨æˆ·çš„åé¦ˆï¼Œé‡æ–°æ•´ç†æ‰€æœ‰æ–‡æ¡£ï¼Œæ·»åŠ æ›´å¤šç¤ºä¾‹ï¼›å°†æ‰€æœ‰æ–‡æ¡£ç¿»è¯‘æˆè‹±æ–‡ï¼ŒåŒæ­¥åˆ°å®˜ç½‘ã€‚è¿™é¡¹å·¥ä½œé¢„è®¡ä»Šå¹´èƒ½å®Œæˆï¼Œç›®å‰å·²ç»èƒ½åœ¨å®˜ç½‘çœ‹åˆ°ä¸€äº›æ›´æ–°åçš„æ–‡æ¡£äº†ï¼Œä¾‹å¦‚è¶…æ—¶æ§åˆ¶ã€Frugalã€panic å¤„ç†ç­‰ï¼Œæ¬¢è¿å„ä½åˆ°å®˜ç½‘å›´è§‚ã€å¸®å¿™æ‰è™«ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜åœ¨æ­å»ºä¸€å¥—æœºåˆ¶ï¼Œç”¨äºè‡ªåŠ¨åŒ–å°†å†…éƒ¨æ–‡æ¡£åŒæ­¥åˆ°å®˜ç½‘ï¼Œå¸Œæœ›èƒ½è®©å¼€æºç”¨æˆ·ä»¥åä¹Ÿèƒ½åƒå†…éƒ¨ç”¨æˆ·ä¸€æ ·å¾—åˆ°åŠæ—¶æ›´æ–°çš„æ–‡æ¡£ã€‚&lt;/p>
&lt;h4 id="å…¶ä»–ä¼˜åŒ–">å…¶ä»–ä¼˜åŒ–&lt;/h4>
&lt;p>é™¤äº†æ–‡æ¡£ï¼Œ Kitex è¿˜åšäº†ä¸€äº›å…¶ä»–æ˜“ç”¨æ€§ç›¸å…³çš„å·¥ä½œã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å‘å¸ƒäº†ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®&lt;a href="https://github.com/cloudwego/kitex-examples/tree/main/bizdemo/easy_note">ç¬”è®°æœåŠ¡&lt;/a>ï¼Œåœ¨å®ä¾‹ä¸­å±•ç¤ºä¸­é—´ä»¶ã€é™æµã€é‡è¯•ã€è¶…æ—¶æ§åˆ¶ç­‰å„ç§ç‰¹æ€§çš„ç”¨æ³•ï¼Œé€šè¿‡çœŸå®çš„é¡¹ç›®ä»£ç ç»™ Kitex ç”¨æˆ·æä¾›å‚è€ƒã€‚&lt;/p>
&lt;p>å…¶æ¬¡æˆ‘ä»¬ä¹Ÿåœ¨åŠªåŠ›æé«˜é—®é¢˜æ’æŸ¥çš„æ•ˆç‡ï¼Œä¾‹å¦‚æˆ‘ä»¬æ ¹æ®æ—¥å¸¸ oncall çš„éœ€æ±‚ï¼Œåœ¨æŠ¥é”™ä¿¡æ¯é‡Œæ·»åŠ äº†æ›´å…·ä½“çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆè¯¸å¦‚è¶…æ—¶æŠ¥é”™å¢åŠ å…·ä½“åŸå› ã€panic ä¿¡æ¯å¢åŠ  method nameã€thrift ç¼–è§£ç é”™è¯¯ä¿¡æ¯å¢åŠ å…·ä½“å­—æ®µåç§°ç­‰ï¼‰ï¼Œæ–¹ä¾¿å¿«é€Ÿå®šä½åˆ°å…·ä½“çš„é—®é¢˜ç‚¹ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼ŒKitex å‘½ä»¤è¡Œå·¥å…·ä¹Ÿåœ¨æŒç»­æ”¹è¿›ã€‚&lt;/p>
&lt;ul>
&lt;li>ä¾‹å¦‚å¾ˆå¤šä¼ä¸šç”¨æˆ·æ˜¯åœ¨ Windows ä¸Šå¼€å‘ï¼Œä¹‹å‰ Kitex æ— æ³•æ­£å¸¸åœ¨ Windows ä¸‹ç”Ÿæˆä»£ç ï¼Œå¯¼è‡´è¿™äº›ç”¨æˆ·è¿˜éœ€è¦ä¸€ä¸ª Linux ç¯å¢ƒæ¥è¾…åŠ©ï¼Œéå¸¸ä¸æ–¹ä¾¿ï¼Œæˆ‘ä»¬æ ¹æ®è¿™äº›ç”¨æˆ·çš„åé¦ˆåšäº†ä¼˜åŒ–ã€‚&lt;/li>
&lt;li>æˆ‘ä»¬è¿˜å®ç°äº†ä¸€ä¸ª IDL è£å‰ªå·¥å…·ï¼Œèƒ½å¤Ÿè¯†åˆ«å‡ºæ²¡æœ‰è¢«å¼•ç”¨çš„ç»“æ„ä½“ï¼Œåœ¨ç”Ÿæˆä»£ç æ—¶ç›´æ¥è¿‡æ»¤æ‰ï¼Œè¿™å¯¹äºä¸€äº›åŒ…æµ†çš„è€é¡¹ç›®éå¸¸æœ‰å¸®åŠ©ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ç¤¾åŒºåˆä½œé¡¹ç›®">ç¤¾åŒºåˆä½œé¡¹ç›®&lt;/h2>
&lt;p>è¿‡å»çš„ä¸€å¹´é‡Œï¼Œåœ¨ CloudWeGo ç¤¾åŒºçš„æ”¯æŒä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå–å¾—äº†å¾ˆå¤šæˆæœï¼Œç‰¹åˆ«æ˜¯ Dubbo äº’é€šå’Œé…ç½®ä¸­å¿ƒé›†æˆè¿™ä¸¤ä¸ªé¡¹ç›®ã€‚&lt;/p>
&lt;h3 id="dubbo-äº’é€š">Dubbo äº’é€š&lt;/h3>
&lt;p>è™½ç„¶ Kitex æœ€åˆæ˜¯ä¸€ä¸ª Thrift RPC æ¡†æ¶ï¼Œä½†æ˜¯å…¶æ¶æ„è®¾è®¡æœ‰è¾ƒå¥½çš„æ‰©å±•æ€§ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œå¢åŠ æ–°çš„åè®®ï¼Œæ ¸å¿ƒå·¥ä½œæ˜¯æŒ‰ Codec æ¥å£å®ç°ä¸€ä¸ªå¯¹åº”çš„åè®®ç¼–è§£ç å™¨ï¼ˆCodec æˆ–è€… PayloadCodecï¼‰ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/kitex_transport.png" alt="image">&lt;/p>
&lt;p>Dubbo äº’é€šé¡¹ç›®æºäºæŸä¼ä¸šç”¨æˆ·æå‡ºçš„éœ€æ±‚ï¼Œä»–ä»¬æœ‰ä¸€äº›ä¾›åº”å•†æ˜¯ç”¨ Dubbo Java å®ç°çš„å¤–å›´æœåŠ¡ï¼Œä»–ä»¬å¸Œæœ›ä¹Ÿèƒ½å¤Ÿä½¿ç”¨ Kitex æ¥è¯·æ±‚è¿™äº›æœåŠ¡ï¼Œé™ä½é¡¹ç›®çš„ç®¡ç†æˆæœ¬ã€‚&lt;/p>
&lt;p>è¿™ä¸ªé¡¹ç›®å¾—åˆ°äº†ç¤¾åŒºåŒå­¦çš„çƒ­æƒ…æ”¯æŒï¼Œæœ‰å¾ˆå¤šåŒå­¦å‚ä¸åˆ°è¿™ä¸ªé¡¹ç›®ä¸­ã€‚ç‰¹åˆ«åœ°ï¼Œæ‰¿æ‹…æ ¸å¿ƒä»»åŠ¡ä¹‹ä¸€çš„ @&lt;a href="https://github.com/DMwangnima">DMwangnima&lt;/a> åŒå­¦ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Dubbo ç¤¾åŒºçš„å¼€å‘è€…ï¼Œç”±äºä»–å¯¹ Dubbo æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå¼€å‘è¿‡ç¨‹ä¹Ÿå°‘èµ°äº†å¾ˆå¤šå¼¯è·¯ã€‚&lt;/p>
&lt;p>åœ¨å…·ä½“å®ç°æ–¹æ¡ˆä¸Šï¼Œæˆ‘ä»¬é‡‡ç”¨äº†å’Œ Dubbo å®˜æ–¹ä¸åŒçš„æ€è·¯ã€‚æ ¹æ®å¯¹ hessian2 åè®®çš„åˆ†æï¼Œå…¶åŸºç¡€ç±»å‹ç³»ç»ŸåŸºæœ¬ä¸Šæ˜¯å’Œ Thrift é‡åˆçš„ï¼Œå› æ­¤æˆ‘ä»¬åŸºäº Thrift IDL æ¥ç”Ÿæˆ Kitex Dubbo-Hessian2 é¡¹ç›®è„šæ‰‹æ¶ã€‚&lt;/p>
&lt;p>ä¸€æœŸä¸ºäº†å¿«é€Ÿå®ç°åŠŸèƒ½ï¼Œæˆ‘ä»¬ç›´æ¥å€Ÿç”¨äº† Dubbo-go æ¡†æ¶çš„ hessian2 åº“æ¥åšåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå¹¶å‚è€ƒ Dubbo å®˜æ–¹æ–‡æ¡£å’Œ Dubbo-Go çš„æºç ï¼Œå®ç°äº† Kitex è‡ªå·±çš„ DubboCodecï¼›&lt;/p>
&lt;p>åœ¨ 10 æœˆæˆ‘ä»¬å·²ç»å®Œæˆäº†ç¬¬ä¸€ç‰ˆä»£ç ï¼Œé¡¹ç›®åœ°å€æ˜¯ &lt;a href="https://github.com/kitex-contrib/codec-dubbo">code-dubbo&lt;/a> ï¼Œæ„Ÿå…´è¶£çš„ç”¨æˆ·å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ–‡æ¡£è¯•ç”¨ï¼Œåœ¨å…·ä½“çš„ä½¿ç”¨ä¸Šï¼Œå’Œ Kitex Thrift ç±»ä¼¼ï¼Œå†™å¥½ Thrift IDLï¼Œç”¨ kitex å‘½ä»¤è¡Œç”Ÿæˆè„šæ‰‹æ¶ï¼ˆæ³¨æ„éœ€è¦æŒ‡å®š Protocol ä¸º hessian2ï¼‰ï¼Œç„¶ååœ¨ä»£ç é‡Œåˆå§‹åŒ– clientã€server çš„åœ°æ–¹æŒ‡å®š DubboCodecï¼Œå°±å¯ä»¥å¼€å§‹ç¼–å†™ä¸šåŠ¡ä»£ç äº†ã€‚&lt;/p>
&lt;p>è¿™ä¸ä»…é™ä½äº†ç”¨æˆ·ä½¿ç”¨é—¨æ§›ï¼Œè€Œä¸”ç”¨ IDL æ¥ç®¡ç†æ¥å£ç›¸å…³ä¿¡æ¯ï¼Œå¯ç»´æŠ¤æ€§ä¹Ÿæ›´å¥½ã€‚&lt;/p>
&lt;p>ç›®å‰æˆ‘ä»¬å·²ç»èƒ½å¤Ÿåšåˆ° &lt;strong>Kitex å’Œ Dubbo-Java&lt;/strong>ã€&lt;strong>Kitex å’Œ Dubbo-Go&lt;/strong> äº’é€šï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/kitex_dubbo.jpeg" alt="image">&lt;/p>
&lt;p>æœªæ¥è®¡åˆ’ï¼š&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆæ˜¯æé«˜ä¸ dubbo-java çš„å…¼å®¹æ€§ï¼Œä»¥åŠå…è®¸ç”¨æˆ·åœ¨ IDL æ³¨è§£é‡ŒæŒ‡å®šå¯¹åº”çš„ Java ç±»å‹ã€‚&lt;/li>
&lt;li>å…¶æ¬¡æ˜¯ä¸æ³¨å†Œä¸­å¿ƒçš„å¯¹æ¥ã€‚è™½ç„¶ Kitex å·²ç»æœ‰å¯¹åº”çš„æ³¨å†Œä¸­å¿ƒæ¨¡å—ï¼Œä½†å…·ä½“çš„æ•°æ®æ ¼å¼å’Œ Dubbo ä¸ä¸€è‡´ï¼Œè¿™å—è¿˜éœ€è¦ä¸€äº›æ”¹é€ ï¼Œç›¸å…³å·¥ä½œå³å°†å®Œæˆã€‚&lt;/li>
&lt;li>æœ€åæ˜¯æ€§èƒ½é—®é¢˜ï¼Œç›®å‰å’Œ Kitex Thrift ç›¸æ¯”æœ‰è¾ƒå¤§å·®è·ï¼Œå› ä¸º dubbo-go-hessian2 è¿™ä¸ªåº“å®Œå…¨åŸºäºåå°„å®ç°ï¼Œæ€§èƒ½è¿˜æœ‰å¾ˆå¤§ä¼˜åŒ–ç©ºé—´ã€‚è®¡åˆ’å®ç° Hessian2 çš„ FastCodecï¼Œä»è€Œè§£å†³ç¼–è§£ç çš„æ€§èƒ½ç“¶é¢ˆã€‚&lt;/li>
&lt;/ul>
&lt;p>åœ¨è¿™ä¸ªé¡¹ç›®çš„æ¨è¿›è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ·±åˆ‡ä½“éªŒåˆ°è·¨ç¤¾åŒºåˆä½œçš„ç§¯æå½±å“ï¼ŒKitex å¸æ”¶äº† Dubbo ç¤¾åŒºçš„æˆæœï¼ŒåŒæ—¶ä¹Ÿå‘ç°äº† Dubbo-go é¡¹ç›®å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Œä¸Šé¢è¯´åˆ°çš„å…¼å®¹æ€§å’Œæ€§èƒ½çš„è§£å†³æ–¹æ¡ˆï¼Œé¢„è®¡ä¹Ÿèƒ½åå“º dubbo ç¤¾åŒºã€‚&lt;/p>
&lt;p>åœ¨æ­¤ä¹Ÿç‰¹åˆ«å‘è¿™ä¸ªé¡¹ç›®çš„ç¤¾åŒºè´¡çŒ®è€… @&lt;a href="https://github.com/DMwangnima">DMwangnima&lt;/a>ã€@&lt;a href="https://github.com/Lvnszn">Lvnszn&lt;/a>ã€@&lt;a href="https://github.com/ahaostudy">ahaostudy&lt;/a>ã€@&lt;a href="https://github.com/jasondeng1997">jasondeng1997&lt;/a>ã€@&lt;a href="https://github.com/VaderKai">VaderKai&lt;/a> ç­‰åŒå­¦è‡´è°¢ï¼Œæ„Ÿè°¢ä»–ä»¬æŠ½å‡ºå¤§é‡ä¸šä½™æ—¶é—´å®Œæˆè¿™ä¸ªé¡¹ç›®ã€‚&lt;/p>
&lt;h3 id="é…ç½®ä¸­å¿ƒé›†æˆ">é…ç½®ä¸­å¿ƒé›†æˆ&lt;/h3>
&lt;p>å¦ä¸€ä¸ªç¤¾åŒºåˆä½œçš„é‡ç‚¹é¡¹ç›®æ˜¯ã€Œé…ç½®ä¸­å¿ƒé›†æˆã€ã€‚&lt;/p>
&lt;p>Kitex æä¾›äº†å¯åŠ¨æ€é…ç½®çš„æœåŠ¡æ²»ç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯çš„è¶…æ—¶ã€é‡è¯•ã€ç†”æ–­ï¼Œä»¥åŠæœåŠ¡ç«¯çš„é™æµã€‚&lt;/p>
&lt;p>è¿™äº›æœåŠ¡æ²»ç†èƒ½åŠ›åœ¨å­—èŠ‚å†…éƒ¨éƒ½æ˜¯è¢«é‡åº¦ä½¿ç”¨çš„ï¼Œå¾®æœåŠ¡çš„å¼€å‘è€…å¯ä»¥åœ¨å­—èŠ‚è‡ªå»ºçš„æœåŠ¡æ²»ç†é…ç½®å¹³å°ä¸Šç¼–è¾‘è¿™äº›é…ç½®ï¼Œç²’åº¦ç»†åŒ–åˆ°è¿™ä¸ªäº”å…ƒç»„ï¼Œå¹¶ä¸”æ˜¯å‡†å®æ—¶ç”Ÿæ•ˆï¼Œè¿™äº›èƒ½åŠ›å¯¹æé«˜å¾®æœåŠ¡çš„ SLA éå¸¸æœ‰å¸®åŠ©ã€‚&lt;/p>
&lt;p>ç„¶è€Œæˆ‘ä»¬å’Œä¼ä¸šç”¨æˆ·æ²Ÿé€šï¼Œå‘ç°è¿™äº›èƒ½åŠ›é€šå¸¸åªæœ‰éå¸¸ç®€å•çš„ä½¿ç”¨ï¼Œç²’åº¦å¾ˆç²—ï¼Œè€Œä¸”æ—¶æ•ˆæ€§è¾ƒå·®ï¼Œå¯èƒ½åªæ˜¯ç¡¬ç¼–ç æŒ‡å®šé…ç½®ï¼Œæˆ–è€…é€šè¿‡ç®€å•çš„æ–‡ä»¶é…ç½®ï¼Œéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/config_cases.png" alt="image">&lt;/p>
&lt;p>ä¸ºäº†è®©ç”¨æˆ·èƒ½å¤Ÿæ›´å¥½åœ°ç”¨ä¸Š Kitex çš„æœåŠ¡æ²»ç†èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯åŠ¨äº†é…ç½®ä¸­å¿ƒé›†æˆé¡¹ç›®ï¼Œè®© Kitex èƒ½å¤Ÿä»ç”¨æˆ·çš„é…ç½®ä¸­å¿ƒ&lt;strong>åŠ¨æ€è·å–æœåŠ¡æ²»ç†é…ç½®&lt;/strong>ï¼Œå¹¶å‡†å®æ—¶ç”Ÿæ•ˆã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å·²ç»å‘å¸ƒäº† &lt;a href="https://github.com/kitex-contrib/config-nacos">config-nacos&lt;/a> çš„ v0.1.1 ç‰ˆæœ¬ï¼ˆæ³¨ï¼šæˆªè‡³å‘æ–‡æ—¶å·²æ›´æ–°è‡³ v0.3.0ï¼Œæ„Ÿè°¢ @&lt;a href="https://github.com/whalecold">whalecold&lt;/a> åŒå­¦çš„æŒç»­æŠ•å…¥ï¼‰ï¼Œé€šè¿‡åœ¨ç°æœ‰ Kitex é¡¹ç›®ä¸Šç»™ client å¢åŠ  NacosClientSuiteï¼Œå¯ä»¥å¾ˆç®€å•åœ°è®© Kitex ä» Nacos åŠ è½½å¯¹åº”çš„æœåŠ¡æ²»ç†é…ç½®ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/nacos_code.png" alt="image">&lt;/p>
&lt;p>ç”±äºæˆ‘ä»¬ä½¿ç”¨ nacos client æœ¬èº«æä¾›çš„ watch èƒ½åŠ›ï¼Œå¯ä»¥å‡†å®æ—¶åœ°æ”¶åˆ°é…ç½®çš„å˜æ›´é€šçŸ¥ï¼Œå› æ­¤æ—¶æ•ˆæ€§ä¹Ÿå¾ˆå¼ºï¼Œä¸éœ€è¦é‡å¯æœåŠ¡ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜é¢„ç•™äº†ä¿®æ”¹é…ç½®ç²’åº¦çš„èƒ½åŠ›ï¼Œä¾‹å¦‚é»˜è®¤çš„é…ç½®ç²’åº¦æ˜¯ client + serverï¼Œåœ¨ Nacos çš„ data id é‡ŒæŒ‰è¿™ä¸ªæ ¼å¼å¡«å†™å³å¯ï¼›ç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šè¿™ä¸ª data id çš„æ¨¡æ¿ï¼Œä¾‹å¦‚åŠ ä¸Šæœºæˆ¿ã€é›†ç¾¤ç­‰ï¼Œä»è€Œæ›´ç²¾ç»†åŒ–åœ°è°ƒæ•´è¿™äº›é…ç½®ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/nacos_config.png" alt="image">&lt;/p>
&lt;p>æˆ‘ä»¬è®¡åˆ’å®Œæˆå¯¹æ¥å¸¸è§çš„é…ç½®ä¸­å¿ƒï¼Œåœ¨è¿™ä¸ª &lt;a href="https://github.com/cloudwego/kitex/issues/973">issue&lt;/a> é‡Œæœ‰æ›´è¯¦ç»†çš„è¯´æ˜ï¼Œæ¬¢è¿å¤§å®¶å›´è§‚ã€‚
ç›®å‰çš„è¿›å±•æ˜¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/kitex-contrib/config-file">file&lt;/a>ã€&lt;a href="https://github.com/kitex-contrib/config-apollo">apollo&lt;/a>ã€&lt;a href="https://github.com/kitex-contrib/config-etcd">etcd&lt;/a>ã€&lt;a href="https://github.com/kitex-contrib/config-zookeeper">zookeeper&lt;/a> å·²ç»å®Œæˆï¼›&lt;/li>
&lt;li>&lt;a href="https://github.com/kitex-contrib/config-consul">consul&lt;/a> æ­£åœ¨å¼€å‘ä¸­ï¼›&lt;/li>
&lt;/ul>
&lt;p>æ„Ÿå…´è¶£çš„åŒå­¦çš„åŒå­¦ä¹Ÿå¯ä»¥å‚ä¸è¿›æ¥ï¼Œä¸€èµ· reviewã€æµ‹è¯•éªŒè¯è¿™äº›æ‰©å±•æ¨¡å—ã€‚&lt;/p>
&lt;h2 id="æœªæ¥å±•æœ›">æœªæ¥å±•æœ›&lt;/h2>
&lt;p>æœ€åç»™å¤§å®¶å‰§é€ä¸€ä¸‹æˆ‘ä»¬ç›®å‰æ­£åœ¨å°è¯•çš„ä¸€äº›æ–¹å‘ã€‚&lt;/p>
&lt;h3 id="åˆå¹¶éƒ¨ç½²">åˆå¹¶éƒ¨ç½²&lt;/h3>
&lt;h4 id="äº²å’Œæ€§éƒ¨ç½²">äº²å’Œæ€§éƒ¨ç½²&lt;/h4>
&lt;p>æˆ‘ä»¬ä¹‹å‰çš„ä¼˜åŒ–å¤§å¤šæ˜¯é’ˆå¯¹æœåŠ¡å†…ï¼Œè€Œéšç€å¯ä¼˜åŒ–ç‚¹é€æ¸å‡å°‘ï¼Œæˆ‘ä»¬å¼€å§‹è€ƒè™‘å…¶ä»–ç›®æ ‡ï¼Œæ¯”å¦‚ä¼˜åŒ– RPC è¯·æ±‚åœ¨ç½‘ç»œé€šä¿¡ä¸Šçš„å¼€é”€ã€‚
å…·ä½“çš„æ–¹æ¡ˆå¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆæ˜¯äº²å’Œæ€§è°ƒåº¦ï¼Œé€šè¿‡ä¿®æ”¹å®¹å™¨åŒ–è°ƒåº¦æœºåˆ¶ï¼Œæˆ‘ä»¬å°† Client å’Œ Server å°½é‡è°ƒåº¦åˆ°ç›¸åŒçš„ç‰©ç†æœºä¸Šï¼›&lt;/li>
&lt;li>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç”¨åŒæœºé€šä¿¡æ¥é™ä½å¼€é”€ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç›®å‰æˆ‘ä»¬å·²ç»å®ç°çš„åŒæœºé€šä¿¡åŒ…æ‹¬å¦‚ä¸‹ä¸‰ç§ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Unix Domain Socket&lt;/strong>ï¼Œæ¯”æ ‡å‡†çš„ TCP Socket æ€§èƒ½è¦å¥½ä¸€äº›ï¼Œä½†ä¸å¤ªå¤šï¼›&lt;/li>
&lt;li>&lt;a href="https://github.com/cloudwego/shmipc-go">ShmIPC&lt;/a>ï¼ŒåŸºäºå…±äº«å†…å­˜çš„è¿›ç¨‹é—´é€šä¿¡ï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥çœç•¥åºåˆ—åŒ–æ•°æ®çš„ä¼ é€’ï¼Œåªéœ€è¦æŠŠå†…å­˜åœ°å€å‘Šè¯‰æ¥æ”¶æ–¹å³å¯ï¼›&lt;/li>
&lt;li>æœ€åæ˜¯ &lt;strong>RPAL&lt;/strong> è¿™ä¸ªã€Œé»‘ç§‘æŠ€ã€ï¼Œè¿™æ˜¯ Run Process As Library çš„ç¼©å†™ï¼Œæˆ‘ä»¬å’Œå­—èŠ‚çš„å†…æ ¸ç»„åˆä½œï¼Œé€šè¿‡å®šåˆ¶åŒ–çš„å†…æ ¸ï¼Œå°†ä¸¤ä¸ªè¿›ç¨‹æ”¾åœ¨åŒä¸€ä¸ªåœ°å€ç©ºé—´ï¼Œåœ¨æ»¡è¶³ä¸€å®šæ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸éœ€è¦åšåºåˆ—åŒ–ï¼›&lt;/li>
&lt;/ul>
&lt;p>ç›®å‰æˆ‘ä»¬å·²ç»åœ¨ 100 å¤šä¸ªæœåŠ¡ä¸Šå¼€å¯äº†è¿™ä¸ªèƒ½åŠ›ï¼Œä¹Ÿå–å¾—äº†ä¸€äº›æ€§èƒ½æ”¶ç›Šï¼Œå¯¹äºæ•ˆæœæ¯”è¾ƒå¥½çš„æœåŠ¡ï¼Œèƒ½å¤ŸèŠ‚çœçº¦ 5&lt;del>10% çš„ CPUï¼Œè€—æ—¶ä¹Ÿèƒ½å‡å°‘ 10&lt;/del>70%ï¼›å½“ç„¶å®é™…è¡¨ç°å–å†³äºæœåŠ¡çš„ä¸€äº›ç‰¹æ€§ï¼Œä¾‹å¦‚æ•°æ®åŒ…çš„å¤§å°ç­‰ã€‚&lt;/p>
&lt;h4 id="ç¼–è¯‘æœŸåˆå¹¶">ç¼–è¯‘æœŸåˆå¹¶&lt;/h4>
&lt;p>å¦ä¸€ä¸ªæ€è·¯æ˜¯ç¼–è¯‘æœŸåˆå¹¶ã€‚&lt;/p>
&lt;p>è¯¥æ–¹æ¡ˆçš„å‡ºå‘ç‚¹æ˜¯ï¼Œæˆ‘ä»¬å‘ç°å¾®æœåŠ¡è™½ç„¶æå‡äº†å›¢é˜Ÿåä½œçš„æ•ˆç‡ï¼Œä½†æ˜¯ä¹Ÿå¢åŠ äº†ç³»ç»Ÿæ•´ä½“å¤æ‚æ€§ï¼Œå°¤å…¶æ˜¯åœ¨æœåŠ¡éƒ¨ç½²ã€èµ„æºå ç”¨ã€é€šä¿¡å¼€é”€ç­‰æ–¹é¢ã€‚&lt;/p>
&lt;p>å› æ­¤æˆ‘ä»¬å¸Œæœ›å®ç°ä¸€ç§æ–¹æ¡ˆï¼šè®©ä¸šåŠ¡æ—¢èƒ½å¤Ÿä»¥å¾®æœåŠ¡çš„å½¢å¼å¼€å‘ï¼Œåˆèƒ½å¤ŸæŒ‰å•ä½“æœåŠ¡çš„å½¢å¼éƒ¨ç½²ï¼Œä¿—ç§°æ—¢è¦åˆè¦ã€‚&lt;/p>
&lt;p>ç„¶åæˆ‘ä»¬æŠŠè¿™ä¸ªæ–¹æ¡ˆåšå‡ºæ¥äº† â€”â€” æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªå·¥å…·ï¼Œèƒ½å¤ŸæŠŠä¸¤ä¸ªå¾®æœåŠ¡çš„ git repo åˆå¹¶åœ¨ä¸€èµ·ï¼Œå¹¶é€šè¿‡ namespace éš”ç¦»å¯èƒ½æœ‰å†²çªçš„èµ„æºï¼Œç„¶åç¼–è¯‘æˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œç”¨äºéƒ¨ç½²ã€‚&lt;/p>
&lt;p>ç›®å‰åœ¨å­—èŠ‚è·³åŠ¨å†…éƒ¨ï¼Œå·²ç»æœ‰æ•°åç»„æœåŠ¡æ¥å…¥ï¼Œæ•ˆæœæœ€å¥½çš„æœåŠ¡ï¼ŒCPU èŠ‚çœçº¦80%ï¼Œå»¶è¿Ÿåˆ™èƒ½é™ä½æœ€å¤š 67%;å½“ç„¶ï¼Œå®é™…è¡¨ç°ä¹Ÿå–å†³äºè¯¥æœåŠ¡çš„ç‰¹æ€§ï¼Œæ¯”å¦‚è¯·æ±‚åŒ…çš„å¤§å°ã€‚&lt;/p>
&lt;p>ä»¥ä¸Šæ˜¯æˆ‘ä»¬åœ¨äº²å’Œæ€§æ–¹é¢çš„å°è¯•ã€‚&lt;/p>
&lt;h3 id="åºåˆ—åŒ–">åºåˆ—åŒ–&lt;/h3>
&lt;p>åœ¨åºåˆ—åŒ–æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿè¿˜åœ¨åšä¸€äº›åŠªåŠ›å’Œå°è¯•ã€‚&lt;/p>
&lt;h4 id="frugal---ssa-backend">Frugal - SSA Backend&lt;/h4>
&lt;p>é¦–å…ˆæ˜¯ Frugalï¼Œå‰é¢ä»‹ç»è¿‡å®ƒçš„æ€§èƒ½å·²ç»æ˜¾è‘—ä¼˜äºä¼ ç»Ÿçš„ Thrift ç¼–è§£ç ä»£ç ï¼Œä½†å®ƒè¿˜æœ‰æå‡ç©ºé—´ã€‚&lt;/p>
&lt;p>ç›®å‰ Frugal çš„å®ç°æ˜¯ç”¨ Go ç›´æ¥ç”Ÿæˆå¯¹åº”çš„æ±‡ç¼–ä»£ç ã€‚æˆ‘ä»¬åœ¨å…·ä½“å®ç°ä¸­ä¹Ÿåº”ç”¨äº†ä¸€äº›ä¼˜åŒ–æ‰‹æ®µï¼Œä¾‹å¦‚ç”Ÿæˆæ›´ç´§å‡‘çš„ä»£ç ï¼Œå‡å°‘åˆ†æ”¯ç­‰ï¼›ä½†å…‰é æˆ‘ä»¬è‡ªå·±è¿™æ ·å†™ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨ç°æœ‰çš„ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/frugal_current.png" alt="image">&lt;/p>
&lt;p>æˆ‘ä»¬è®¡åˆ’å°† Frugal é‡æ„åï¼Œèƒ½å¤ŸåŸºäºˆ go struct å…ˆç”Ÿæˆç¬¦åˆ SSA çš„ LLVM IRï¼ˆå³ Intermediate Representationï¼Œä¸­é—´è¡¨ç¤ºï¼‰ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ LLVM çš„ç¼–è¯‘ä¼˜åŒ–èƒ½åŠ›ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/2nd_Kitex_retrospect/frugal_future.png" alt="image">&lt;/p>
&lt;p>é¢„è®¡è¿™æ ·æ”¹é€ åï¼Œæ€§èƒ½å¯ä»¥æå‡è‡³å°‘ 30%ã€‚&lt;/p>
&lt;h4 id="æŒ‰éœ€åºåˆ—åŒ–">æŒ‰éœ€åºåˆ—åŒ–&lt;/h4>
&lt;p>åœ¨å¦å¤–ä¸€ä¸ªæ¢ç´¢æ–¹å‘æ˜¯æŒ‰éœ€åºåˆ—åŒ–ï¼Œå…·ä½“åˆå¯ä»¥åˆ†æˆä¸‰å—ã€‚&lt;/p>
&lt;p>é¦–å…ˆæ˜¯ç¼–è¯‘å‰ã€‚æˆ‘ä»¬ç›®å‰å·²ç»å‘å¸ƒäº†ä¸€ä¸ª IDL è£å‰ªå·¥å…·ï¼Œèƒ½å¤Ÿè¯†åˆ«å‡ºæ²¡æœ‰è¢«å¼•ç”¨çš„ç±»å‹ï¼›ä½†æ˜¯è¢«å¼•ç”¨çš„ç±»å‹ä¹Ÿå¯èƒ½æ˜¯ä¸éœ€è¦çš„ï¼Œä¾‹å¦‚Aã€Bä¸¤ä¸ªæœåŠ¡ä¾èµ–åŒä¸€ä¸ªç±»å‹ï¼Œä½†å…¶ä¸­æœ‰ä¸€ä¸ªå­—æ®µå¯èƒ½Aéœ€è¦ï¼ŒBä¸éœ€è¦ã€‚æˆ‘ä»¬è€ƒè™‘åœ¨è¿™ä¸ªå·¥å…·ä¸Šå¢åŠ ç”¨æˆ·æ ‡æ³¨èƒ½åŠ›ï¼Œå…è®¸ç”¨æˆ·æŒ‡å®šä¸éœ€è¦çš„å­—æ®µï¼Œä»è€Œè¿›ä¸€æ­¥é™ä½åºåˆ—åŒ–å¼€é”€ã€‚&lt;/p>
&lt;p>å…¶æ¬¡æ˜¯ç¼–è¯‘ä¸­ã€‚å…¶æ€è·¯æ˜¯æ ¹æ®ç¼–è¯‘å™¨çš„ç¼–è¯‘æŠ¥å‘Šæ¥è·å–å®é™…è¿èƒŒä¸šåŠ¡ä»£ç å¼•ç”¨çš„å­—æ®µè¿›è¡Œè£å‰ªã€‚å…·ä½“çš„æ–¹æ¡ˆå’Œæ­£ç¡®æ€§è¿˜éœ€è¦ä¸€äº›éªŒè¯ã€‚&lt;/p>
&lt;p>æœ€åæ˜¯ç¼–è¯‘åï¼Œåœ¨è¿è¡Œæ—¶ï¼Œä¹Ÿå…è®¸ä¸šåŠ¡é€šè¿‡æŒ‡å®šä¸éœ€è¦çš„å­—æ®µï¼Œä»è€ŒèŠ‚çœç¼–è§£ç çš„å¼€é”€ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>æœ€åæˆ‘ä»¬æ•´ä½“å›é¡¾ä¸€ä¸‹ï¼š&lt;/p>
&lt;p>åœ¨èƒ½åŠ›å‡çº§æ–¹é¢ï¼Œ&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://github.com/cloudwego/kitex">Kitex&lt;/a> é€šè¿‡ &lt;a href="http://github.com/cloudwego/dynamicgo">DynamicGo&lt;/a> ä¼˜åŒ–äº†æ³›åŒ–è°ƒç”¨çš„æ€§èƒ½ï¼Œé«˜æ€§èƒ½ &lt;a href="http://github.com/cloudwego/frugal">Frugal&lt;/a> ç¼–è§£ç å™¨ä¹Ÿå·²ç»ç¨³å®šï¼Œå¯ç”¨äºç”Ÿäº§ç¯å¢ƒäº†ï¼›&lt;/li>
&lt;li>è¿‡å»ä¸€å¹´æ–°å¢äº† fallback æ–¹ä¾¿ä¸šåŠ¡å®ç°è‡ªå®šä¹‰é™çº§ç­–ç•¥ï¼Œå¹¶é€šè¿‡ unknown fields å’Œ session ä¼ é€’æœºåˆ¶æ¥è§£å†³é•¿é“¾è·¯çš„æ”¹é€ é—®é¢˜ï¼›&lt;/li>
&lt;li>æˆ‘ä»¬è¿˜é€šè¿‡æ–‡æ¡£ä¼˜åŒ–ã€demo é¡¹ç›®ã€é—®é¢˜æ’æŸ¥æ•ˆç‡æ”¹é€  å’Œ å¢å¼ºå‘½ä»¤è¡Œå·¥å…·ç­‰æ–¹å¼æå‡äº† Kitex çš„æ˜“ç”¨æ€§ï¼›&lt;/li>
&lt;/ul>
&lt;p>åœ¨ç¤¾åŒºåˆä½œæ–¹é¢ï¼Œ&lt;/p>
&lt;ul>
&lt;li>æˆ‘ä»¬é€šè¿‡ Kitex - Dubbo &lt;a href="https://github.com/kitex-contrib/codec-dubbo">äº’é€šé¡¹ç›®&lt;/a>æ”¯æŒäº† Dubbo çš„ hessian2 åè®®ï¼Œå¯ä»¥å’Œ Dubbo Javaã€Dubbo-Go æ¡†æ¶äº’é€šï¼Œå¹¶ä¸”è¿˜æœ‰åç»­çš„ä¼˜åŒ–ï¼Œä¹Ÿèƒ½åå“º Dubbo ç¤¾åŒºï¼›&lt;/li>
&lt;li>åœ¨é…ç½®ä¸­å¿ƒé›†æˆé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å‘å¸ƒäº† &lt;a href="https://github.com/kitex-contrib/config-nacos">Nacos&lt;/a> æ‰©å±•ï¼Œæ–¹ä¾¿ç”¨æˆ·é›†æˆï¼Œç›®å‰è¿˜åœ¨ç»§ç»­æ¨è¿›å…¶ä»–é…ç½®ä¸­å¿ƒçš„å¯¹æ¥ï¼›&lt;/li>
&lt;/ul>
&lt;p>æœªæ¥è¿˜æœ‰ä¸€äº›æ¢ç´¢æ–¹å‘ï¼Œ&lt;/p>
&lt;ul>
&lt;li>åœ¨åˆå¹¶éƒ¨ç½²æ–¹é¢ï¼Œæˆ‘ä»¬é€šè¿‡äº²å’Œæ€§éƒ¨ç½²ã€ç¼–è¯‘å…¶åˆå¹¶è¿™ä¸¤ç§æ–¹å¼ï¼Œæ—¢èƒ½ä¿ç•™å¾®æœåŠ¡çš„å¥½å¤„ï¼Œåˆèƒ½äº«å—ä¸€éƒ¨åˆ†å•ä½“ä¸æœåŠ¡çš„ä¼˜åŠ¿ï¼›&lt;/li>
&lt;li>åœ¨åºåˆ—åŒ–æ–¹é¢ï¼Œæˆ‘ä»¬è¿˜ç»§ç»­è¿›ä¸€æ­¥ä¼˜åŒ– &lt;a href="http://github.com/cloudwego/frugal">Frugal&lt;/a>ï¼Œå¹¶ä¸”é€šè¿‡ç¼–è¯‘å‰ä¸­åå„ç¯èŠ‚æ¥å®ç°æŒ‰éœ€åºåˆ—åŒ–çš„èƒ½åŠ›ï¼›&lt;/li>
&lt;/ul>
&lt;p>ä»¥ä¸Šæ˜¯åœ¨ CloudWeGo ä¸¤å‘¨å¹´ä¹‹é™…ï¼Œå…³äº &lt;a href="http://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å›é¡¾å’Œå±•æœ›ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼Œè°¢è°¢ã€‚&lt;/p></description></item><item><title>Blog: Kitex Release v0.8.0</title><link>https://www.cloudwego.io/zh/blog/2023/11/30/kitex-release-v0.8.0/</link><pubDate>Thu, 30 Nov 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/11/30/kitex-release-v0.8.0/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">&lt;strong>é‡è¦å˜æ›´ä»‹ç»&lt;/strong>&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>&lt;strong>1. gRPC åè®®æ”¯æŒå¤š Service&lt;/strong>&lt;/p>
&lt;p>Kitex gRPC æ”¯æŒå¤š Service çš„èƒ½åŠ›ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/multi_service/">Multiple Services&lt;/a>.&lt;/p>
&lt;p>&lt;strong>2. Acquire Kitex RPCInfo&lt;/strong>&lt;/p>
&lt;p>æä¾› kitexutil æ–¹æ³•ä»¥æ–¹ä¾¿ä» RPCInfo è·å– rpc ä¿¡æ¯, è¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/acquire_rpcinfo/">Acquire RPC information&lt;/a>.&lt;/p>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>&lt;strong>1. Map æ³›åŒ–è°ƒç”¨&lt;/strong>&lt;/p>
&lt;p>Map æ³›åŒ–æ”¯æŒé€šè¿‡ SetBinaryWithByteSlice è®¾ç½®å¯¹ binary å­—æ®µè¿”å› []byteã€‚&lt;/p>
&lt;p>&lt;strong>2. RPCInfo å¼‚æ­¥ä½¿ç”¨&lt;/strong>&lt;/p>
&lt;p>å…è®¸å…³é—­ RPCInfo å¤ç”¨ï¼Œç®€åŒ–å¼‚æ­¥ä½¿ç”¨æ–¹å¼ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/acquire_rpcinfo/#12-%E5%BC%82%E6%AD%A5%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F">Acquire RPC information&lt;/a>.&lt;/p>
&lt;h3 id="å…¶å®ƒ">å…¶å®ƒ&lt;/h3>
&lt;p>å‡çº§ Frugal &lt;a href="https://github.com/cloudwego/frugal/releases/tag/v0.1.12">v0.1.12&lt;/a>, ä¿®å¤åŒæ—¶ä½¿ç”¨ frugal å’Œ sonic æ—¶æå°æ¦‚ç‡å‡ºç°çš„å¹¶å‘é—®é¢˜ã€‚
å¼ºçƒˆå»ºè®®åŒæ—¶å‡çº§ frugal å’Œ sonic åˆ°è¾ƒæ–°çš„ç‰ˆæœ¬ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span> go get github.com/cloudwego/frugal@latest
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> go get github.com/bytedance/sonic@latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1051">#1051&lt;/a>] feat(grpc): support gRPC multi-service on a server&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1189">#1189&lt;/a>] feat(rpcinfo): add kitexutil methods for the convenience to fetch rpc information from RPCInfo&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1176">#1176&lt;/a>] feat(tool): add an environment variable to make it easier to debug kitex tool&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1173">#1173&lt;/a>] feat(rpcinfo): allow disable rpcinfo reuse for async reference&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1172">#1172&lt;/a>] feat(retry): client.WithSpecifiedResultRetry should have higher priority&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1150">#1150&lt;/a>] feat(proxy): add an interface to customize proxy middleware to replace the default implementation&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1159">#1159&lt;/a>] feat(generic): support returning []byte for binary fields in map generic&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1153">#1153&lt;/a>] feat(retry): add Extra for retry.FailurePolicy for better extension&lt;/p>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1187">#1187&lt;/a>] optimize(tool): add an option to keep resp for kitex tool&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1183">#1183&lt;/a>] optimize(meshheader): retrieve rip from meshheader and write it to TransInfo&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1178">#1178&lt;/a>] optimize(bizErr): recurse to obtain BizErr to avoid additional Error encapsulation in the middle, resulting in unwrap results that are not BizErr&lt;/p>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1126">#1126&lt;/a>] fix(generic): the issue of structs cache of generic call has dirty data under multiple services scene&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1168">#1168&lt;/a>] fix(tool): remove the pointer to java.Object in generated file for &lt;a href="https://github.com/kitex-contrib/codec-dubbo">CodecDubbo&lt;/a>&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1169">#1169&lt;/a>] fix(tool): empty struct generate wrong struct&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1166">#1166&lt;/a>] fix(generic): issue of deep copy function generation when map key type is binary&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1155">#1155&lt;/a>] fix(tool): add import package &amp;lsquo;context&amp;rsquo; for gRPC client.go&lt;/p>
&lt;h3 id="tests">Tests:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1177">#1177&lt;/a>] test: avoid port conflict&lt;/p>
&lt;h3 id="chore">Chore:&lt;/h3>
&lt;p>[&lt;a href="https://github.com/cloudwego/kitex/pull/1190">#1190&lt;/a>] chore: update thriftgo version to v0.3.3&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1186">#1186&lt;/a>] chore: update readme with examples and new blogs&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1185">#1185&lt;/a>] chore: add ci for windows&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1182">#1182&lt;/a>] chore: update dynamicgo to v0.1.6&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1152">#1152&lt;/a>] chore: update dynamicgo and sonic version&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1164">#1164&lt;/a>] chore: update frugal to v0.1.12 and allow disable frugal by build tag&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1161">#1161&lt;/a>] chore: update frugal to v0.1.10&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1157">#1157&lt;/a>] chore: update frugal to v0.1.9&lt;br>
[&lt;a href="https://github.com/cloudwego/kitex/pull/1151">#1151&lt;/a>] chore(test): upgrade mockey to latest to compatible with Go1.21&lt;/p></description></item><item><title>Blog: Kitex v0.7.2 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2023/09/27/kitex-v0.7.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Wed, 27 Sep 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/09/27/kitex-v0.7.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>&lt;strong>1. é‡è¯•: é™åˆ¶é‡è¯•è¯·æ±‚å æ¯”&lt;/strong>&lt;/p>
&lt;p>è¯¥ç‰¹æ€§ä¼˜åŒ–äº†å¤‡ç”¨è¯·æ±‚çš„å¯ç”¨æ€§ï¼šå¦‚æŸä¸ªè¯·æ±‚è¶…è¿‡é‡è¯•ç­‰å¾…æ—¶é—´ï¼Œä¼šè§¦å‘ä¸€ä¸ªå¤‡ç”¨è¯·æ±‚ï¼Œä½†å¦‚æœè¯¥è¯·æ±‚åœ¨RPCè¶…æ—¶é˜ˆå€¼ä¹‹å†…ï¼Œæœ€ç»ˆå¯ä»¥æ­£å¸¸å¤„ç†ï¼Œå› è€Œä¸ä¼šè¢«å½“åšå¤±è´¥è¯·æ±‚ï¼Œè¿™ä¼šåœ¨å¶å‘ç½‘ç»œå¼‚å¸¸æ—¶å¯¼è‡´å¤§é‡é‡è¯•è¯·æ±‚ï¼Œå¢åŠ æœåŠ¡ç«¯å‹åŠ›ç”šè‡³å¼•èµ·é›ªå´©ã€‚&lt;/p>
&lt;p>å»ºè®®æ›´æ–°ç°æœ‰ä»£ç ï¼š&lt;/p>
&lt;ol>
&lt;li>ä½¿ç”¨ &lt;code>retry.NewRetryContainerWithPercentageLimit()&lt;/code> æ¥æ„é€  RetryContainerï¼Œé™åˆ¶é‡è¯•è¯·æ±‚å æ¯”ï¼›&lt;/li>
&lt;li>åœ¨ Client åˆå§‹åŒ–æ—¶æ·»åŠ é€‰é¡¹ &lt;code>client.WithCloseCallbacks(container.Close)&lt;/code>ï¼Œä»¥ä¾¿åœ¨ client è¢«å›æ”¶æ—¶é‡Šæ”¾ç›¸å…³èµ„æºã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>&lt;strong>1. gRPC&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>unary è¯·æ±‚å‘é€ END_STREAM flag&lt;/li>
&lt;li>ä¿®å¤ grpc streaming ååä¸‹é™ä¸å‹ç¼©å™¨é€‰æ‹©é€»è¾‘&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>2. é•¿è¿æ¥æ± &lt;/strong>&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰æŒ‡å®š &lt;code>MaxIdleGlobal&lt;/code> åˆ™é»˜è®¤ä¸é™åˆ¶ï¼Œç®€åŒ–é•¿è¿æ¥æ± çš„ä½¿ç”¨é…ç½®ã€‚&lt;/p>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;ul>
&lt;li>æ›´æ–° netpoll è‡³ &lt;a href="https://github.com/cloudwego/netpoll/releases/tag/v0.5.0">v0.5.0&lt;/a>&lt;/li>
&lt;li>å‡çº§ frugal åˆ° &lt;a href="https://github.com/cloudwego/frugal/releases/tag/v0.1.8">v0.1.8&lt;/a>ï¼Œæ”¯æŒåœ¨ go1.21 ç¼–è¯‘æ—¶ä½¿ç”¨ frugal (æ³¨: frugal æ—§ç‰ˆæœ¬ä¸æ”¯æŒ go1.21)&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1117">#1117&lt;/a>] feat(retry): support retry percentage limit&lt;/li>
&lt;/ul>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1033">#1033&lt;/a>] optimize: no need to check svcInfo twice&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1115">#1115&lt;/a>] optimize: rm outdated framed suggestion&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1095">#1095&lt;/a>] optimize: add K_METHOD in serviceinline ctx&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1107">#1107&lt;/a>] optimize(connpool): set maxIdleGlobal to no limit if not set&lt;/li>
&lt;/ul>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1116">#1116&lt;/a>] fix: use the last rpcinfo to trace&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1104">#1104&lt;/a>] fix: move limiter handler to the last of the inbound handler to get rpcinfo in custom limiter&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1103">#1103&lt;/a>] fix: reset all fields of netpoll byte buffer when recycle it&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1106">#1106&lt;/a>] fix(grpc): fix grpc streaming tps decreasing and the selection logic of compressor&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1114">#1114&lt;/a>] fix(gRPC): client send END_STREAM flag in unary call (#1066)&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1096">#1096&lt;/a>] fix(tool): add backquote to handle filepath string invalid syntax under windows os&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1098">#1098&lt;/a>] fix(tool): fix import for codegen template when using slim and unknown fields&lt;/li>
&lt;/ul>
&lt;h3 id="tests">Tests:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1124">#1124&lt;/a>] test: fix codegen script&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1122">#1122&lt;/a>] test: add codegen test&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1119">#1119&lt;/a>] test(connpool): modify the idleTimeout&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1133">#1133&lt;/a>] chore: update version v0.7.2&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1125">#1125&lt;/a>] chore: upgrade netpoll to v0.5.0&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1123">#1123&lt;/a>] perf: replace concurrent string builder with lock&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1118">#1118&lt;/a>] perf: optimize remote addr setter interface to reduce lock cost of Address()&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1110">#1110&lt;/a>] chore: upgrade netpoll to v0.4.2 pre-release&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1061">#1061&lt;/a>] chore: netpoll pre release v0.4.2&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1100">#1100&lt;/a>] chore: enable frugal on go1.21&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.7.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2023/08/14/kitex-v0.7.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Mon, 14 Aug 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/08/14/kitex-v0.7.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>&lt;strong>1. gRPC å‹ç¼©æ”¯æŒ&lt;/strong>&lt;/p>
&lt;p>å®ç°äº† KiteX gRPC çš„å‹ç¼©åŠŸèƒ½æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ä¾‹å¦‚ gzip ç­‰å‹ç¼©æ–¹æ³•å‡å° payload ä½“ç§¯&lt;/p>
&lt;p>&lt;strong>2. GLS&lt;/strong>&lt;/p>
&lt;p>ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/localsession">local-session&lt;/a> ç»„ä»¶å…œåº•è¯·æ±‚ä¸Šä¸‹æ–‡ä¼ é€’ï¼Œè§£å†³ç”¨æˆ·æ²¡æœ‰ä¼ é€’ ctx å¯¼è‡´çš„å¾®æœåŠ¡æ–­é“¾é—®é¢˜&lt;/p>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>&lt;strong>1. Unknown Fields æ— åºåˆ—åŒ–ä¼˜åŒ–&lt;/strong>&lt;/p>
&lt;p>å®ç°æ— åºåˆ—åŒ–çš„ unknown field åŠŸèƒ½ï¼Œæ— åºåˆ—åŒ–unknown fieldsæ–¹æ¡ˆåœ¨FastCodecä¸Šæ€§èƒ½æå‡çº¦6x ~ 7xï¼Œè¯¦è§ï¼š&lt;a href="https://github.com/cloudwego/kitex/pull/1017">#1017&lt;/a>&lt;/p>
&lt;p>&lt;strong>2. DynamicGo é›†æˆ&lt;/strong>&lt;/p>
&lt;p>åœ¨ KiteX çš„æ³›åŒ–æ¨¡å—ä¸­é›†æˆ &lt;a href="https://github.com/cloudwego/dynamicgo">dynamicgo&lt;/a> ä»¥æå‡ JSON\HTTP æ³›åŒ–è°ƒç”¨æ€§èƒ½ ï¼ˆ+50%ï½200%ï¼‰&lt;/p>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;p>å‡çº§ Thriftgo åº“ä¾èµ–è‡³ v0.3.0 ï¼Œæ”¯æŒäº† Thriftgo åå°„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶è·å– IDL å…ƒä¿¡æ¯&lt;/p>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h3 id="feature">Feature:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1053">#1053&lt;/a>] feat(retry): support to distinguish local retry request&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1058">#1058&lt;/a>] feat(retry): support delete retry policy dynamically&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1000">#1000&lt;/a>] feat(grpc): support grpc compress&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1018">#1018&lt;/a>] feat: use local-session to backup request context in case of missing&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1045">#1045&lt;/a>] feat(generic): support base64 codec for map generic&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1035">#1035&lt;/a>] feat(config): provide the ability to dynamically configure the rpctimeout config on the method hierarchy&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/825">#825&lt;/a>] feat(generic): integrate dynamicgo into kitex generic call&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1019">#1019&lt;/a>] feat(lb): interleaved weighted round-robin load balancer&lt;/li>
&lt;/ul>
&lt;h3 id="optimize">Optimize:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1064">#1064&lt;/a>] optimize: check header max size when ttheader encode&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1017">#1017&lt;/a>] optimize: implement unknown field function without serialization&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1036">#1036&lt;/a>] optimize(protobuf): ignore err when (un)marshal empty req/resp&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1056">#1056&lt;/a>] optimize(tool): optimize struct ref&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1043">#1043&lt;/a>] optimize: add method info to the error message of the server handler panic for easy troubleshooting&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1025">#1025&lt;/a>] optimize: use Tags of ServerBasicInfo as default Tags of RegistryInfo&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1020">#1020&lt;/a>] optimize: add nil check for MethodInfo which get from ServiceInfo in client.Call to ignore panic&lt;/li>
&lt;/ul>
&lt;h3 id="fix">Fix:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1073">#1073&lt;/a>] fix: fix failure retryer dump panic&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1067">#1067&lt;/a>] fix: slim template with deepcopy&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1055">#1055&lt;/a>] fix: ignore SIGHUP when run with nohup&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1048">#1048&lt;/a>] fix(retry): keep the behavior of retry policy consistent between initing and updating&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1047">#1047&lt;/a>] fix(tool): cli warning for unknown suffix&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1038">#1038&lt;/a>] fix(config): correct the function signature of the rpcinfo.TimeoutProvider implementation&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1034">#1034&lt;/a>] fix(generic): add case int16 into buildinTypeIntoString&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1023">#1023&lt;/a>] fix(generic): avoid dead-loop when marshal self-referenced struct&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1028">#1028&lt;/a>] fix:modify .licenserc.yaml&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1012">#1012&lt;/a>] fix: skip frugal on go 1.21&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/992">#992&lt;/a>] fix(grpc): use mcache to fix memory leak caused by grpc codec buffer to reuse memory incorrectly&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/994">#994&lt;/a>] fix(tool): fix kitex tool git repo pulling logic&lt;/li>
&lt;/ul>
&lt;h3 id="chore">Chore:&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1074">#1074&lt;/a>] chore: update thriftgo to v0.3.0&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1031">#1031&lt;/a>] chore: remove wechat group in readme&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1008">#1008&lt;/a>] chore: update dynamicgo to v0.1.1&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1006">#1006&lt;/a>] chore: remove unnecessary replace for frugal&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/1007">#1007&lt;/a>] chore: upgrade netpoll to v0.4.1&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.6.1 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2023/06/19/kitex-v0.6.1-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Mon, 19 Jun 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/06/19/kitex-v0.6.1-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="è¯¦ç»†å˜æ›´">&lt;strong>è¯¦ç»†å˜æ›´&lt;/strong>&lt;/h2>
&lt;h2 id="hotfix">Hotfix:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/988">#988&lt;/a>] hotfix(code_gen): ä¿®å¤slimæ¨¡æ¿ä»£ç ç”Ÿæˆå¤±è´¥é—®é¢˜&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.6.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2023/06/14/kitex-v0.6.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Wed, 14 Jun 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/06/14/kitex-v0.6.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>&lt;strong>1. GRPC å…ƒä¿¡æ¯ä¼ é€’&lt;/strong>&lt;/p>
&lt;p>client é»˜è®¤å°† header è®¾ç½®åˆ° ctxï¼Œå¤–éƒ¨æ–¹æ³•å¯åˆ©ç”¨ &lt;code>GetHeaderMetadataFromCtx&lt;/code> è·å–å…ƒä¿¡æ¯ã€‚å¯ç”¨äº transmeta å†…è·å–å…ƒä¿¡æ¯å¹¶è®¾ç½®åˆ° rpcinfo ä¸­ï¼Œæˆ–åœ¨ä¸­é—´ä»¶å†…è·å– header ä¿¡æ¯ã€‚&lt;/p>
&lt;p>&lt;strong>2. Kitex é…ç½®æ¨¡å—é‡æ„&lt;/strong>&lt;/p>
&lt;p>å¢åŠ é‡è¯•ã€ç†”æ–­ã€è¶…æ—¶ã€é™æµçš„ config itemï¼Œæ”¯æŒ &lt;a href="https://github.com/cloudwego/configmanager">configmanager&lt;/a> ä¸­é—´ä»¶å®šä¹‰çš„æ¥å£ï¼Œç”¨äºæ”¯æŒä¸å¤–éƒ¨é…ç½®ä¸­å¿ƒçš„æ‰©å±•é›†æˆã€‚&lt;/p>
&lt;p>&lt;strong>3. Kitex - å·¥å…·&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>æ”¯æŒåœ¨ thrift ç”Ÿæˆä»£ç ä¸­æ’å…¥å¯¹è±¡æ·±æ‹·è´å‡½æ•°ï¼Œç”¨äºæ·±æ‹·è´æºå¯¹è±¡åˆ°ç›®æ ‡å¯¹è±¡ï¼Œä½¿ç”¨æ–¹å¼ä¸º kitex å‘½ä»¤å¢åŠ  &lt;code>-deep-copy-api&lt;/code> å‚æ•°ï¼›&lt;/li>
&lt;li>æ”¯æŒåœ¨ thrift ç”Ÿæˆä»£ç ä¸­æ’å…¥ IDL æè¿°ç¬¦æ³¨å†Œä»£ç ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶åŠ è½½å¯¹åº”ç”Ÿæˆä»£ç åï¼Œæ³¨å†Œ IDL æè¿°ç¬¦ä¿¡æ¯åˆ° &lt;code>github.com/cloudwego/kitex/pkg/reflection/thrift&lt;/code> åŒ…å†…ï¼Œå¹¶é€šè¿‡æš´éœ²çš„å‡½æ•°è·å–æè¿°ç¬¦ä¿¡æ¯ï¼Œä½¿ç”¨æ–¹å¼ä¸ºåœ¨ kitex å‘½ä»¤ &lt;code>thrift&lt;/code> å‚æ•°æ·»åŠ  &lt;code>generate-reflection-info=true&lt;/code> ï¼Œå¦‚ &lt;code>kitex -thrift generate-reflection-info=true ...&lt;/code> ï¼›Kitex åœ¨ v1.12.0 åªæ”¯æŒäº† IDL æè¿°ç¬¦ä¿¡æ¯æ³¨å†Œï¼Œæ›´ä¸°å¯Œçš„æŸ¥è¯¢æ¥å£å°†åœ¨åç»­ç‰ˆæœ¬è¿›è¡Œå‘å¸ƒï¼ŒåŒæ—¶ IDL æè¿°ç¬¦æ³¨å†Œå‡½æ•°ç”Ÿæˆä¹Ÿå°†ä¿®æ”¹ä¸ºé»˜è®¤ç”Ÿæˆã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>&lt;strong>1. é‡æ„ detection server æ”¯æŒå¤šç§åè®®çš„æ¢æµ‹&lt;/strong>&lt;/p>
&lt;p>æ—§ç‰ˆæœ¬ detection server å†™æ­»äº† http2 ä½œä¸ºæ¢æµ‹åè®®ï¼Œv1.12.0 ç‰ˆæœ¬æ”¯æŒç”¨æˆ·ä¼ å…¥å®ç°äº† &lt;code>detection.DetectableServerTransHandler&lt;/code> æ¥å£çš„ &lt;code>remote.ServerTransHandler&lt;/code> å¯¹åº”çš„ &lt;code>remote.ServerTransHandlerFactory&lt;/code> ä½œä¸ºä¸å®šå‚æ•°ï¼Œé…åˆé»˜è®¤çš„&lt;code>remote.ServerTransHandler&lt;/code>å¤„ç†æœªåŒ¹é…çš„åè®®ï¼Œå®ç°å¤šç§åè®®å…¼å®¹çš„Kitex Serverã€‚&lt;/p>
&lt;p>&lt;strong>2. ä¸€è‡´æ€§ hash&lt;/strong>&lt;/p>
&lt;p>ä¸€è‡´æ€§hashè´Ÿè½½å‡è¡¡ä¸­ &lt;code>buildVirtualNodes&lt;/code> ä½¿ç”¨ &lt;code>virtualFactorLen&lt;/code> åˆå§‹åŒ– &lt;code>bytes&lt;/code> æ•°ç»„ï¼Œ ç©ºé—´å¯èƒ½ä¸è¶³å®¹çº³ä¸‹ &lt;code>VirtualNodeLen&lt;/code> ç¼–å·ï¼Œå¯¼è‡´ &lt;code>address&lt;/code> éƒ¨åˆ†è¢«è¦†ç›–ã€‚&lt;/p>
&lt;p>&lt;strong>3. é•¿è¿æ¥æ± åŸ‹ç‚¹&lt;/strong>&lt;/p>
&lt;p>ä¿®å¤é•¿è¿æ¥æ± å¤ç”¨è¿æ¥æˆåŠŸæ—¶æ‰“ç‚¹æœªä¸ŠæŠ¥é—®é¢˜ã€‚&lt;/p>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;p>å‡çº§ netpoll åº“ä¾èµ–è‡³ v0.4.0 ï¼ŒåŒæ—¶æ”¯æŒ &lt;a href="https://github.com/cloudwego/configmanager">configmanager&lt;/a> v0.2.0 ç‰ˆæœ¬ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h2 id="feature">Feature:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/923">#923&lt;/a>] feat(grpc): grpc å®¢æˆ·ç«¯å°† header å’Œ trailer è®¾ç½®åˆ° context å†…ï¼Œå¹¶æä¾›æ¥å£ä» context è·å– header&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/891">#891&lt;/a>] feat: æ”¯æŒ rpc client å’Œ server çš„æœåŠ¡åˆå¹¶ï¼Œå®ƒå¯ä»¥å°†è¿œç«¯ rpc è°ƒç”¨æ”¹æˆæœ¬åœ°çš„å‡½æ•°çº§è°ƒç”¨ã€‚è¿™ä¸ªç‰¹æ€§éœ€è¦ç”Ÿæˆå·¥å…·æ”¯æŒ&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/946">#946&lt;/a>] feat: default server handler æ”¯æŒé€šè¿‡trans pipelineæ‰§è¡ŒReadå‡½æ•°&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/936">#936&lt;/a>] feat(config): å¢åŠ  é‡è¯•ã€ç†”æ–­ã€è¶…æ—¶ã€é™æµ çš„ config item&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/924">#924&lt;/a>] [&lt;a href="https://github.com/cloudwego/kitex/pull/939">#939&lt;/a>] feat(code_gen): æ”¯æŒç”Ÿæˆæ·±æ‹·è´APIä»£ç åŠŸèƒ½&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/926">#926&lt;/a>] feat: æ”¯æŒthriftåå°„ä¿¡æ¯æ³¨å†Œ&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/897">#897&lt;/a>] feat: è‡ªå®šä¹‰æ¨¡æ¿ä¸­æ”¯æŒ loop_service&lt;/li>
&lt;/ul>
&lt;h2 id="optimize">Optimize:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/961">#961&lt;/a>] optimize(tool): -use å‚æ•°æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿åœºæ™¯&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/966">#966&lt;/a>] optimize(ttheader): ttheader çš„ headerFlags å¤„ç†å¢åŠ ç±»å‹æ£€æŸ¥&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/919">#919&lt;/a>] optimize: ä½¿ç”¨ GoFunc æ›¿ä»£ go func ä»¥é¿å… panic&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/960">#960&lt;/a>] optimize: å…¬å¼€statsåŒ…ä»¥ä¾¿åœ¨æ‰©å±•ä»“åº“ä¸­é‡ç”¨&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/955">#955&lt;/a>] optimize: ç§»é™¤ gonet transerver ä¸­å¤šä½™çš„ onRead é”™è¯¯æ—¥å¿—&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/954">#954&lt;/a>] optimize: å½“ transHandler æ²¡æœ‰å®ç° GracefulShutdown æ¥å£æ—¶ï¼Œä¸è¿”å›æŠ¥é”™&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/941">#941&lt;/a>] optimize(callopt): ä¼˜åŒ– callopt çš„ debug ä¿¡æ¯ï¼Œå‡å°‘ slice æ‰©å¼ çš„å¯èƒ½æ€§&lt;/li>
&lt;/ul>
&lt;h2 id="fix">Fix:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/963">#963&lt;/a>] fix(generic): ä¿®å¤ map æ³›åŒ–è°ƒç”¨åœ¨ byte ç±»å‹å­—æ®µ panic çš„é—®é¢˜&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/901">#901&lt;/a>] fix(mux): å¤šè·¯å¤ç”¨è¿æ¥çš„ asynccallback ä¸åˆ›å»ºæ–° goroutineï¼Œå¹¶ä¸” server ç­‰å¾…æ‰€æœ‰ crrst åŒ…éƒ½è¢« client æ¥æ”¶åå†å…³é—­&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/921">#921&lt;/a>] fix(loadbalance): ä¿®å¤ä¸€è‡´æ€§ hash []byte æ•°ç»„é•¿åº¦ä¸å¤Ÿç”¨çš„é—®é¢˜&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/922">#922&lt;/a>] fix(mux): ä¿®å¤å½“å¼€å¯ mux å¹¶ä¸”ä½¿ç”¨ Kitex Protobuf æ—¶ï¼Œåœ¨é€€å‡ºæ—¶è¾“å‡ºä¸åˆç†çš„ error é—®é¢˜&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/927">#927&lt;/a>] fix(connpool): é•¿è¿æ¥æ± å¤ç”¨è¿æ¥æˆåŠŸæ—¶è¿›è¡Œä¸ŠæŠ¥&lt;/li>
&lt;/ul>
&lt;h2 id="refactor">Refactor:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/958">#958&lt;/a>] refactor(errorHandler): é‡æ„ error handler å®šä¹‰ï¼Œå¯ä»¥è·å–æ›´æ–°ä¿¡æ¯å¤„ç† error&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/943">#943&lt;/a>] refactor(client): é‡æ„ client.Call æå‡ä»£ç å¯è¯»æ€§&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/560">#560&lt;/a>] refactor: é‡æ„server detection trans handlerä»¥æ”¯æŒå¤šç§åè®®çš„æ¢æµ‹&lt;/li>
&lt;/ul>
&lt;h2 id="tests">Tests:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/900">#900&lt;/a>] test(generic): æ·»åŠ ä½¿ç”¨ dynamicgo çš„ thrift åå°„æ³›åŒ–è°ƒç”¨ç¤ºä¾‹&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/976">#976&lt;/a>] chore: æ›´æ–° netpoll ç‰ˆæœ¬åˆ° v0.4.0 å¹¶ä¸”æ›´æ–° thriftgo ç‰ˆæœ¬åˆ° v0.2.11&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/956">#956&lt;/a>] chore: æ›´æ–° configmanager ç‰ˆæœ¬åˆ° v0.2.0&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/948">#948&lt;/a>] chore: ä½¿ç”¨ goimports -local github.com/cloudwego/kitex è°ƒæ•´ä»“åº“æ ¼å¼&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.5.3 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2023/04/21/kitex-v0.5.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Fri, 21 Apr 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/04/21/kitex-v0.5.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>å¼‚å¸¸é‡è¯•ï¼šæ·»åŠ é…ç½®ï¼Œæ”¯æŒä¸å¯¹è¶…æ—¶é”™è¯¯è¿›è¡Œé‡è¯•ï¼Œç”¨äºè¯·æ±‚éå¹‚ç­‰çš„åœºæ™¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä»£ç ç”Ÿæˆå·¥å…·ï¼šæ”¯æŒ windows ç¯å¢ƒä½¿ç”¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¶…æ—¶é”™è¯¯ç±»å‹æ‹†åˆ†ï¼šæ”¯æŒç»†ç²’åº¦çš„è¶…æ—¶é”™è¯¯ç±»å‹ï¼Œå°† ErrRPCTimeout ç»†åˆ†ä¸ºä¸‰ä¸ªé”™è¯¯ç±»å‹ï¼šè¶…æ—¶ã€ä¸šåŠ¡cancelã€ä¸šåŠ¡timeoutã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Thrift FastCodecï¼šæ”¯æŒ unknown fieldsã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>unknown fields ä½¿ç”¨èƒŒæ™¯ï¼šåœ¨ thrift ä¸­ï¼ŒIDL å†…å¢åŠ å­—æ®µå¯¹æœªæ›´æ–° IDL çš„ä¸€æ–¹æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œå¿…é¡»æ›´æ–° IDL ä¸ç”Ÿæˆä»£ç ä»¥è·å–åˆ°æ–°çš„å­—æ®µã€‚è¿™ä¼šå¯¼è‡´è°ƒç”¨é“¾è·¯ä¸ŠæŸä¸ªèŠ‚ç‚¹æ›´æ–° IDL æ—¶ï¼Œä¸‹æ¸¸æ‰€æœ‰èŠ‚ç‚¹å‡éœ€è¦è¿›è¡Œæ›´æ–°ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>unknown fields åˆ™æ”¯æŒä¿ç•™æœªè¯†åˆ«çš„å­—æ®µï¼Œå¯¹äº IDL å†…ä¸å­˜åœ¨çš„å­—æ®µï¼Œè¯»å–å¹¶è®¾ç½®äºç»“æ„ä½“çš„ &lt;code>_unknownFields&lt;/code> å­—æ®µã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä½¿ç”¨æ–¹æ³•ï¼š&lt;code>kitex -thrift keep_unknown_fields your.thrift&lt;/code>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="ä¿®å¤">ä¿®å¤&lt;/h3>
&lt;ol>
&lt;li>å¤±è´¥é‡è¯•ç­–ç•¥ï¼šä¿®å¤å¤±è´¥é‡è¯•ç­–ç•¥è¢«åŠ¨æ€ä¿®æ”¹åï¼Œç»“æœé‡è¯• (resultRetry) ç­–ç•¥å¤±æ•ˆçš„é—®é¢˜ã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h2 id="feature">Feature:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/887">#887&lt;/a>] feat(retry): å¢åŠ é…ç½®ï¼Œæ”¯æŒå¼‚å¸¸é‡è¯•åœºæ™¯ä¸‹ä¸å¯¹è¶…æ—¶åšé‡è¯•ï¼Œç”¨äºè¯·æ±‚éå¹‚ç­‰çš„åœºæ™¯&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/881">#881&lt;/a>] feat(tool): æ”¯æŒ windows åœºæ™¯ä¸‹çš„ä»£ç ç”Ÿæˆ&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/880">#880&lt;/a>] feat(rpctimeout): æ”¯æŒç»†ç²’åº¦çš„è¶…æ—¶é”™è¯¯ç±»å‹&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/872">#872&lt;/a>] feat(thrift): åœ¨ fast codec ä¸­æ”¯æŒ unknown fields çš„åºåˆ—åŒ–åŠååºåˆ—åŒ–&lt;/li>
&lt;/ul>
&lt;h2 id="optimize">Optimize:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/884">#884&lt;/a>] optimize(rpcinfo): RPCInfo.To().Tag() ä¼˜å…ˆä½¿ç”¨æœåŠ¡å‘ç°çš„instance tagè€Œä¸æ˜¯remoteinfo tag&lt;/li>
&lt;/ul>
&lt;h2 id="fix">Fix:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/896">#896&lt;/a>] fix(remoteinfo): ä¿®å¤ remoteinfo ä¸­éæ·±æ‹·è´çš„ CopyFrom å¼•å…¥çš„ race é—®é¢˜&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/892">#892&lt;/a>] fix(grpc): æ³¨é‡Š ReadFrame error æ—¶è¾“å‡ºçš„ error æ—¥å¿—&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/889">#889&lt;/a>] fix(retry): åœ¨å¤±è´¥é‡è¯•ç­–ç•¥è¢«åŠ¨æ€ä¿®æ”¹åï¼Œç»“æœé‡è¯•ç­–ç•¥å¤±æ•ˆ&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/866">#866&lt;/a>] fix(grpc): stream çš„ sendMsg/recvMsg è¿”å›çš„ ctx æ— éœ€èµ‹å€¼ç»™ stream çš„ ctx&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore:&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/898">#898&lt;/a>] chore: æ›´æ–° PR çš„æ¨¡æ¿ï¼Œå¯¹ç”¨æˆ·æ–‡æ¡£çš„æ›´æ–°åš check&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/854">#854&lt;/a>] style(nphttp2): ä¿è¯ receiver çš„åå­—ä¸€è‡´&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.5.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2023/03/08/kitex-v0.5.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Wed, 08 Mar 2023 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2023/03/08/kitex-v0.5.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;p>&lt;strong>1. Fallback åŠŸèƒ½: æ”¯æŒ Client ä¾§çš„ Fallback åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;p>ä¸šåŠ¡åœ¨ RPC è¯·æ±‚å¤±è´¥åé€šå¸¸ä¼šæœ‰ä¸€äº›é™çº§æªæ–½ä¿è¯æœ‰æ•ˆè¿”å›ï¼ˆæ¯”å¦‚åœ¨è¯·æ±‚è¶…æ—¶ã€ç†”æ–­åï¼Œæ„é€ é»˜è®¤è¿”å›ï¼‰ï¼ŒKitex çš„ Fallback æ”¯æŒå¯¹æ‰€æœ‰å¼‚å¸¸è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚
åŒæ—¶ï¼Œå› ä¸ºä¸šåŠ¡å¼‚å¸¸é€šå¸¸ä¼šé€šè¿‡ BaseResp å­—æ®µè¿”å›ï¼Œæ‰€ä»¥ä¹Ÿæ”¯æŒå¯¹ Resp è¿›è¡Œå¤„ç†ã€‚è¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/fallback/">Fallback&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;strong>2. Kitex - gRPCï¼šClient å¢åŠ  TLS çš„é…ç½®&lt;/strong>&lt;/p>
&lt;p>é€šè¿‡ client.WithGRPCTLSConfig option é…ç½®ã€‚&lt;/p>
&lt;p>&lt;strong>3. Kitex - å·¥å…·&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ”¯æŒè‡ªå®šä¹‰è„šæ‰‹æ¶æ¨¡æ¿&lt;/strong>ï¼Œè¯¦è§ï¼š &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/custom_tpl/">è‡ªå®šä¹‰è„šæ‰‹æ¶æ¨¡æ¿&lt;/a>&lt;/li>
&lt;li>&lt;strong>æ”¯æŒæŒ‡å®šç”Ÿæˆä»£ç çš„ç›®å½•&lt;/strong>ï¼Œè¯¦è§ï¼š &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/code_generation/#-gen-path">ä»£ç ç”Ÿæˆå·¥å…· -gen-path&lt;/a>&lt;/li>
&lt;li>&lt;strong>æ”¯æŒ protoc æ’ä»¶é€‰é¡¹&lt;/strong>ï¼Œè¯¦è§ï¼š &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/code_generation/#-protobuf-plugin">ä»£ç ç”Ÿæˆå·¥å…· -protobuf-plugin&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>&lt;strong>1. è´Ÿè½½å‡è¡¡ï¼šä½¿ç”¨æƒé‡è½®è¯¢ä½œä¸ºé»˜è®¤ Loadbalance ç­–ç•¥&lt;/strong>&lt;/p>
&lt;p>æ—§ç‰ˆæœ¬é»˜è®¤ä½¿ç”¨æƒé‡éšæœºåš Loadbalanceï¼ŒRandom å¯ä»¥åšåˆ°å…¨å±€çš„å‡è¡¡ï¼Œä½†åœ¨æœåŠ¡ç«¯å®ä¾‹è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œéšæœºæœ‰è¾ƒå¤§æ¦‚ç‡è¿ç»­è®¿é—®ä¸€ä¸ªå®ä¾‹ï¼Œå¯¼è‡´ä¸‹æ¸¸èŠ‚ç‚¹æœ€å¤§å¹¶å‘è¯·æ±‚æ•°å¢åŠ ï¼Œæ‰€ä»¥æ–°ç‰ˆæœ¬å°†é»˜è®¤ç­–ç•¥è°ƒæ•´ä¸ºè½®è¯¢ã€‚
è¯¦è§ï¼š&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/loadbalance/">è´Ÿè½½å‡è¡¡&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;strong>2. è¿æ¥æ± åç¨‹é—®é¢˜&lt;/strong>&lt;/p>
&lt;p>æ—§ç‰ˆæœ¬åœ¨ä½¿ç”¨é•¿è¿æ¥æ—¶ï¼Œæ¯ä¸ª client å¯¹åº”ä¸€ä¸ªåç¨‹èµ„æºæ¸…ç†è¿æ¥ï¼Œåœ¨ client è¾ƒå¤šæ—¶ä¼šå¯¼è‡´åç¨‹è¿‡å¤šï¼Œæ–°ç‰ˆæœ¬æ”¹ä¸ºå…±äº«åç¨‹é¿å… goroutine æ•°é‡éšç€ client æ•°é‡å¢é•¿ã€‚&lt;/p>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;p>å‡çº§ frugal, pid åº“ä¾èµ–ä»¥æ”¯æŒ go 1.20ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h3 id="feature">Feature&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/840">#840&lt;/a>] feat(fallback): support fallback ability for kitex client-side, usage guide refer to &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/fallback/">Fallback&lt;/a>&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/841">#841&lt;/a>] feat(tool): add GetResult() and GetFirstArgument() methods for service params of protobuf&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/791">#791&lt;/a>] feat(tool): merge two ways of passing extensions, to support two ways at sametime&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/797">#797&lt;/a>] feat(loadbalance): use smooth weighted round robin algo as default Loadbalance policy&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/760">#760&lt;/a>] feat(grpc): support TLS config in kitex grpc client&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/781">#781&lt;/a>] feat(tool): supports custom templates&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/783">#783&lt;/a>] feat(ttheader): add encode logic for gdpr token in TransInfo&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/775">#775&lt;/a>] feat(tool): support custom generate path&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/687">#687&lt;/a>] feat(tool): add protoc plugin flag&lt;/li>
&lt;/ul>
&lt;h3 id="optimize">Optimize&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/750">#750&lt;/a>] optimize(generic): generic call write zero value for required and default fields to meet the specification of apache thrift and keep consistent with normal thrift encode of Kitex.&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/739">#739&lt;/a>] optimize(generic): modify the url routing to align with Hertz for HTTP generic call&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/752">#752&lt;/a>] optimize(ttheader): attach part of ttheader binary into error when readKVInfo failed, which is useful for troubleshooting&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/821">#821&lt;/a>] optimize(config): add DeepCopy() &amp;amp; Equals() to circuitbreaker.CBConfig and retry.Policy&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/827">#827&lt;/a>] optimize: revise the remoteInfo of retry call, using the remoteInfo of the RPCCall that returns&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/762">#762&lt;/a>] optimize(tool): add go mod auto replace to thrift 0.13 in thrift mode&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/755">#755&lt;/a>] optimize: improve client error msg when ctx cancel or timeout&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/756">#756&lt;/a>] optimize: use sync.Cond as the profiler event trigger&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/753">#753&lt;/a>] optimize: add recover for client&amp;rsquo;s Close&lt;/li>
&lt;/ul>
&lt;h3 id="fix">Fix&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/734">#734&lt;/a>] fix(retry): fix the panic problem caused by concurrent read and write of rpcinfo under backup retry&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/837">#837&lt;/a> &lt;a href="https://github.com/cloudwego/kitex/pull/842">#842&lt;/a>] fix(metahandler): adjust MetainfoHandler to the top of the MetaHandlers array to ensure that the logic of custom MetaHandlers that depends on MetainfoHandler works&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/812">#812&lt;/a>] fix: use detectionHandler to perform protocol detection in windows environment to support gRPC&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/851">#851&lt;/a>] fix: upgrade frugal to v0.1.6 for missing stop field&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/845">#845&lt;/a>] fix: fix the problem that RPCStat report status as success when biz handler return err&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/822">#822&lt;/a>] fix(loadbalance): don&amp;rsquo;t share balancer factory when loadbalance is defined by user&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/732">#732&lt;/a>] fix(mux): mux server waits for shardqueue close before shutdown&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/795">#795&lt;/a>] fix(grpc): zero first byte of grpc data frame, which could be random data from mcache&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/668">#668&lt;/a>] fix: fix race problem in queue.go/queue @dugenkui03&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/743">#743&lt;/a>] fix: use sharedTicker for long conn pool to prevent goroutine numbers increase as the number of client increases&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/799">#799&lt;/a>] fix(util): should return when get at least one GOPATH @StellarisW&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/807">#807&lt;/a>] fix(codec): fix fastpb nil ptr when struct fields are all default values&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/794">#794&lt;/a>] fix(tool): fix fastpb codegen by updating dependency&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/787">#787&lt;/a>] fix(tool): the import did not use the new method to render when template append content&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/785">#785&lt;/a>] fix(tool): remove useless combine service files&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/754">#754&lt;/a>] fix: fix the usage of metainfo in grpc scene&lt;/li>
&lt;/ul>
&lt;h3 id="refactor">Refactor&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/814">#814&lt;/a> &lt;a href="https://github.com/cloudwego/kitex/pull/843">#843&lt;/a>] refactor(trans): return error in onRead of defaultServerHandler and close conn in outer method&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/816">#816&lt;/a>] refactor(utils): add utils.GetEnvLogDir and deprecate utils.GetLogDir&lt;/li>
&lt;/ul>
&lt;h3 id="test--docs--chore">Test &amp;amp; Docs &amp;amp; Chore&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/839">#839&lt;/a> &lt;a href="https://github.com/cloudwego/kitex/pull/693">#693&lt;/a>] test: import mockey repo and add usage demo of mockey unit test&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/806">#806&lt;/a>] test(transmeta):add some test cases for tansmeta package&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/761">#761&lt;/a>] docs: update README.md @fuergaosi233&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/817">#817&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/832">#832&lt;/a>] chore: upgrade dependency lib to adapt go 1.20&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/772">#772&lt;/a>] chore: modify kitex gen code meta file name from kitex.yaml to kitex_info.yaml&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex Proxyless ä¹‹æµé‡è·¯ç”±ï¼šé…åˆ Istio ä¸ OpenTelemetry å®ç°å…¨é“¾è·¯æ³³é“</title><link>https://www.cloudwego.io/zh/blog/2022/11/08/kitex-proxyless-%E4%B9%8B%E6%B5%81%E9%87%8F%E8%B7%AF%E7%94%B1%E9%85%8D%E5%90%88-istio-%E4%B8%8E-opentelemetry-%E5%AE%9E%E7%8E%B0%E5%85%A8%E9%93%BE%E8%B7%AF%E6%B3%B3%E9%81%93/</link><pubDate>Tue, 08 Nov 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/11/08/kitex-proxyless-%E4%B9%8B%E6%B5%81%E9%87%8F%E8%B7%AF%E7%94%B1%E9%85%8D%E5%90%88-istio-%E4%B8%8E-opentelemetry-%E5%AE%9E%E7%8E%B0%E5%85%A8%E9%93%BE%E8%B7%AF%E6%B3%B3%E9%81%93/</guid><description>
&lt;blockquote>
&lt;p>å¯¼è¯­ï¼šKitex Proxyless æ˜¯ Kitex æœåŠ¡èƒ½å¤Ÿä¸å€ŸåŠ© envoy sidecar ç›´æ¥ä¸ istiod äº¤äº’ï¼ŒåŸºäº xDS åè®®åŠ¨æ€è·å–æ§åˆ¶é¢ä¸‹å‘çš„æœåŠ¡æ²»ç†è§„åˆ™ï¼Œå¹¶è½¬æ¢ä¸º Kitex å¯¹åº”è§„åˆ™æ¥å®ç°ä¸€äº›æœåŠ¡æ²»ç†åŠŸèƒ½ï¼Œå¦‚æµé‡è·¯ç”±ã€‚åŸºäº Kitex Proxylessï¼Œèƒ½å¤Ÿå®ç° Kitex æ— éœ€ä»£ç†å°±å¯ä»¥è¢« ServiceMesh ç»Ÿä¸€ç®¡ç†ï¼Œè¿›è€Œå®ç°å¤šç§éƒ¨ç½²æ¨¡å¼ä¸‹çš„æ²»ç†è§„åˆ™ Specã€æ²»ç†æ§åˆ¶é¢ã€æ²»ç†ä¸‹å‘åè®®ã€å¼‚æ„æ•°æ®æ²»ç†èƒ½åŠ›çš„ç»Ÿä¸€ã€‚æœ¬æ–‡åœ¨ biz-demo ä¸­ä½¿ç”¨ Kitex å’Œ Hertz é‡å†™ bookinfo é¡¹ç›®ï¼Œä»¥å®æˆ˜çš„æ–¹å¼æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ xDS å®ç°å…¨é“¾è·¯çš„æµé‡æ³³é“ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="01-å¼•è¨€">01 å¼•è¨€&lt;/h2>
&lt;h3 id="kitex-proxyless">&lt;strong>Kitex Proxyless&lt;/strong>&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ˜¯å­—èŠ‚å¼€æºçš„ Golang RPC æ¡†æ¶ï¼Œå·²ç»åŸç”Ÿæ”¯æŒäº† xDS æ ‡å‡†åè®®ï¼Œæ”¯æŒä»¥ Proxyless çš„æ–¹å¼è¢« ServiceMesh ç»Ÿä¸€çº³ç®¡ã€‚&lt;/p>
&lt;ul>
&lt;li>è¯¦ç»†è®¾è®¡è§ï¼š
&lt;a href="https://github.com/cloudwego/kitex/issues/461">Proposal: Kitex support xDS Protocol Â· Issue #461 Â· cloudwego/kitex&lt;/a>&lt;/li>
&lt;li>å…·ä½“ä½¿ç”¨æ–¹å¼è§&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/xds/">å®˜æ–¹æ–‡æ¡£&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>&lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Proxyless&lt;/strong> ç®€å•æ¥è¯´å°±æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æœåŠ¡èƒ½å¤Ÿä¸å€ŸåŠ© envoy sidecar ç›´æ¥ä¸ istiod äº¤äº’ï¼ŒåŸºäº xDS åè®®åŠ¨æ€è·å–æ§åˆ¶é¢ä¸‹å‘çš„æœåŠ¡æ²»ç†è§„åˆ™ï¼Œå¹¶è½¬æ¢ä¸º &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¯¹åº”è§„åˆ™æ¥å®ç°ä¸€äº›æœåŠ¡æ²»ç†åŠŸèƒ½ï¼ˆä¾‹å¦‚æœ¬æ–‡çš„é‡ç‚¹ï¼š&lt;strong>æµé‡è·¯ç”±&lt;/strong>ï¼‰ã€‚&lt;/p>
&lt;p>åŸºäº &lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Proxyless&lt;/strong>ï¼Œè®©æˆ‘ä»¬å®ç° &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> èƒ½å¤Ÿæ— éœ€ä»£ç†å°±å¯ä»¥è¢« ServiceMesh ç»Ÿä¸€ç®¡ç†ï¼Œè¿›è€Œå®ç°å¤šç§éƒ¨ç½²æ¨¡å¼ä¸‹çš„&lt;strong>æ²»ç†è§„åˆ™ Specã€æ²»ç†æ§åˆ¶é¢ã€æ²»ç†ä¸‹å‘åè®®ã€å¼‚æ„æ•°æ®æ²»ç†èƒ½åŠ›&lt;/strong>çš„ç»Ÿä¸€ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/1.png" alt="image">&lt;/p>
&lt;h3 id="æµé‡è·¯ç”±">æµé‡è·¯ç”±&lt;/h3>
&lt;blockquote>
&lt;p>æµé‡è·¯ç”±æ˜¯æŒ‡ï¼Œèƒ½å¤Ÿå°†æµé‡&lt;strong>æ ¹æ®å…¶è‡ªèº«ç‰¹å®šçš„å…ƒæ•°æ®æ ‡è¯†è·¯ç”±&lt;/strong>åˆ°æŒ‡å®šç›®çš„åœ°ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æµé‡è·¯ç”±å±äºæœåŠ¡æ²»ç†ä¸­æ¯”è¾ƒæ ¸å¿ƒçš„èƒ½åŠ›ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Proxyless ä¼˜å…ˆæ”¯æŒçš„åœºæ™¯ä¹‹ä¸€ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åŸºäº xDS å®ç°&lt;strong>æµé‡è·¯ç”±&lt;/strong>çš„æ–¹æ¡ˆå¤§è‡´å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/2.png" alt="image">&lt;/p>
&lt;p>å…·ä½“æµç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>å¢åŠ ä¸€ä¸ª &lt;strong>xDS Router MW&lt;/strong> æ¥è´Ÿè´£ Pick Clusterï¼ˆè·¯ç”±ï¼‰ï¼Œå¹¶ watch ç›®æ ‡æœåŠ¡çš„ LDS åŠ RDSã€‚&lt;/li>
&lt;li>æ„ŸçŸ¥ LDS å˜åŒ–ï¼Œå¹¶æå–ç›®æ ‡æœåŠ¡çš„ LDS ä¸­çš„ Filter Chain åŠå…¶ inline RDSã€‚&lt;/li>
&lt;li>æ„ŸçŸ¥ RDS å˜åŒ–ï¼Œæ ¹æ® &lt;strong>&lt;code>VirtualHost&lt;/code>&lt;/strong> å’Œ &lt;strong>&lt;code>ServiceName&lt;/code>&lt;/strong> æ¥åŒ¹é…ï¼ˆæ”¯æŒå‰ç¼€ã€åç¼€ã€ç²¾ç¡®ã€é€šé…ï¼‰ï¼Œè·å–ç›®æ ‡æœåŠ¡çš„è·¯ç”±é…ç½®ã€‚&lt;/li>
&lt;li>éå†å¤„ç†åŒ¹é…åˆ°çš„ RDS ä¸­çš„è·¯ç”±è§„åˆ™ï¼Œè·¯ç”±è§„åˆ™ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼ˆå‚è€ƒï¼š&lt;a href="https://github.com/envoyproxy/envoy/blob/v1.13.1/api/envoy/api/v2/route/route_components.proto#L349">è·¯ç”±è§„èŒƒå®šä¹‰&lt;/a>ï¼‰ï¼š&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Match&lt;/strong> ï¼ˆæ”¯æŒå‰ç¼€ã€åç¼€ã€ç²¾ç¡®ã€é€šé…ç­‰ï¼‰ï¼Œç›®å‰ç‰ˆæœ¬æˆ‘ä»¬æ”¯æŒä»¥ä¸‹ä¸¤ç§å³å¯ï¼š&lt;/p>
&lt;ul>
&lt;li>Pathï¼ˆå¿…é¡»é¡¹ï¼‰ï¼šä» &lt;code>rpcinfo&lt;/code> æå– &lt;code>Method&lt;/code> è¿›è¡ŒåŒ¹é…ï¼›&lt;/li>
&lt;li>HeaderMatcherï¼ˆå¯é€‰é¡¹ï¼‰ï¼šä» metainfo ä¸­æå–å¯¹åº”å…ƒæ•°æ® KeyValueï¼Œå¹¶è¿›è¡ŒåŒ¹é…ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Routeï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Cluster&lt;/strong> ï¼šæ ‡å‡† Clusterã€‚&lt;/li>
&lt;li>&lt;strong>WeightedClustersï¼ˆæƒé‡è·¯ç”±ï¼‰&lt;/strong> ï¼šMW å†…æ ¹æ®æƒé‡æ¥é€‰æ‹© clusterã€‚&lt;/li>
&lt;li>å°†é€‰æ‹©åˆ°çš„ Cluster å†™å…¥ &lt;code>EndpointInfo.Tag&lt;/code>ï¼Œç”¨äºä¹‹åçš„æœåŠ¡å‘ç°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæµé‡è·¯ç”±å…¶å®æ˜¯ä¸€ä¸ªæ ¹æ®ä¸€å®šè§„åˆ™é€‰æ‹©å¯¹åº” SubCluster çš„æµç¨‹ã€‚&lt;/p>
&lt;h2 id="02-å…¨é“¾è·¯æ³³é“">02 å…¨é“¾è·¯æ³³é“&lt;/h2>
&lt;p>åŸºäºæµé‡è·¯ç”±èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å»¶ä¼¸å‡ºå¾ˆå¤šä½¿ç”¨åœºæ™¯ï¼Œå¦‚ï¼šA/B æµ‹è¯•ã€é‡‘ä¸é›€å‘å¸ƒã€è“ç»¿å‘å¸ƒç­‰ç­‰ï¼Œä»¥åŠæœ¬æ–‡é‡ç‚¹ï¼š&lt;strong>å…¨é“¾è·¯æ³³é“&lt;/strong>ã€‚&lt;/p>
&lt;p>å…¨é“¾è·¯æ³³é“å¯ä»¥ç†è§£æˆæ˜¯å¯¹ä¸€ç»„æœåŠ¡å®ä¾‹æŒ‰ç…§ä¸€å®šæ–¹å¼è¿›è¡Œæ‹†åˆ†ï¼ˆä¾‹å¦‚éƒ¨ç½²ç¯å¢ƒï¼‰ï¼Œå¹¶åŸºäºå…¨é“¾è·¯ç°åº¦è·¯ç”±èƒ½åŠ›ï¼Œè®©æµé‡èƒ½å¤Ÿç²¾å‡†æŒ‰ç…§è§„åˆ™åœ¨æŒ‡å®šæœåŠ¡å®ä¾‹æ³³é“ä¸­æµåŠ¨ï¼ˆé€»è¾‘ä¸Šå¦‚åŒæ¸¸æ³³åœºä¸­çš„æ³³é“ï¼‰ã€‚&lt;/p>
&lt;p>åœ¨ Istio ä¸­æˆ‘ä»¬ä¸€èˆ¬ä¼šé€šè¿‡ DestinationRule çš„ subset å¯¹å®ä¾‹è¿›è¡Œåˆ†ç»„ï¼Œå°†ä¸€ä¸ªæœåŠ¡æ‹†åˆ†æˆä¸åŒå­é›†ï¼ˆä¾‹å¦‚ï¼šæŒ‰ç…§ç‰ˆæœ¬ã€åŒºåŸŸç­‰å±æ€§æ‹†åˆ†ï¼‰ï¼Œç„¶åé…åˆ VirtualService æ¥å®šä¹‰å¯¹åº”çš„è·¯ç”±è§„åˆ™ï¼Œå°†æµé‡è·¯ç”±åˆ°å¯¹åº”å­é›†ä¸­ï¼Œä»è€Œå®Œæˆæ³³é“ä¸­çš„å•è·³è·¯ç”±èƒ½åŠ›ã€‚&lt;/p>
&lt;p>ä¸è¿‡å•å•åªæœ‰æµé‡è·¯ç”±èƒ½åŠ›ï¼Œè¿˜ä¸è¶³ä»¥å®ç°&lt;strong>å…¨é“¾è·¯æ³³é“&lt;/strong>ï¼Œå› ä¸ºå½“ä¸€ä¸ªè¯·æ±‚è·¨è¶Šå¤šä¸ªæœåŠ¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æœºåˆ¶èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«å‡ºè¯¥æµé‡ï¼Œå¹¶åŸºäºè¿™ä¸ªç‰¹å¾æ¥ä¸ºæ¯ä¸€è·³æµé‡é…ç½®è·¯ç”±è§„åˆ™ã€‚&lt;/p>
&lt;p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‡è®¾æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚èƒ½å¤Ÿç²¾ç¡®ç°åº¦åˆ° service-b çš„ v1 ç‰ˆæœ¬ã€‚æœ€å…ˆæƒ³åˆ°çš„åšæ³•å¯èƒ½æ˜¯æ‰€æœ‰è¯·æ±‚éƒ½å¸¦ä¸Š &lt;code>uid = 100&lt;/code> çš„è¯·æ±‚å¤´ï¼Œç„¶åé…ç½®å¯¹åº” VirtualService æ¥æ ¹æ® header é‡Œçš„ &lt;code>uid = 100&lt;/code> åŒ¹é…ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/3.png" alt="image">&lt;/p>
&lt;p>ä½†è¿™æ ·çš„åšæ³•æœ‰å‡ ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>ä¸å¤Ÿé€šç”¨&lt;/strong>ï¼šä»¥å…·ä½“æŸä¸ªä¸šåŠ¡å±æ€§æ ‡è¯†ï¼ˆå¦‚ï¼šuidï¼‰ä½œä¸ºæµé‡è·¯ç”±åŒ¹é…è§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªä¸šåŠ¡å±æ€§æ‰‹åŠ¨åœ¨å…¨é“¾è·¯é‡Œé€ä¼ ï¼Œè¿™æœ¬èº«å¯¹ä¸šåŠ¡ä¾µå…¥æ€§è¾ƒå¤§ï¼Œéœ€è¦ä¸šåŠ¡é…åˆæ”¹é€ ã€‚å¹¶ä¸”å½“æˆ‘ä»¬è¦ä½¿ç”¨å…¶ä»–ä¸šåŠ¡å±æ€§çš„æ—¶å€™ï¼Œåˆéœ€è¦å…¨é“¾è·¯ä¸šåŠ¡éƒ½æ”¹é€ ä¸€éï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œæ˜¯éå¸¸ä¸é€šç”¨çš„åšæ³•ã€‚&lt;/li>
&lt;li>&lt;strong>è·¯ç”±è§„åˆ™å®¹æ˜“é¢‘ç¹å˜åŠ¨ï¼Œå®¹æ˜“é€ æˆè§„åˆ™è‡ƒè‚¿&lt;/strong>ï¼šä»¥å…·ä½“æŸä¸ªä¸šåŠ¡å±æ€§æ ‡è¯†ï¼ˆå¦‚ï¼šuidï¼‰ä½œä¸ºæµé‡è·¯ç”±åŒ¹é…è§„åˆ™ï¼Œå‡è®¾æˆ‘ä»¬è¦æ¢ä¸€ä¸ªä¸šåŠ¡å±æ€§ï¼Œæˆ–è€…ç»™å…¶ä»–ç”¨æˆ·è®¾ç½®è·¯ç”±è§„åˆ™çš„æ—¶å€™ï¼Œå¾—å»æ”¹é€ åŸæœ‰çš„è·¯ç”±è§„åˆ™ï¼Œæˆ–è€…é’ˆå¯¹ä¸åŒä¸šåŠ¡å±æ€§é‡å¤å®šä¹‰å¤šå¥—è·¯ç”±è§„åˆ™ï¼Œå¾ˆå®¹æ˜“å°±ä¼šé€ æˆè·¯ç”±è‡ƒè‚¿ï¼Œä»¥è‡³äºéš¾ä»¥ç»´æŠ¤ã€‚&lt;/li>
&lt;/ol>
&lt;p>å› æ­¤ï¼Œè¦å®ç°å…¨é“¾è·¯çš„æµé‡è·¯ç”±ç»Ÿä¸€ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é¢å¤–å€ŸåŠ©ä¸€ä¸ªæ›´é€šç”¨çš„&lt;strong>æµé‡æŸ“è‰²&lt;/strong>ä¸&lt;strong>æŸ“è‰²æ ‡è¯†å…¨é“¾è·¯é€ä¼ &lt;/strong>èƒ½åŠ›ã€‚&lt;/p>
&lt;h3 id="æµé‡æŸ“è‰²">æµé‡æŸ“è‰²&lt;/h3>
&lt;blockquote>
&lt;p>æµé‡æŸ“è‰²æ˜¯æŒ‡å¯¹è¯·æ±‚æµé‡æ‰“ä¸Šç‰¹æ®Šæ ‡è¯†ï¼Œå¹¶åœ¨æ•´ä¸ªè¯·æ±‚é“¾è·¯ä¸­æºå¸¦è¿™ä¸ªæ ‡è¯†ï¼Œè€Œæ‰€è°“çš„å…¨é“¾è·¯æ³³é“ï¼Œå°±æ˜¯æ•´ä¸ªé“¾è·¯åŸºäºç»Ÿä¸€çš„ç°åº¦æµé‡æŸ“è‰²æ ‡è¯†æ¥è®¾ç½®æµé‡è·¯ç”±è§„åˆ™ï¼Œä½¿å¾—æµé‡èƒ½å¤Ÿç²¾å‡†æ§åˆ¶åœ¨ä¸åŒæ³³é“ä¸­ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>é€šå¸¸æˆ‘ä»¬ä¼šåœ¨ç½‘å…³å±‚è¿›è¡Œæµé‡æŸ“è‰²ï¼Œé€šå¸¸ä¼šæ ¹æ®åŸå§‹è¯·æ±‚ä¸­çš„å…ƒæ•°æ®ï¼Œæ¥è¿›è¡Œä¸€å®šè§„åˆ™ï¼ˆæ¡ä»¶ã€æ¯”ä¾‹ï¼‰è½¬æ¢æˆå¯¹åº”çš„æŸ“è‰²æ ‡è¯†ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æŒ‰æ¡ä»¶æŸ“è‰²&lt;/strong>ï¼šå½“è¯·æ±‚å…ƒæ•°æ®æ»¡è¶³ä¸€å®šæ¡ä»¶ä¹‹åï¼Œå°±ç»™å½“å‰è¯·æ±‚æ‰“ä¸ŠæŸ“è‰²æ ‡è¯†ï¼Œå¦‚ï¼šè¯·æ±‚å¤´ä¸­ &lt;code>uid = 100&lt;/code>ã€cookie åŒ¹é…ç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>æŒ‰æ¯”ä¾‹æŸ“è‰²&lt;/strong>ï¼šæŒ‰ç…§ä¸€å®šæ¯”ä¾‹ï¼Œç»™è¯·æ±‚æ‰“ä¸ŠæŸ“è‰²æ ‡è¯†ã€‚&lt;/li>
&lt;/ul>
&lt;p>æœ‰äº†ä¸€å¥—ç»Ÿä¸€çš„æµé‡æŸ“è‰²æœºåˆ¶ä¹‹åï¼Œæˆ‘ä»¬é…ç½®è·¯ç”±è§„åˆ™çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦å…³å¿ƒå…·ä½“çš„ä¸šåŠ¡å±æ€§æ ‡è¯†äº†ï¼Œåªéœ€è¦æ ¹æ®&lt;strong>æŸ“è‰²æ ‡è¯†&lt;/strong>æ¥é…ç½®å³å¯ã€‚&lt;/p>
&lt;p>å°†å…·ä½“çš„ä¸šåŠ¡å±æ€§æŠ½è±¡æˆæ¡ä»¶æŸ“è‰²è§„åˆ™ï¼Œä½¿å…¶æ›´é€šç”¨ï¼Œå³ä½¿ä¸šåŠ¡å±æ€§å‘ç”Ÿäº†å˜åŒ–ï¼Œè·¯ç”±è§„åˆ™ä¹Ÿæ— éœ€å†é¢‘ç¹å˜åŠ¨äº†ã€‚&lt;/p>
&lt;h3 id="æŸ“è‰²æ ‡è¯†å…¨é“¾è·¯é€ä¼ ">æŸ“è‰²æ ‡è¯†å…¨é“¾è·¯é€ä¼ &lt;/h3>
&lt;blockquote>
&lt;p>æŸ“è‰²æ ‡è¯†é€šå¸¸ä¼šä¾é  Tracing Baggage æ¥é€ä¼ ï¼ŒBaggage æ˜¯ç”¨äºåœ¨æ•´ä¸ªé“¾è·¯ä¸­ä¼ é€’ä¸šåŠ¡è‡ªå®šä¹‰ KV å±æ€§ï¼Œä¾‹å¦‚ä¼ é€’æµé‡æŸ“è‰²æ ‡è¯†ã€ä¼ é€’ AccountID ç­‰ä¸šåŠ¡æ ‡è¯†ç­‰ç­‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/4.png" alt="image">&lt;/p>
&lt;p>è¦å®ç°æµé‡æŸ“è‰²æ ‡è¯†åœ¨å…¨é“¾è·¯é€ä¼ ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå€ŸåŠ© Tracing Baggage æœºåˆ¶ï¼Œåœ¨å…¨é“¾è·¯ä¸­ä¼ é€’å¯¹åº”æŸ“è‰²æ ‡è¯†ï¼Œå¤§éƒ¨åˆ† Tracing æ¡†æ¶éƒ½æ”¯æŒ Baggage æ¦‚å¿µæœºèƒ½åŠ›ï¼Œå¦‚ï¼šOpenTelemetryã€Skywalkingã€Jaeger ç­‰ç­‰ã€‚&lt;/p>
&lt;p>æœ‰äº†ä¸€å¥—é€šç”¨çš„å…¨é“¾è·¯é€ä¼ æœºåˆ¶ï¼Œä¸šåŠ¡æ–¹å°±åªéœ€è¦æ¥å…¥ä¸€é tracing å³å¯ï¼Œæ— éœ€æ¯æ¬¡ä¸šåŠ¡å±æ€§æ ‡è¯†å‘ç”Ÿå˜åŒ–å°±é…åˆæ”¹é€ ä¸€æ¬¡ã€‚&lt;/p>
&lt;p>ä¸‹é¢ä¼šå€ŸåŠ©ä¸€ä¸ª&lt;strong>å…·ä½“çš„å·¥ç¨‹æ¡ˆä¾‹&lt;/strong>ä»‹ç»ï¼Œæ¥ä»‹ç»å¹¶æ¼”ç¤ºå¦‚ä½•åŸºäº &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Proxyless å’Œ OpenTelemetry Baggage å®ç°å…¨é“¾è·¯æ³³é“åŠŸèƒ½ã€‚&lt;/p>
&lt;h2 id="03-æ¡ˆä¾‹ä»‹ç»bookinfo">03 æ¡ˆä¾‹ä»‹ç»ï¼šBookinfo&lt;/h2>
&lt;blockquote>
&lt;p>è¯¥æ¡ˆä¾‹æ˜¯ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/hertz">Hertz&lt;/a>ã€&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> é‡å†™ç»å…¸çš„ &lt;a href="https://istio.io/latest/zh/docs/examples/bookinfo/">Istio Bookinfo&lt;/a> é¡¹ç›®ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ istiod æ¥ä½œä¸º &lt;strong>xDS server&lt;/strong>ï¼Œä½œä¸º CRD é…ç½®å’Œä¸‹å‘çš„å…¥å£ï¼›&lt;/li>
&lt;li>ä½¿ç”¨ wire æ¥å®ç°&lt;strong>ä¾èµ–æ³¨å…¥&lt;/strong>ï¼›&lt;/li>
&lt;li>ä½¿ç”¨ opentelemetry æ¥å®ç°&lt;strong>å…¨é“¾è·¯è¿½è¸ª&lt;/strong>ï¼›&lt;/li>
&lt;li>ä½¿ç”¨ &lt;a href="https://github.com/kitex-contrib/xds">Kitex-xds&lt;/a> å’Œ opentelemetry baggage æ¥å®ç° &lt;strong>proxyless&lt;/strong> æ¨¡å¼ä¸‹çš„å…¨é“¾è·¯æ³³é“;&lt;/li>
&lt;li>ä½¿ç”¨ arco-design å’Œ react å®ç°ä¸€ä¸ª &lt;strong>&lt;a href="https://github.com/cloudwego/biz-demo/blob/main/bookinfo/README_CN.md">Bookinfo&lt;/a> UI&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h3 id="æ¶æ„">æ¶æ„&lt;/h3>
&lt;p>æ•´ä½“æ¶æ„ä¸ &lt;a href="https://github.com/cloudwego/biz-demo/blob/main/bookinfo/README_CN.md">Bookinfo&lt;/a> ä¿æŒä¸€è‡´ï¼Œåˆ†ä¸ºå››ä¸ªå•ç‹¬çš„å¾®æœåŠ¡ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>productpage.&lt;/code> è¿™ä¸ªå¾®æœåŠ¡ä¼šè°ƒ &lt;code>details&lt;/code> å’Œ &lt;code>reviews&lt;/code> ä¸¤ä¸ªå¾®æœåŠ¡ï¼›&lt;/li>
&lt;li>&lt;code>details.&lt;/code> è¿™ä¸ªå¾®æœåŠ¡ä¸­åŒ…å«äº†ä¹¦ç±çš„ä¿¡æ¯ï¼›&lt;/li>
&lt;li>&lt;code>reviews.&lt;/code> è¿™ä¸ªå¾®æœåŠ¡ä¸­åŒ…å«äº†ä¹¦ç±ç›¸å…³çš„è¯„è®ºã€‚å®ƒè¿˜ä¼šè°ƒç”¨ &lt;code>ratings&lt;/code> å¾®æœåŠ¡ï¼›&lt;/li>
&lt;li>&lt;code>ratings.&lt;/code> è¿™ä¸ªå¾®æœåŠ¡ä¸­åŒ…å«äº†ç”±ä¹¦ç±è¯„ä»·ç»„æˆçš„è¯„çº§ä¿¡æ¯ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;code>reviews&lt;/code> å¾®æœåŠ¡æœ‰ 3 ä¸ªç‰ˆæœ¬ï¼š&lt;/p>
&lt;ul>
&lt;li>v1 ç‰ˆæœ¬ä¼šè°ƒç”¨ &lt;code>ratings&lt;/code> æœåŠ¡ï¼Œå¹¶ä½¿ç”¨ 1 é¢— â­ï¸ æ˜¾ç¤ºè¯„åˆ†ï¼›&lt;/li>
&lt;li>v2 ç‰ˆæœ¬ä¼šè°ƒç”¨ &lt;code>ratings&lt;/code> æœåŠ¡ï¼Œå¹¶ä½¿ç”¨ 5 é¢— â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ æ˜¾ç¤ºè¯„åˆ†ï¼›&lt;/li>
&lt;li>v3 ç‰ˆæœ¬ä¸ä¼šè°ƒç”¨ &lt;code>ratings&lt;/code> æœåŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/5.png" alt="image">&lt;/p>
&lt;h3 id="æ³³é“ç¤ºæ„å›¾">æ³³é“ç¤ºæ„å›¾&lt;/h3>
&lt;p>æ•´ä½“åŒºåˆ†æˆ 2 ä¸ªæ³³é“ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŸºå‡†æ³³é“&lt;/strong>ï¼šæœªè¢«æŸ“è‰²çš„æµé‡ä¼šè¢«è·¯ç”±åˆ°åŸºå‡†æ³³é“ä¸­ã€‚&lt;/li>
&lt;li>&lt;strong>åˆ†æ”¯æ³³é“&lt;/strong>ï¼šè¢«æŸ“è‰²çš„æµé‡ä¼šè¢«è·¯ç”±åˆ° reviews-v2 -&amp;gt;ratings-v2 çš„åˆ†æ”¯æ³³é“ä¸­ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/6.png" alt="image">&lt;/p>
&lt;h3 id="æµé‡æŸ“è‰²-1">æµé‡æŸ“è‰²&lt;/h3>
&lt;p>ç½‘å…³ç»Ÿä¸€è´Ÿè´£å¯¹æµé‡è¿›è¡ŒæŸ“è‰²ï¼Œä¾‹å¦‚è¯·æ±‚ header ä¸­ uid=100 çš„æµé‡éƒ½ç»Ÿä¸€è¿›è¡ŒæŸ“è‰²ï¼Œä¸ºè¯·æ±‚æºå¸¦ä¸Š &lt;code>env=dev&lt;/code> çš„ &lt;strong>baggage&lt;/strong>ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/7.png" alt="image">&lt;/p>
&lt;p>æŸ“è‰²æ–¹å¼å¯ä»¥æ ¹æ®ä¸åŒçš„ç½‘å…³å®ç°å…·ä½“é€‰æ‹©ï¼Œä¾‹å¦‚å½“æˆ‘ä»¬é€‰æ‹© istio ingress ä½œä¸ºç½‘å…³çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© &lt;code>EnvoyFilter&lt;/code> + &lt;code>Lua&lt;/code> çš„æ–¹å¼æ¥ç¼–å†™ç½‘å…³æŸ“è‰²è§„åˆ™ã€‚&lt;/p>
&lt;h3 id="ä¸ºæœåŠ¡å®ä¾‹æ‰“æ ‡">ä¸ºæœåŠ¡å®ä¾‹æ‰“æ ‡&lt;/h3>
&lt;ol>
&lt;li>ä¸ºå¯¹åº” &lt;strong>workload&lt;/strong> æ‰“ä¸Šå¯¹åº” version æ ‡è¯†ã€‚&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>ä»¥ reviews ä¸ºä¾‹ï¼Œåªéœ€è¦ç»™å¯¹åº” pod æ‰“ä¸Š version: v1 çš„ label å³å¯ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/8.png" alt="image">&lt;/p>
&lt;ol start="2">
&lt;li>åŸºäº &lt;strong>DestinationRule&lt;/strong> ä¸ºæœåŠ¡è®¾ç½®ä¸€ç³»åˆ—çš„ subsetsï¼š&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;ul>
&lt;li>Productpage: v1&lt;/li>
&lt;li>Reviews: v1ã€v2ã€v3&lt;/li>
&lt;li>Ratings: v1ã€v2&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/9.png" alt="image">&lt;/p>
&lt;h3 id="æµé‡è·¯ç”±è§„åˆ™">æµé‡è·¯ç”±è§„åˆ™&lt;/h3>
&lt;p>ç½‘å…³å·²ç»å°†è¯·æ±‚å¤´ä¸­æºå¸¦äº† &lt;code>uid=100&lt;/code> çš„æµé‡è¿›è¡Œäº†æŸ“è‰²ï¼Œè‡ªåŠ¨å¸¦ä¸Šäº† &lt;code>env=dev&lt;/code> çš„ baggageï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ ¹æ® header è¿›è¡Œè·¯ç”±åŒ¹é…å³å¯ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„è·¯ç”±è§„åˆ™é…ç½®ç¤ºä¾‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/10.png" alt="image">&lt;/p>
&lt;h3 id="æŸ¥çœ‹æ•ˆæœ">æŸ¥çœ‹æ•ˆæœ&lt;/h3>
&lt;h4 id="åŸºå‡†æ³³é“">åŸºå‡†æ³³é“&lt;/h4>
&lt;p>å…¥å£æµé‡è¯·æ±‚å¤´ä¸­ä¸å¸¦ &lt;code>uid=100&lt;/code> çš„è¯·æ±‚ï¼Œä¼šè‡ªåŠ¨è·¯ç”±åˆ°åŸºå‡†æ³³é“æœåŠ¡ï¼Œreviews v1 å’Œ v3 æœåŠ¡é—´è½®è¯¢ï¼Œå±•ç¤ºçš„æ•ˆæœæ˜¯è¯„åˆ†ä¸º 0 æˆ– 1 éšæœºã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/11.png" alt="image">&lt;/p>
&lt;h4 id="åˆ†æ”¯æ³³é“">åˆ†æ”¯æ³³é“&lt;/h4>
&lt;ol>
&lt;li>æˆ‘ä»¬è¿™è¾¹é€šè¿‡æµè§ˆå™¨ mod-header æ’ä»¶ï¼Œæ¥æ¨¡æ‹Ÿå…¥å£æµé‡è¯·æ±‚å¤´ä¸­æºå¸¦äº† &lt;code>uid=100&lt;/code> çš„åœºæ™¯ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/12.png" alt="image">&lt;/p>
&lt;ol start="2">
&lt;li>å†ç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œå¯ä»¥å‘ç°è¯·æ±‚æ‰“åˆ°äº†åˆ†æ”¯æ³³é“ï¼Œæµé‡æ³³é“åŠŸèƒ½æˆåŠŸç”Ÿæ•ˆã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Kitex_Proxyless/13.png" alt="image">&lt;/p>
&lt;h2 id="04-æ€»ç»“ä¸å±•æœ›">04 æ€»ç»“ä¸å±•æœ›&lt;/h2>
&lt;p>è‡³æ­¤æˆ‘ä»¬å·²ç»åŸºäº &lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Proxyless&lt;/strong> ä¸ &lt;strong>OpenTelemetry&lt;/strong> å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„å…¨é“¾è·¯æ³³é“ï¼Œå¹¶ä¸”æ— éœ€å€ŸåŠ© Envoy sidecarï¼Œå°±èƒ½åŸºäº Isito æ ‡å‡†æ²»ç†è§„åˆ™ Specï¼Œæ¥ä¸º Kitex è®¾ç½®å¯¹åº”çš„è·¯ç”±è§„åˆ™äº†ã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œé™¤äº†æ»¡è¶³&lt;strong>æµé‡è·¯ç”±&lt;/strong>èƒ½åŠ›ä¹‹å¤–ï¼Œ&lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Proxyless&lt;/strong> ä¹Ÿåœ¨æŒç»­è¿­ä»£ä¼˜åŒ–ï¼Œæ»¡è¶³æ›´å¤šæ•°æ®é¢æ²»ç†èƒ½åŠ›éœ€æ±‚ã€‚Proxyless ä½œä¸ºä¸€ç§ ServiceMesh æ•°æ®é¢æ¢ç´¢å’Œå®è·µï¼Œé™¤äº†èƒ½å¤Ÿä¸°å¯Œç½‘æ ¼æ•°æ®é¢éƒ¨ç½²å½¢æ€ä¹‹å¤–ï¼Œä¹Ÿå¸Œæœ›å¯ä»¥ä¸æ–­æ‰“ç£¨ &lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>&lt;/strong>ï¼Œå¢å¼ºå…¶åœ¨å¼€æºç”Ÿæ€å…¼å®¹æ–¹é¢çš„èƒ½åŠ›ï¼Œæ‰“é€ ä¸€ä¸ªå¼€æ”¾åŒ…å®¹çš„å¾®æœåŠ¡ç”Ÿæ€ä½“ç³»ã€‚&lt;/p>
&lt;h2 id="05-ç›¸å…³é¡¹ç›®é“¾æ¥">05 ç›¸å…³é¡¹ç›®é“¾æ¥&lt;/h2>
&lt;p>ä¸‹é¢æ˜¯è¯¥æ¡ˆä¾‹æ¶‰åŠçš„é¡¹ç›®æ¸…å•ï¼š&lt;/p>
&lt;ul>
&lt;li>biz-demo: &lt;a href="https://github.com/cloudwego/biz-demo">https://github.com/cloudwego/biz-demo&lt;/a>&lt;/li>
&lt;li>kitex: &lt;a href="https://github.com/cloudwego/kitex">https://github.com/cloudwego/kitex&lt;/a>&lt;/li>
&lt;li>hertz: &lt;a href="https://github.com/cloudwego/hertz">https://github.com/cloudwego/hertz&lt;/a>&lt;/li>
&lt;li>kitex-xds: &lt;a href="https://github.com/kitex-contrib/xds">https://github.com/kitex-contrib/xds&lt;/a>&lt;/li>
&lt;li>kitex-opentelemetry: &lt;a href="https://github.com/kitex-contrib/obs-opentelemetry">https://github.com/kitex-contrib/obs-opentelemetry&lt;/a>&lt;/li>
&lt;li>hertz-opentelemetry: &lt;a href="https://github.com/hertz-contrib/obs-opentelemetry">https://github.com/hertz-contrib/obs-opentelemetry&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>è¯¥å®Œæ•´æ¡ˆä¾‹å·²æäº¤åœ¨ &lt;a href="https://github.com/cloudwego/biz-demo">biz-demo&lt;/a> ä»“åº“ä¸­ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‰å¾€æŸ¥é˜…ã€‚&lt;a href="https://github.com/cloudwego/biz-demo">biz-demo&lt;/a> ä¼šåŒ…å«ä¸€äº›åŸºäº &lt;a href="https://github.com/cloudwego">CloudWeGo&lt;/a> æŠ€æœ¯æ ˆä¸”å…·å¤‡ä¸€å®šä¸šåŠ¡åœºæ™¯çš„å®Œæ•´ Demoï¼Œåˆè¡·æ˜¯èƒ½å¤Ÿä¸ºä¼ä¸šç”¨æˆ·åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨æä¾›æœ‰ä»·å€¼çš„å‚è€ƒï¼Œéå¸¸æ¬¢è¿æ›´å¤šåŒå­¦èƒ½å¤Ÿå‚ä¸åˆ° &lt;a href="https://github.com/cloudwego">CloudWeGo&lt;/a> ç›¸å…³åœºæ™¯ä¸æ¡ˆä¾‹çš„è´¡çŒ®ä¸­æ¥ï¼Œä¸€èµ·æ¥åšä¸€äº›æœ‰æ„æ€çš„å°è¯•ã€‚&lt;/p></description></item><item><title>Blog: Kitex v0.4.3 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/11/02/kitex-v0.4.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Wed, 02 Nov 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/11/02/kitex-v0.4.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>æ‰©å±• client/server ç”Ÿæˆæ¨¡æ¿&lt;/strong> ï¼šæ–°å¢ client/server æ¨¡æ¿æ‰©å±•åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡é…ç½®å®šåˆ¶ï¼Œé€‚ç”¨äºç»Ÿä¸€å®šåˆ¶ suite åœºæ™¯ï¼Œè¯¦è§&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/template_extension/">æ‰©å±• Service ä»£ç ç”Ÿæˆæ¨¡æ¿&lt;/a>ã€‚&lt;/li>
&lt;li>&lt;strong>ä¸šåŠ¡å¼‚å¸¸&lt;/strong> ï¼šæ–°å¢ä¸šåŠ¡è‡ªå®šä¹‰å¼‚å¸¸æ”¯æŒï¼Œå¯åŒºåˆ†äº RPC å¼‚å¸¸è¿”å› errorï¼Œä½¿ç”¨è¯¦è§&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/basic-feature/bizstatuserr/">ä¸šåŠ¡å¼‚å¸¸&lt;/a>ï¼ŒèƒŒæ™¯è¯¦è§&lt;a href="https://github.com/cloudwego/kitex/issues/511">Proposal&lt;/a>ã€‚&lt;/li>
&lt;li>&lt;strong>è¯·æ±‚ Profiler&lt;/strong> ï¼šæ–°å¢åŠŸèƒ½å¯ç”¨äºä¸ºä¸åŒçš„ RPC è¯·æ±‚æä¾›æˆæœ¬åˆ†æç»Ÿè®¡çš„èƒ½åŠ›ã€‚&lt;/li>
&lt;li>&lt;strong>Context Middleware&lt;/strong> : æ–°å¢ Context Middlewareï¼Œç”¨äºè¯·æ±‚ç²’åº¦æ·»åŠ  Middlewareã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>Frugal æ€§èƒ½ä¼˜åŒ–&lt;/strong> ï¼šæ”¯æŒåœ¨åˆ›å»º Client/Server é˜¶æ®µè¿›è¡Œ Frugal â€œé¢„ç¼–è¯‘â€ï¼Œå‡å°‘åŠ¨æ€ç¼–è¯‘å¯¹å»¶è¿Ÿçš„å½±å“ã€‚&lt;/li>
&lt;li>&lt;strong>è¿æ¥æ± ä¼˜åŒ–&lt;/strong> ï¼šé‡æ„è¿æ¥æ± ï¼Œå®Œå–„ç©ºé—²è¿æ¥æ¸…ç†èƒ½åŠ›ã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h3 id="feature">Feature&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/691">#691&lt;/a>] feat(client): ä¸º Client æ·»åŠ ä¸Šä¸‹æ–‡ä¸­é—´ä»¶ï¼Œç”¨äºè¯·æ±‚ç²’åº¦æ·»åŠ ä¸­é—´ä»¶ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/649">#649&lt;/a>] feat(connpool): é•¿è¿æ¥æ± çš„æ–°å®ç°ï¼Œæ”¯æŒæœ€å°ç©ºé—²è¿æ¥æ•°åŠç©ºé—²è¿æ¥æ¸…ç†ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/672">#672&lt;/a>] feat(grpc): ä¸º kitex grpc æ·»åŠ äº†å…ƒä¿¡æ¯ä¼ é€’ç›¸å…³ apiï¼ŒåŒ…æ‹¬ headerï¼Œtailerï¼Œä»¥åŠ peer è¿œç«¯åœ°å€çš„è·å–æ¥å£ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/613">#613&lt;/a>] feat(exception): æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸ç”¨ä»¥åŒºåˆ† RPC å¼‚å¸¸ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/670">#670&lt;/a>] feat(exception): æ”¯æŒ DetailError æ ¼å¼åŒ–ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/678">#678&lt;/a>] feat(tool): ä¸º kitex cmd æ·»åŠ  git å’Œ record å‚æ•°ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/662">#662&lt;/a>] feat(tool): æ”¯æŒåœ¨åˆ›å»º client æˆ–è€… server çš„æ—¶å€™è¿›è¡Œ frugal â€œé¢„ç¼–è¯‘â€ (pretouch)ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/657">#657&lt;/a>] feat(tool): æ”¯æŒæ¨¡æ¿æ‹“å±•ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/527">#527&lt;/a>] feat(profiler): ä¸ºä¸åŒçš„ RPC è¯·æ±‚æä¾›æˆæœ¬åˆ†æç»Ÿè®¡çš„èƒ½åŠ›ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="optimize">Optimize&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/690">#690&lt;/a>] optimize(meta): ç§»é™¤ #503 æ·»åŠ  default metahandler çš„é”™è¯¯é€»è¾‘ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/638">#638&lt;/a>] optimize(generic): httppb æ³›åŒ–æ”¯æŒ map/list å…ƒç´ ç±»å‹ä¸º structã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/641">#641&lt;/a>] optimize(tool): ç»™ oneway æ–¹æ³•å¢åŠ è­¦å‘Šæ³¨é‡Šã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="fix">Fix&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/611">#611&lt;/a>] fix(client): åœ¨é¢‘ç¹é‡å¤åˆ›å»º Client åœºæ™¯ä¸‹ï¼Œä¿®å¤ç”±äº finalizer æœªè§¦å‘æ‰§è¡Œå¯¼è‡´çš„èµ„æºæ³„æ¼ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/698">#698&lt;/a>] fix(connpool): æ ¹æ® Get è¿”å›çš„è¿æ¥æ•°å‡å°‘å€¼æ¥è°ƒæ•´ globalIdleã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/636">#636&lt;/a>] fix(connpool): ä¿®å¤å½“è¿æ¥æ± åœ¨ &lt;code>ForwardProxy&lt;/code> å®ç°ä¸­è¢«é‡ç½®åï¼Œè¿æ¥æ± çš„ CloseCallbackã€ç»Ÿè®¡ä¸ŠæŠ¥å¤±æ•ˆçš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/647">#647&lt;/a>] fix(grpc): ä¿®å¤ grpc è¿æ¥çº§åˆ«çª—å£åˆå§‹åŒ–æ—¶æ²¡æœ‰é€šçŸ¥å¯¹ç«¯çš„é—®é¢˜ï¼Œå¹¶åŒæ­¥äº† grpc pr #5459ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/639">#639&lt;/a>] fix(generic): æ³›åŒ–è°ƒç”¨æ”¯æŒ list&lt;byte> ç±»å‹ï¼Œmap è¯»æ³›åŒ–å¢åŠ  forJSON é€‰é¡¹ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/655">#655&lt;/a>] fix(generic): æ•°å€¼å‹å¸¸é‡ä½œä¸ºæ³›åŒ–é»˜è®¤å€¼æ—¶æ— æ³•è¢«æ­£ç¡®è§£æã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/654">#654&lt;/a>] fix(frugal): ä¿®å¤è¾ƒä½ç‰ˆæœ¬ go ç¼–è¯‘å¤±è´¥çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/682">#682&lt;/a>] fix(profiler): ä¿®å¤ profiler åœæ­¢ pprof profile é‡‡é›†çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/637">#637&lt;/a>] fix(tool): ä¿®å¤ handler.go æ¨¡æ¿é‡Œçš„ importsã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/630">#630&lt;/a>] fix(tool): å¯¹äºæ²¡æœ‰å£°æ˜ â€œserviceâ€ çš„ pb æ–‡ä»¶ï¼Œå»æ‰ç”Ÿæˆæ–‡ä»¶æœ«å°¾å†—ä½™çš„ kitex å£°æ˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/627">#627&lt;/a>] fix(tool): ä¿®å¤å½“ä¸€ä¸ª import æ‹¥æœ‰ä¸åŒçš„åˆ«åæ—¶ import ä¼šä¸¢å¤±çš„é—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="refactor">Refactor&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/651">#651&lt;/a>] refactor(server): é‡æ„ server trans handler çš„ read/write æ¥å£ï¼Œè¿”å›æ–°çš„ contextã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="docs">Docs&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/656">#656&lt;/a>] docs: åˆ é™¤ CONTRIBUTING æ–‡æ¡£ä¸­çš„é”™è¯¯ä¿¡æ¯ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/683">#683&lt;/a>] docs(kerrors): ä¿®æ”¹äº† kerrors WithCauseAndExtraMsg æ–¹æ³•æ³¨é‡Šã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/625">#625&lt;/a>] chore: ä¿®æ­£ pull request æ¨¡æ¿çš„è¯­æ³•é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/623">#623&lt;/a>] chore: ä¿®æ”¹ pull request æ¨¡æ¿ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="test--ci">Test &amp;amp; CI&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/646">#646&lt;/a>] test: ä¿®å¤ InitRPCInfoFunc æœªè®¾ç½® rpcinfo å¯¼è‡´çš„å•æµ‹å¤±è´¥ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/680">#680&lt;/a>] test: ä¿®å¤é‡è¯•å•æµ‹çš„ race é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/661">#661&lt;/a>] test: å¢å¼º wpool æµ‹è¯•ç¨³å®šæ€§ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/643">#643&lt;/a>] test: ä¸º detection server handler æ·»åŠ æµ‹è¯•ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/632">#632&lt;/a>] test: ç”¨ gomock è‡ªåŠ¨ç”Ÿæˆç±»æ›¿æ¢æ‰‹åŠ¨ç¼–å†™çš„ mock ç±»ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/697">#697&lt;/a>] chore(ci): å›ºå®š skywalking-eyes ç‰ˆæœ¬å·ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/652">#652&lt;/a>] chore(ci): åˆ é™¤é‡å¤çš„æµ‹è¯•ï¼Œä»¥å‡å°‘å•æµ‹æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/588">#588&lt;/a>] chore(ci): æ”¯æŒ codecovã€‚&lt;/li>
&lt;/ul></description></item><item><title>Blog: é«˜æ€§èƒ½ RPC æ¡†æ¶ CloudWeGo-Kitex å†…å¤–ç»Ÿä¸€çš„å¼€æºå®è·µ</title><link>https://www.cloudwego.io/zh/blog/2022/09/20/%E9%AB%98%E6%80%A7%E8%83%BD-rpc-%E6%A1%86%E6%9E%B6-cloudwego-kitex-%E5%86%85%E5%A4%96%E7%BB%9F%E4%B8%80%E7%9A%84%E5%BC%80%E6%BA%90%E5%AE%9E%E8%B7%B5/</link><pubDate>Tue, 20 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/09/20/%E9%AB%98%E6%80%A7%E8%83%BD-rpc-%E6%A1%86%E6%9E%B6-cloudwego-kitex-%E5%86%85%E5%A4%96%E7%BB%9F%E4%B8%80%E7%9A%84%E5%BC%80%E6%BA%90%E5%AE%9E%E8%B7%B5/</guid><description>
&lt;h2 id="ç”±å†…è‡³å¤–---å¼€æºè¿‡æ¸¡">ç”±å†…è‡³å¤– - å¼€æºè¿‡æ¸¡&lt;/h2>
&lt;p>å¾ˆå¤šåŒå­¦å¯èƒ½åˆšåˆšäº†è§£ CloudWeGoï¼Œå…ˆä»‹ç»ä¸€ä¸‹ CloudWeGo å’Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å…³ç³»ã€‚&lt;/p>
&lt;h3 id="cloudwego-å’Œ-kitex">CloudWeGo å’Œ Kitex&lt;/h3>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ˜¯ CloudWeGo å¼€æºçš„ç¬¬ä¸€ä¸ªå¾®æœåŠ¡æ¡†æ¶ï¼Œå®ƒæ˜¯ä¸€ä¸ª &lt;strong>æ”¯æŒå¤šåè®®çš„ Golang RPC æ¡†æ¶&lt;/strong> ï¼Œä»ç½‘ç»œåº“ã€åºåˆ—åŒ–åº“åˆ°æ¡†æ¶çš„å®ç°&lt;strong>åŸºæœ¬å®Œå…¨è‡ªç ”&lt;/strong>çš„ã€‚
ç‰¹åˆ«åœ°ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¯¹ gRPC åè®®çš„æ”¯æŒä½¿ç”¨äº† gRPC å®˜æ–¹çš„æºç ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹ gRPC çš„å®ç°åšäº† &lt;strong>æ·±åº¦ä¸”å®šåˆ¶çš„ä¼˜åŒ–&lt;/strong> ï¼Œæ‰€ä»¥ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ”¯æŒçš„ gRPC åè®®æ€§èƒ½ä¼˜äº gRPC å®˜æ–¹æ¡†æ¶ã€‚
åŒæ—¶è¿™ä¹Ÿæ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸ç›®å‰å·²ç»å¼€æºçš„ã€æ”¯æŒ gRPC åè®®çš„å…¶ä»– Golang æ¡†æ¶çš„ä¸»è¦å·®å¼‚ã€‚å¦‚æœç”¨æˆ·æƒ³ä½¿ç”¨ gRPC åˆå¯¹æ€§èƒ½æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œé‚£ä¹ˆ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ¡†æ¶å°†ä¼šæ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„é€‰æ‹©ã€‚&lt;/p>
&lt;p>ç»§ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¼€æºåï¼Œä»Šå¹´ CloudWeGo åˆé™†ç»­å¼€æºäº† Golang HTTP æ¡†æ¶ &lt;a href="https://github.com/cloudwego/hertz">Hertz&lt;/a>ï¼ŒRust RPC æ¡†æ¶ &lt;a href="https://github.com/cloudwego/volo">Volo&lt;/a>ï¼ŒåŒæ—¶å›´ç»•è¿™äº›å¾®æœåŠ¡æ¡†æ¶å’Œå¾®æœåŠ¡çš„ä¸€äº›é€šç”¨èƒ½åŠ›ï¼Œ
æˆ‘ä»¬è¿˜å¼€æºäº†ä¸€äº›é«˜æ€§èƒ½çš„åŸºç¡€åº“ã€‚å…³äºæ›´å¤š CloudWeGo å¼€æºçš„å­é¡¹ç›®ï¼Œå¯ä»¥è¿›å…¥ CloudWeGo &lt;a href="https://www.cloudwego.io/zh/">å®˜ç½‘&lt;/a>è¯¦ç»†äº†è§£ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.cloudwego.io/zh/">CloudWeGo å®˜ç½‘&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/1.png" alt="image">&lt;/p>
&lt;p>æ ¹æ®ç¤¾åŒºåŒå­¦åé¦ˆï¼Œåœ¨ä¸€äº›å¼€æºç¾¤é‡Œå¤§å®¶ä¼šè®¨è®º &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¼šä¸ä¼šæ˜¯ä¸€ä¸ªå­—èŠ‚è·³åŠ¨çš„å¼€æº KPI é¡¹ç›®å‘¢ï¼Ÿå®ƒçš„ç¨³å®šæ€§ã€æŒç»­æ€§èƒ½å¤Ÿå¾—åˆ°ä¿éšœå—ï¼Ÿæˆ‘å¯ä»¥è´Ÿè´£ä»»åœ°è®²ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸æ˜¯ä¸€ä¸ª KPI é¡¹ç›®ï¼Œå®ƒæ˜¯æ¥è‡ªå­—èŠ‚è·³åŠ¨å†…éƒ¨å¤§è§„æ¨¡å®è·µçš„çœŸå®é¡¹ç›®ã€‚
åœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¼€æºåå§‹ç»ˆä¿æŒå†…å¤–ç»Ÿä¸€ï¼ŒåŸºäºå†…å¤–ä»£ç çš„ç»Ÿä¸€æˆ‘ä»¬ä¿è¯äº† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æŒç»­è¿­ä»£ã€‚ä¸ºäº†è¿›ä¸€æ­¥æ¶ˆé™¤å¤§å®¶çš„é¡¾è™‘ï¼Œä¸‹é¢å…·ä½“ä»‹ç»ä¸€ä¸‹ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„è¯ç”Ÿå’Œå¼€æºå†ç¨‹ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/2.png" alt="image">&lt;/p>
&lt;h3 id="kitex-å‘å±•å†å²">Kitex å‘å±•å†å²&lt;/h3>
&lt;p>2014 å¹´ï¼Œå­—èŠ‚è·³åŠ¨å¼€å§‹å¼•å…¥ Golangã€‚2015 å¹´ï¼Œå­—èŠ‚è·³åŠ¨å†…éƒ¨çš„æœåŠ¡åŒ–å¼€å¯ã€‚åœ¨ RPC è°ƒç”¨çš„åœºæ™¯é€‰æ‹©äº† Thrift åè®®ï¼Œåœ¨å†…éƒ¨å¼€å§‹æ”¯æŒ RPC æ¡†æ¶ã€‚2016 å¹´ï¼Œç¬¬ä¸€ä¸ª Golang RPC æ¡†æ¶ Kite æ­£å¼å‘å¸ƒã€‚
é€šå¸¸åœ¨ä¸€ä¸ªå…¬å¸é«˜é€Ÿå‘å±•çš„åˆæœŸï¼ŒåŸºç¡€èƒ½åŠ›éƒ½æ˜¯ä¸ºäº†å¿«é€Ÿæ”¯æŒéœ€æ±‚è½åœ°ï¼Œé¢å¯¹çš„éœ€æ±‚åœºæ™¯ä¹Ÿè¾ƒå•ä¸€ï¼Œè®¾è®¡ä¸Šä¸ä¼šæœ‰è¾ƒå¤šè€ƒé‡ï¼Œå…¶å®è¿™ä¹Ÿæ˜¯åˆç†çš„ï¼Œå› ä¸ºæ¢ç´¢é˜¶æ®µå¹¶ä¸å®Œå…¨æ¸…æ¥šè¿˜éœ€è¦æ”¯æŒå“ªäº›åœºæ™¯ï¼Œè¿‡å¤šçš„è€ƒè™‘åè€Œä¼šå‡ºç°è¿‡åº¦è®¾è®¡çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ï¼Œéšç€ä¸šåŠ¡åœºæ™¯å¤æ‚åŒ–ï¼Œéœ€æ±‚ä¹Ÿä¼šå¤šæ ·åŒ–ï¼Œè€Œä¸”æ¥å…¥æœåŠ¡åŠè°ƒç”¨é‡é€å¹´å¢é•¿ï¼ŒKite å·²ç»ä¸è¶³ä»¥æ”¯æŒåç»­çš„è¿­ä»£ï¼Œåœ¨çº¿ä¸Šæœå½¹ä¸‰å¹´å¤šåï¼Œ2019 å¹´æˆ‘ä»¬å¼€å¯äº†æ–°çš„é¡¹ç›® &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ï¼Œ2020 å¹´åˆå‘å¸ƒäº†æ­£å¼ç‰ˆæœ¬ï¼Œåœ¨ 2020 å¹´åº•å­—èŠ‚å†…éƒ¨å·²ç»æœ‰ 1w+ æœåŠ¡æ¥å…¥ Kitexã€‚&lt;/p>
&lt;p>ä» 2014 å¹´åˆ° 2020 å¹´ï¼ŒGolang å·²ç»æ˜¯å­—èŠ‚è·³åŠ¨å†…éƒ¨ä¸»è¦çš„ä¸šåŠ¡å¼€å‘è¯­è¨€ï¼Œåº”è¯¥æ˜¯ä¸šç•Œ Golang åº”ç”¨æœ€å¤šçš„å…¬å¸ã€‚æˆ‘ä»¬çš„æœåŠ¡æ¡†æ¶æ”¯æŒç€æ•°ä¸‡ä¸ª Golang å¾®æœåŠ¡çš„å¯é é€šä¿¡ï¼Œ
ç»è¿‡æ•°é‡ä¼—å¤šçš„å¾®æœåŠ¡å’Œæµ·é‡æµé‡çš„éªŒè¯ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†è¾ƒä¸ºæˆç†Ÿçš„å¾®æœåŠ¡æœ€ä½³å®è·µï¼Œäºæ˜¯è€ƒè™‘å°†å†…éƒ¨çš„å®è·µå¼€æºå‡ºå»ä¸°å¯Œäº‘åŸç”Ÿç¤¾åŒºçš„ Golang äº§å“ä½“ç³»ã€‚
åœ¨ 2021å¹´ï¼Œæˆ‘ä»¬ä»¥ CloudWeGo å“ç‰Œæ­£å¼å¼€æºäº†ç¬¬ä¸€ä¸ªæœåŠ¡æ¡†æ¶ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚æˆªè‡³ä»Šå¹´ 8 æœˆï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å·²ç»ä¸ºå­—èŠ‚è·³åŠ¨å†…éƒ¨ &lt;strong>6w+&lt;/strong> çš„æœåŠ¡æä¾›æ”¯æŒï¼Œ &lt;strong>å³°å€¼ QPS è¾¾åˆ°ä¸Šäº¿çº§åˆ«&lt;/strong> ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/3.png" alt="image">&lt;/p>
&lt;p>å¤§å®¶æˆ–è®¸è¿˜æœ‰ç–‘é—®ï¼Œå®Œæ•´çš„å¾®æœåŠ¡ä½“ç³»ç¦»ä¸å¼€åŸºç¡€çš„äº‘ç”Ÿæ€ï¼Œæ— è®ºåœ¨å…¬æœ‰äº‘ã€ç§æœ‰äº‘ï¼Œéƒ½éœ€è¦æ­å»ºé¢å¤–çš„æœåŠ¡ä»¥å¾ˆå¥½åœ°æ”¯æŒå¾®æœåŠ¡çš„æ²»ç†ï¼Œæ¯”å¦‚æ²»ç†å¹³å°ã€æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€ç›‘æ§ã€é“¾è·¯è·Ÿè¸ªã€æœåŠ¡ç½‘æ ¼ç­‰ï¼Œè€Œä¸”è¿˜å­˜åœ¨ä¸€äº›å®šåˆ¶çš„è§„èŒƒã€‚
å­—èŠ‚è·³åŠ¨è‡ªç„¶ä¹Ÿæœ‰å®Œå–„çš„å†…éƒ¨æœåŠ¡æ”¯æŒå¾®æœåŠ¡ä½“ç³»ï¼Œä½†è¿™äº›æœåŠ¡çŸ­æœŸè¿˜æ— æ³•å¼€æºï¼Œé‚£ CloudWeGo å¦‚ä½•å†…å¤–ç»´æŠ¤ä¸€å¥—ä»£ç ï¼Œç»Ÿä¸€è¿­ä»£å‘¢ï¼Ÿ&lt;/p>
&lt;p>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ¨¡å—åˆ’åˆ†ã€‚&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ¨¡å—åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šä¸­é—´æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸»å¹²éƒ¨åˆ† &lt;strong>Kitex Core&lt;/strong> ï¼Œå®ƒå®šä¹‰äº†æ¡†æ¶çš„å±‚æ¬¡ç»“æ„ã€æ¥å£æ ¸å¿ƒé€»è¾‘çš„å®ç°ä»¥åŠæ¥å£çš„é»˜è®¤å®ç°ï¼›
å·¦è¾¹çš„ &lt;strong>Kitex Tool&lt;/strong> åˆ™æ˜¯ä¸ç”Ÿæˆä»£ç ç›¸å…³çš„å®ç°ï¼Œæˆ‘ä»¬çš„ç”Ÿæˆä»£ç å·¥å…·å°±æ˜¯ç¼–è¯‘è¿™ä¸ªåŒ…å¾—åˆ°çš„ï¼Œå…¶ä¸­åŒ…æ‹¬ IDL çš„è§£æã€æ ¡éªŒã€ä»£ç ç”Ÿæˆã€æ’ä»¶æ”¯æŒç­‰ã€‚
ä¸è¿‡ä¸ºäº†ä¾¿äºç”¨æˆ·ä½¿ç”¨åŒæ—¶æä¾›æ›´å‹å¥½çš„æ‰©å±•ï¼Œä¸»è¦èƒ½åŠ›ä¹Ÿåšäº†æ‹†åˆ†ä½œä¸ºåŸºç¡€åº“ç‹¬ç«‹å¼€æºï¼Œå¦‚ Thriftgoã€Thrift-validator æ’ä»¶ã€Fastpbï¼›
å³è¾¹çš„ &lt;strong>Kitex Byted&lt;/strong> æ˜¯å¯¹å­—èŠ‚å†…éƒ¨åŸºç¡€èƒ½åŠ›é›†æˆçš„æ‰©å±•å®ç°ï¼Œæˆ‘ä»¬åœ¨å¼€å§‹å°±å°†å†…éƒ¨çš„èƒ½åŠ›ä½œä¸ºæ‰©å±•æ”¶æ•›åˆ°ä¸€ä¸ª package ä¸‹ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/4.png" alt="image">&lt;/p>
&lt;p>å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> Core å’Œ Tool éƒ¨åˆ†å¼€æºå‡ºå»ã€‚æˆ‘ä»¬å°†ä»£ç åšäº†æ‹†åˆ†ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ ¸å¿ƒä»£ç å’Œå·¥å…·éƒ¨åˆ†è¿ç§»åˆ°å¼€æºåº“ï¼Œé›†æˆå†…éƒ¨æ‰©å±•çš„æ¨¡å—ä½œä¸º &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ‰©å±•ä¿ç•™åœ¨å†…éƒ¨åº“ï¼ŒåŒæ—¶å†…éƒ¨åº“å°è£…ä¸€å±‚å£³ä¿è¯å†…éƒ¨ç”¨æˆ·å¯ä»¥æ— æ„ŸçŸ¥åœ°å‡çº§ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å¼€æºå°±åªæ˜¯ä»£ç æ‹†åˆ†è¿™ä¹ˆç®€å•å—ï¼Ÿæ˜¾ç„¶ä¸æ˜¯ã€‚2021 å¹´ 2 æœˆï¼Œæˆ‘ä»¬å¼€å§‹ç­¹å¤‡ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å¼€æºï¼Œè™½ç„¶åŸºäº &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ‰©å±•æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å†…éƒ¨åŸºç¡€è®¾æ–½é›†æˆçš„èƒ½åŠ›è§£è€¦ï¼Œä½†æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä»ç„¶ä¾èµ–å†…éƒ¨çš„ä¸€äº›åŸºç¡€åº“ï¼Œå¦‚æœè¦å¼€æºå¿…é¡»å…ˆå¼€æºåŸºç¡€åº“çš„èƒ½åŠ›ã€‚
æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆåšäº†ä¾èµ–åº“çš„æ¢³ç†ï¼Œä¸ç›¸å…³çš„åŒå­¦åˆä½œé¦–å…ˆå¼€æºäº† &lt;strong>bytedance/gopkg&lt;/strong> åº“ã€‚è¿™ä¸ªåº“ç”± CloudWeGo ä¸å­—èŠ‚è·³åŠ¨çš„è¯­è¨€å›¢é˜Ÿåˆä½œç»´æŠ¤ï¼Œé‡Œé¢åŒ…å«ä¹Ÿäº†å¯¹ Golang æ ‡å‡†åº“èƒ½åŠ›çš„å¢å¼ºï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å…³æ³¨ä½¿ç”¨ã€‚&lt;/p>
&lt;p>bytedance/gopkg: &lt;a href="https://github.com/bytedance/gopkg">https://github.com/bytedance/gopkg&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/5.png" alt="image">&lt;/p>
&lt;p>åœ¨ gopkg åº“å¼€æºåï¼Œæˆ‘ä»¬è°ƒæ•´ä»£ç è¿›è¡Œå¼€æºé€‚é…ã€‚2021 å¹´ 7 æœˆï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ­£å¼å¼€æºï¼Œåœ¨å†…éƒ¨å‘å¸ƒä¸­ç‰ˆæœ¬ä½¿ç”¨å¼€æºåº“ã€‚
ä½† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ¯•ç«Ÿæ”¯æŒäº†å†…éƒ¨å‡ ä¸‡çš„å¾®æœåŠ¡ï¼Œæˆ‘ä»¬å¿…é¡»è¦ç¡®ä¿å†…éƒ¨æœåŠ¡åœ¨è¿™ä¸ªå˜æ›´åå¯ä»¥å¹³æ»‘è¿‡æ¸¡ï¼Œæ‰€ä»¥åœ¨å¼€æºåˆæˆ‘ä»¬æ²¡æœ‰å¯¹å¤–å®˜å®£ï¼Œåœ¨ç¡®è®¤ç¨³å®šæ€§åï¼Œ&lt;strong>2021 å¹´ 9 æœˆï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ­£å¼å¯¹å¤–å®˜å®£å¼€æº&lt;/strong> ã€‚&lt;/p>
&lt;p>ä»‹ç»äº† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è¯ç”Ÿã€å¼€æºçš„å†ç¨‹ï¼Œå¸Œæœ›èƒ½å¤Ÿè§£é™¤å¤–éƒ¨åŒå­¦å…³äºâ€œKitex ä¼šä¸ä¼šæ˜¯ä¸€ä¸ª KPI é¡¹ç›®ï¼Ÿâ€çš„é¡¾è™‘ã€‚&lt;/p>
&lt;h3 id="å¼€æºçš„ä»·å€¼">å¼€æºçš„ä»·å€¼&lt;/h3>
&lt;p>ç¬¬ä¸€éƒ¨åˆ†çš„æœ€åï¼Œç®€å•è®²ä¸€ä¸‹å¼€æºèƒ½ä¸ºæˆ‘ä»¬å¸¦æ¥çš„ä»·å€¼ã€‚ &lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸æ˜¯ä¸ºäº†å¼€æºè€Œå®ç°çš„ï¼Œä½†å®ƒçš„å®ç°æ˜¯é¢å‘å¼€æºçš„ã€‚&lt;/strong> &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æœ¬èº«æ˜¯ä¸€ä¸ªç»è¿‡å†…éƒ¨å¤§è§„æ¨¡å®ç°çš„é¡¹ç›®ï¼Œ
æˆ‘ä»¬å¸Œæœ› &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¼€æºåèƒ½å¸®åŠ©æ›´å¤šç”¨æˆ·åœ¨å†…éƒ¨å¿«é€Ÿæ­å»ºå¾®æœåŠ¡ï¼ŒåŒæ—¶å¼€æºèƒ½è®©æˆ‘ä»¬æ”¶é›†æ›´å¤šç¤¾åŒºå’Œä¼ä¸šçš„åé¦ˆï¼Œä¹Ÿèƒ½å¸å¼•å¤–éƒ¨å¼€å‘è€…å…±å»ºï¼Œ
ä¿ƒè¿› &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> é¢å‘å¤šå…ƒåœºæ™¯æ”¯æŒçš„æ¼”è¿›ï¼Œä¸°å¯Œäº§å“èƒ½åŠ›ï¼Œç„¶åèƒ½åœ¨æ›´å¤šåœºæ™¯å’Œä¼ä¸šå¾—åˆ°è½åœ°ï¼Œè¿™æ˜¯ä¸€ä¸ªæ­£å‘å¾ªç¯ï¼Œäº’åˆ©å…±èµ¢çš„è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/6.png" alt="image">&lt;/p>
&lt;h2 id="å¼€æºä¸€å¹´å˜æ›´å›é¡¾">å¼€æºä¸€å¹´å˜æ›´å›é¡¾&lt;/h2>
&lt;h3 id="æ¡†æ¶çš„è¡¡é‡æŒ‡æ ‡">æ¡†æ¶çš„è¡¡é‡æŒ‡æ ‡&lt;/h3>
&lt;p>åœ¨ä»‹ç» &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¼€æºä¸€å¹´å˜æ›´å‰ï¼Œå…ˆåˆ†äº«ä¸€ä¸‹æ¡†æ¶çš„è¡¡é‡æŒ‡æ ‡ï¼Œè¿™æ˜¯å¤§å®¶åœ¨é€‰æ‹©ä¸€ä¸ªæ¡†æ¶æ—¶è¦è€ƒè™‘çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ‰©å±•æ€§&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœä¸€ä¸ªæ¡†æ¶ä¸å†…éƒ¨èƒ½åŠ›å¼ºè€¦åˆï¼Œå°±æ— æ³•ç§»æ¤åˆ°å…¶ä»–å¹³å°ï¼Œæˆ–æ¡†æ¶çš„æ”¯æŒåœºæ™¯å•ä¸€ä¹Ÿæ— æ³•è¿›è¡Œæ‰©å±•ï¼Œè¿™æ ·çš„æ¡†æ¶å¾ˆéš¾å¾—åˆ°å¤–éƒ¨çš„ä½¿ç”¨ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ˜“ç”¨æ€§&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>æ¡†æ¶çš„æ˜“ç”¨æ€§ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ã€‚ç¬¬ä¸€æ˜¯é¢å‘&lt;strong>ä¸šåŠ¡å¼€å‘è€…&lt;/strong> ï¼Œå¦‚æœä¸€ä¸ªæ¡†æ¶åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦è®©ç”¨æˆ·å…³æ³¨å¾ˆå¤šæ¡†æ¶çš„ç»†èŠ‚ï¼Œé‚£ä¹ˆå¯¹ç ”å‘æ•ˆç‡è¦æ±‚å¾ˆé«˜çš„å›¢é˜Ÿå¯èƒ½æ— æ³•æ¥å—ã€‚
ç¬¬äºŒæ˜¯é¢å‘&lt;strong>æ¡†æ¶çš„äºŒæ¬¡å¼€å‘è€…&lt;/strong> ï¼Œä»–ä»¬éœ€è¦å¯¹æ¡†æ¶åšä¸€äº›å®šåˆ¶æ”¯æŒï¼Œå¦‚æœæ¡†æ¶æä¾›çš„æ‰©å±•èƒ½åŠ›è¿‡äºå®½æ³›ï¼Œæ‰©å±•æˆæœ¬å¾ˆé«˜ï¼Œæˆ–è€…å¯æ‰©å±•çš„èƒ½åŠ›ä¸å¤Ÿå¤šï¼Œé‚£ä¹ˆè¿™ä¸ªæ¡†æ¶ä¹Ÿæ˜¯å­˜åœ¨å±€é™æ€§çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŠŸèƒ½çš„ä¸°å¯Œåº¦&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>è™½ç„¶åŸºäºæ‰©å±•æ€§å¯ä»¥å¯¹æ¡†æ¶è¿›è¡Œå®šåˆ¶ï¼Œä½†ä¸æ˜¯æ‰€æœ‰å¼€å‘è€…éƒ½æœ‰è¶³å¤Ÿçš„ç²¾åŠ›åšå®šåˆ¶å¼€å‘ï¼Œå¦‚æœæ¡†æ¶æœ¬èº«å¯¹å„ç§æ‰©å±•èƒ½åŠ›æä¾›äº†ä¸åŒé€‰æ‹©çš„æ”¯æŒï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´åªéœ€è¦æ ¹æ®è‡ªå·±çš„åŸºç¡€è®¾æ–½è¿›è¡Œç»„åˆå°±èƒ½åœ¨è‡ªå·±çš„ç¯å¢ƒä¸­è¿è¡Œã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>é«˜æ€§èƒ½&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>å‰é¢ä¸‰ç‚¹æ˜¯åˆæœŸé€‰æ‹©æ¡†æ¶éœ€è¦é‡ç‚¹å…³æ³¨çš„æŒ‡æ ‡ï¼Œä½†éšç€æœåŠ¡è§„æ¨¡å’Œèµ„æºæ¶ˆè€—å˜å¤§ï¼Œæ€§èƒ½å°±æˆäº†ä¸å®¹å¿½è§†çš„é—®é¢˜ã€‚ä»é•¿æœŸçš„è§’åº¦æ¥è¯´ï¼Œé€‰æ‹©æ¡†æ¶çš„æ—¶å€™ä¸€å®šè¦å…³æ³¨æ€§èƒ½ï¼Œå¦åˆ™åç»­åªèƒ½é¢ä¸´æ¡†æ¶æ›¿æ¢çš„é—®é¢˜ï¼Œæˆ–è€…è¢«è¿«å¯¹è¿™ä¸ªæ¡†æ¶åšå®šåˆ¶ç»´æŠ¤ã€‚&lt;/p>
&lt;p>å…³äºä»¥ä¸Šå››ç‚¹æ¡†æ¶çš„è¡¡é‡æŒ‡æ ‡ï¼Œè™½ç„¶ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ç›®å‰è¿˜æ²¡åšåˆ°æœ€å¥½ï¼Œä½†æ˜¯è¿™å››ä¸ªè¦ç´ éƒ½æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è®¾è®¡å’Œå®ç°ä¸­ä¸€ç›´åœ¨å…¼é¡¾çš„ï¼Œæˆ‘ä»¬ä¸ä¼šé¡¾æ­¤å¤±å½¼ã€‚&lt;/p>
&lt;h3 id="åŠŸèƒ½ç‰¹æ€§">åŠŸèƒ½ç‰¹æ€§&lt;/h3>
&lt;p>ä¸‹é¢å°±å‡ ä¸ªå¼€æºä¸€å¹´æ¥é‡è¦çš„åŠŸèƒ½ç‰¹æ€§è¿›è¡Œä»‹ç»ã€‚&lt;/p>
&lt;h4 id="proxyless">Proxyless&lt;/h4>
&lt;p>Proxyless æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> é¢å‘å¼€æºåœºæ™¯æä¾›çš„æ”¯æŒã€‚åœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¼€æºåˆæœŸï¼Œæˆ‘ä»¬å†…éƒ¨è®¨è®ºè¿‡æ˜¯å¦è¦æ”¯æŒ xDS å¯¹æ¥ &lt;a href="https://github.com/istio/istio">Istio&lt;/a>ï¼Œå¯¹äºå¤–éƒ¨ç”¨æˆ·æ¥è¯´ï¼Œä½¿ç”¨ &lt;a href="https://github.com/istio/istio">Istio&lt;/a> å¯ä»¥å¿«é€Ÿæ­å»ºä¸€å¥—åŸºæœ¬çš„å¾®æœåŠ¡æ¶æ„ï¼Œ
è§£å†³æœåŠ¡å‘ç°ã€æµé‡è·¯ç”±ã€é…ç½®ä¸‹å‘ç­‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨å®Œæ•´çš„ &lt;a href="https://github.com/istio/istio">Istio&lt;/a> çš„è§£å†³æ–¹æ¡ˆï¼Œå°±è¦å¼•å…¥ Envoyï¼Œè¿™ä¼šå¢åŠ è¿ç»´æˆæœ¬ï¼Œè€Œä¸”ç›´æ¥ä½¿ç”¨å®˜æ–¹çš„ Envoy æ–¹æ¡ˆå¯¹æ€§èƒ½æœ‰æŸï¼Œä¼šå¼•å…¥é¢å¤–çš„ CPU å¼€é”€ä¸”å¢åŠ å»¶è¿Ÿã€‚
&lt;strong>å¦‚æœ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> èƒ½ç›´æ¥å¯¹æ¥ &lt;a href="https://github.com/istio/istio">Istio&lt;/a>ï¼Œæ—¢èƒ½è®©ç”¨æˆ·äº«å—åˆ°éƒ¨åˆ† &lt;a href="https://github.com/istio/istio">Istio&lt;/a> çš„èƒ½åŠ›ï¼Œåˆå¯ä»¥é¿å… Envoy å¸¦æ¥çš„æ€§èƒ½æŸå¤±å’Œéƒ¨ç½²è¿ç»´æˆæœ¬ã€‚&lt;/strong> ä½†æ˜¯åœ¨å¼€æºåˆæœŸï¼Œæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°å¾ˆæ˜ç¡®çš„ç”¨æˆ·è¯‰æ±‚ï¼Œå› æ­¤æ²¡æœ‰å¯¹æ­¤åšé«˜ä¼˜çš„æ”¯æŒã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/7.png" alt="image">&lt;/p>
&lt;p>åæ¥ gRPC å®˜æ–¹ä¹Ÿå‘å¸ƒäº† Proxyless çš„æ”¯æŒï¼ŒåŒæ—¶ &lt;a href="https://github.com/istio/istio">Istio&lt;/a> çš„å®˜æ–¹ä¹Ÿå°† Proxyless ä½œä¸ºä½¿ç”¨ &lt;a href="https://github.com/istio/istio">Istio&lt;/a> çš„ä¸€ç§æ–¹å¼ã€‚&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ç°åœ¨ä¹Ÿå·²å®Œæˆæ”¯æŒï¼Œç›®å‰ä¸»è¦æ˜¯å¯¹æ¥æœåŠ¡å‘ç°ï¼Œ
xDS æ”¯æŒçš„æ‰©å±•å•ç‹¬å¼€æºåˆ°äº† &lt;a href="https://github.com/kitex-contrib/xds">kitex-contrib/xds&lt;/a> åº“ä¸­ï¼Œåç»­è¿˜ä¼šå®Œå–„ã€‚å¤§å®¶å¯ä»¥æ ¹æ® README äº†è§£å¦‚ä½•ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¯¹æ¥ &lt;a href="https://github.com/istio/istio">Istio&lt;/a>ã€‚&lt;/p>
&lt;h4 id="json-å’Œ-protobuf-æ³›åŒ–è°ƒç”¨æ”¯æŒ">JSON å’Œ Protobuf æ³›åŒ–è°ƒç”¨æ”¯æŒ&lt;/h4>
&lt;p>ä¹‹å‰ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ”¯æŒäº†åº”ç”¨åœ¨ç½‘å…³åœºæ™¯çš„ HTTP æ³›åŒ–ï¼Œä»¥åŠæ”¯æŒäº†åº”ç”¨åœ¨ä¸€äº›é€šç”¨æœåŠ¡åœºæ™¯çš„ Map å’ŒäºŒè¿›åˆ¶æ³›åŒ–ã€‚å¼€æºåï¼Œæ ¹æ®ç”¨æˆ·çš„éœ€æ±‚åé¦ˆåˆæ–°å¢äº† JSON å’Œ Protobuf çš„æ³›åŒ–ã€‚&lt;/p>
&lt;p>Protobuf çš„æ³›åŒ–ä¹Ÿæ˜¯åº”ç”¨åœ¨ API ç½‘å…³çš„åœºæ™¯ã€‚åŸæ¥çš„ HTTP æ³›åŒ–ä¼ è¾“çš„æ•°æ®æ ¼å¼æ˜¯ JSONï¼Œä½†æ˜¯ JSON çš„åºåˆ—åŒ–ä½“ç§¯å¤§ã€æ•ˆç‡ä½ï¼Œå¯¹æ€§èƒ½æœ‰å½±å“ï¼Œæ‰€ä»¥å¾ˆå¤šç§»åŠ¨ç«¯çš„æ¥å£é€‰æ‹©ä½¿ç”¨ Protobuf ä¼ è¾“æ•°æ®ï¼Œå› æ­¤å¢åŠ äº† Protobuf æ³›åŒ–çš„æ”¯æŒã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/8.png" alt="image">&lt;/p>
&lt;p>&lt;strong>ç›®å‰ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ³›åŒ–ä¸»è¦é’ˆå¯¹åç«¯çš„ Thrift æœåŠ¡ï¼Œæ— è®ºæ˜¯ Protobufã€Map è¿˜æ˜¯ JSONï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> éƒ½ä¼šåœ¨è°ƒç”¨ç«¯ç»“åˆ IDL è§£æï¼Œå°†è¿™äº›æ•°æ®æ˜ å°„ç¼–ç ä¸º Thrift åŒ…å‘ç»™åç«¯æœåŠ¡ã€‚&lt;/strong>&lt;/p>
&lt;p>é‚£ä¹ˆä¸ºä»€ä¹ˆæŠŠæ³›åŒ–æ”¾åœ¨è°ƒç”¨ç«¯è€Œä¸æ˜¯æœåŠ¡ç«¯å‘¢ï¼Ÿå¤§å®¶å¹¿æ³›äº†è§£çš„æ³›åŒ–éƒ½æ˜¯æœåŠ¡ç«¯å¯¹æ³›åŒ–è¯·æ±‚åšäº†è§£æå¤„ç†ï¼Œå½“ç„¶è°ƒç”¨ç«¯ä¹Ÿè¦ç›¸åº”åœ°æä¾›æ³›åŒ–çš„ Clientã€‚
ä½†æ˜¯æ³›åŒ–é¢å‘çš„æ˜¯é€šç”¨æœåŠ¡ï¼Œæ³›åŒ–ä½¿ç”¨æˆæœ¬å…¶å®æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œå®ƒå¹¶ä¸é€‚ç”¨äºæ™®é€šçš„ RPC åœºæ™¯ï¼Œè€Œé€šç”¨æœåŠ¡é¢å‘çš„æ˜¯æ‰€æœ‰åç«¯çš„æœåŠ¡ï¼Œæœ‰ Golang/Java/C++/Python/Rustï¼Œå¦‚æœæ¯ä¸€ç§è¯­è¨€æ¡†æ¶éƒ½æ”¯æŒæ³›åŒ–ï¼Œæˆæœ¬æ˜¯éå¸¸é«˜çš„ã€‚
å°±ç®—å„ä¸ªè¯­è¨€éƒ½å¯¹æ³›åŒ–åšäº†æ”¯æŒï¼Œæ¡†æ¶ç‰ˆæœ¬æ”¶æ•›åˆæ˜¯ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ï¼Œå¯¹äºé€šç”¨æœåŠ¡æ¥è¯´ï¼Œå¯¹æ¥æ‰€æœ‰çš„æœåŠ¡å°±æ˜¾å¾—ä¸å¤ªç°å®ã€‚ç»¼åˆä»¥ä¸ŠåŸå› ï¼Œæ³›åŒ–æ”¾åœ¨è°ƒç”¨ç«¯æ”¯æŒã€‚&lt;/p>
&lt;h4 id="é‡è¯•èƒ½åŠ›å¢å¼º">é‡è¯•èƒ½åŠ›å¢å¼º&lt;/h4>
&lt;p>å»å¹´å¼€æºæ—¶ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å·²ç»æ”¯æŒäº†é‡è¯•åŠŸèƒ½ã€‚ä¹‹å‰æ”¯æŒçš„é‡è¯•æœ‰ä¸¤ç±»ï¼Œä¸€ä¸ªæ˜¯è¶…æ—¶é‡è¯•ï¼Œä¸€ä¸ªæ˜¯ Backup Requestã€‚&lt;/p>
&lt;p>å¯¹äºè¶…æ—¶æ¥é‡è¯•æ¥è¯´ï¼Œæˆ‘ä»¬åªä¼šå¯¹è¶…æ—¶è¿™ä¸€ç§å¼‚å¸¸è¿›è¡Œé‡è¯•ï¼Œä½†ä¸ºäº†è¿›ä¸€æ­¥æé«˜è¯·æ±‚æˆåŠŸç‡ï¼Œç”¨æˆ·å¸Œæœ›å¯¹å…¶ä»–çš„å¼‚å¸¸ä¹Ÿè¿›è¡Œé‡è¯•ï¼Œæˆ–è€…ç”¨æˆ·å¯èƒ½ä¼šå®šä¹‰ä¸€äº›ç”¨æˆ·è¯·æ±‚çš„çŠ¶æ€ç ï¼Œç»“åˆç”¨æˆ·çŠ¶æ€ç è¿›è¡Œé‡è¯•ï¼Œ
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¾ç„¶æˆ‘ä»¬åªæ”¯æŒè¶…æ—¶é‡è¯•æ˜¯ä¸æ»¡è¶³ç”¨æˆ·éœ€æ±‚çš„ã€‚åŸºäºè¿™ä¸ªèƒŒæ™¯ï¼Œ &lt;strong>Kitex æ–°å¢äº†æŒ‡å®šç»“æœé‡è¯•&lt;/strong> ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šå…¶ä»–å¼‚å¸¸æˆ–æŒ‡å®šæŸä¸€ç±» Responseï¼Œæ¡†æ¶ä¼šç»“åˆç”¨æˆ·æŒ‡å®šçš„ç»“æœè¿›è¡Œé‡è¯•ã€‚&lt;/p>
&lt;p>å…¶æ¬¡ï¼Œç”¨æˆ·åœ¨é…ç½®é‡è¯•æ—¶ï¼Œå¦‚æœé€šè¿‡ä»£ç é…ç½®çš„æ–¹å¼è®¾ç½®é‡è¯•ï¼Œå®ƒä¼šå¯¹æ•´ä¸ª Client çš„æ‰€æœ‰ RPC æ–¹æ³•ç”Ÿæ•ˆï¼Œä½†æ˜¯ç”¨æˆ·å¸Œæœ›é’ˆå¯¹ä¸åŒçš„ RPC æ–¹æ³•åº”ç”¨ä¸åŒçš„é‡è¯•ç­–ç•¥ï¼Œç”šè‡³åŒä¸€ä¸ªæ–¹æ³•ä¹Ÿå¸Œæœ›å¯ä»¥é‡‡ç”¨ä¸åŒçš„é‡è¯•ç­–ç•¥ï¼Œ
å› ä¸ºä¸åŒé“¾è·¯ä¸Šå‘èµ·çš„åŒä¸€ä¸ªæ–¹æ³•çš„è¯·æ±‚å¯¹æŒ‡æ ‡è¦æ±‚ä¹Ÿä¼šä¸åŒã€‚æ¯”å¦‚æœ‰äº›æƒ³ä½¿ç”¨ Backup Request å‡å°‘å»¶è¿Ÿï¼Œæœ‰äº›æƒ³åšå¼‚å¸¸é‡è¯•æé«˜æˆåŠŸç‡ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œ &lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ–°çš„ç‰ˆæœ¬æ”¯æŒäº†è¯·æ±‚ç²’åº¦é…ç½®é‡è¯•&lt;/strong> ã€‚&lt;/p>
&lt;p>ä¸‹å›¾æ˜¯ä½¿ç”¨ç¤ºä¾‹ã€‚ä»¥è¯·æ±‚ç²’åº¦é‡è¯•é…ç½®ä¸ºä¾‹ï¼Œæ¯”å¦‚ RPC æ–¹æ³•æ˜¯ &lt;code>Mock&lt;/code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å‘èµ· RPC è°ƒç”¨çš„æ—¶å€™ï¼Œåœ¨åé¢å¯ä»¥é…ç½®ä¸€ä¸ª &lt;code>callopt&lt;/code> æŒ‡å®šé‡è¯•ç­–ç•¥ï¼Œæ­¤æ¬¡è¯·æ±‚å°±ä¼šä½¿ç”¨è¿™ä¸ªé‡è¯•ç­–ç•¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/9.png" alt="image">&lt;/p>
&lt;h4 id="thrift-validator">Thrift Validator&lt;/h4>
&lt;p>Thrift-gen-validator æ˜¯ Thriftgo çš„ä¸€ä¸ªå·¥å…·æ’ä»¶ï¼Œå®ƒå¯ä»¥æ ¹æ® Thrift IDL ä¸­å®šä¹‰çš„æ³¨è§£æè¿°çº¦æŸç»™å¯¹åº”çš„ &lt;code>struct&lt;/code> ç”Ÿæˆ &lt;code>IsValid() error&lt;/code> æ–¹æ³•ï¼Œæ ¡éªŒå€¼çš„åˆæ³•æ€§ã€‚
é€šå¸¸åš RPC è°ƒç”¨çš„æ—¶å€™ï¼Œç”¨æˆ·å¯èƒ½ä¼šå¯¹ä¸€äº›å­—æ®µæ ¡éªŒåˆæ³•æ€§ï¼Œç”¨æˆ·å¦‚æœç›´æ¥å†™è¿™äº›æ ¡éªŒä»£ç ï¼ŒæŠ•å…¥çš„æˆæœ¬ä¼šå¾ˆé«˜ã€‚æ‰€ä»¥æˆ‘ä»¬å°±æä¾›äº†æ³¨è§£æ”¯æŒï¼Œ &lt;strong>åªè¦ç”¨æˆ·åœ¨ IDL ä¸­æ ¹æ®è§„èŒƒå®šä¹‰æ³¨è§£ï¼ŒKitex å°±å¯ä»¥å¸®åŠ©ç”¨æˆ·ç”Ÿæˆæ ¡éªŒä»£ç &lt;/strong> ã€‚&lt;/p>
&lt;p>ä¸‹å›¾æ˜¯ä»£ç ç”Ÿæˆçš„å‘½ä»¤å’Œä¸€ä¸ª IDL æ³¨è§£å®šä¹‰ç¤ºä¾‹ï¼Œåœ¨ç”Ÿæˆä»£ç çš„æ—¶å€™æŒ‡å®š Thrift Validator çš„æ’ä»¶ï¼Œæˆ‘ä»¬çš„æ’ä»¶å·¥å…·å°±ä¼šè§£ææ³¨è§£ï¼Œä¸ºç”¨æˆ·ç”Ÿæˆè¿™ä¸€å¥—åˆæ³•æ€§æ ¡éªŒçš„ä»£ç ã€‚
ç›®å‰æˆ‘ä»¬ä¹Ÿå°† Thrift Validator çš„åŠŸèƒ½è´¡çŒ®ç»™äº† Apache Thriftã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/10.png" alt="image">&lt;/p>
&lt;h3 id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–&lt;/h3>
&lt;p>ä»‹ç»å®Œå‡ ä¸ªé‡è¦çš„åŠŸèƒ½ç‰¹æ€§ï¼Œå†ä»‹ç»å‡ ä¸ªåœ¨æ€§èƒ½ä¸Šçš„ä¼˜åŒ–ç‰¹æ€§ã€‚&lt;/p>
&lt;h4 id="thrift-é«˜æ€§èƒ½ç¼–è§£ç ">Thrift é«˜æ€§èƒ½ç¼–è§£ç &lt;/h4>
&lt;p>&lt;strong>&lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a> æ˜¯ä¸€ä¸ªæ— éœ€ç”Ÿæˆç¼–è§£ç ä»£ç ã€åŸºäº JIT çš„é«˜æ€§èƒ½åŠ¨æ€ Thrift ç¼–è§£ç å™¨ã€‚&lt;/strong> è™½ç„¶æˆ‘ä»¬é’ˆå¯¹å®˜æ–¹ Thrift ç¼–è§£ç å·²ç»åšäº†ä¼˜åŒ–ï¼Œæ”¯æŒäº† FastThriftï¼Œè¿™ä¸ªåœ¨æˆ‘ä»¬å¼€æºå‰å‘å¸ƒçš„ä¼˜åŒ–å®è·µé‡Œä¹Ÿæœ‰ä»‹ç»ï¼Œ
ä½†æˆ‘ä»¬å¸Œæœ›èƒ½æœ‰è¿›ä¸€æ­¥çš„æ€§èƒ½æå‡ï¼Œå‚è€ƒæˆ‘ä»¬å¼€æºçš„é«˜æ€§èƒ½ JSON åº“ Sonic çš„è®¾è®¡ï¼Œå®ç°äº† Thrift JIT ç¼–è§£ç å™¨ã€‚ä¸‹å›¾ä¸­çš„è¡¨æ ¼æ˜¯ &lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a> ç»“åˆ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸ FastThrift çš„æ€§èƒ½å¯¹æ¯”ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/11.png" alt="image">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°åœ¨å¤§éƒ¨åˆ†åœºæ™¯ RPC æ€§èƒ½è¡¨ç°éƒ½è¾ƒä¼˜ã€‚é™¤äº†æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œ&lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a> è¿˜æœ‰å¦ä¸€ä¸ªä¼˜åŠ¿æ˜¯æ— éœ€ç”Ÿæˆç¼–è§£ç ç”Ÿæˆä»£ç ã€‚Thrift çš„ç”Ÿæˆä»£ç æ¯” Protobuf ç¹é‡ï¼Œä¸€ä¸ªå¤æ‚çš„ IDL ä»£ç ç”Ÿæˆæ–‡ä»¶å¯ä»¥è¾¾åˆ°å‡ ä¸‡è¡Œï¼Œ
è€Œè¿™äº›ä»£ç æœ¬æ¥å¯¹ç”¨æˆ·æ¥è¯´æ— éœ€å…³æ³¨ï¼Œå´éœ€è¦ç”±ç”¨æˆ·æ¥ç»´æŠ¤ã€‚&lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a> åªéœ€è¦ç”Ÿæˆç»“æ„ä½“ä»£ç ï¼Œä¸éœ€ç”Ÿæˆç¼–è§£ç ä»£ç ï¼Œå°±å¤§å¤§è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>å…³äºå¦‚ä½•åœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸­ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a>ï¼Œå¯ä»¥å‚è€ƒä»“åº“çš„ &lt;a href="https://github.com/cloudwego/frugal#readme">Readme&lt;/a>ã€‚å½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a> ä½œä¸º Thrift é«˜æ€§èƒ½ç¼–è§£ç å™¨ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åç»­ä¹Ÿä¼šè€ƒè™‘é»˜è®¤ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/frugal">Frugal&lt;/a>ã€‚&lt;/p>
&lt;h4 id="protobuf-é«˜æ€§èƒ½ç¼–è§£ç ">Protobuf é«˜æ€§èƒ½ç¼–è§£ç &lt;/h4>
&lt;p>è™½ç„¶æˆ‘ä»¬å†…éƒ¨ä¸»è¦æ”¯æŒ Thriftï¼Œä½†å¼€æºä¹‹åæˆ‘ä»¬å‘ç°å¤–éƒ¨ç”¨æˆ·å¯¹äº Protobuf æˆ– gRPC çš„å…³æ³¨ä¼šæ›´å¤šï¼Œæ‰€ä»¥å‚è€ƒ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> FastThrift çš„ä¼˜åŒ–æ€è·¯ï¼Œé‡æ–°å®ç°äº† Protobuf çš„ç”Ÿæˆä»£ç ã€‚
åœ¨ v0.4.0 ç‰ˆæœ¬ï¼Œå¦‚æœç”¨æˆ·ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å·¥å…·ç”Ÿæˆ Protobuf çš„ä»£ç ï¼Œå°±ä¼šé»˜è®¤ç”Ÿæˆ &lt;a href="https://github.com/cloudwego/fastpb">Fastpb&lt;/a> çš„ç¼–è§£ç ä»£ç ï¼Œåœ¨å‘èµ· RPC è°ƒç”¨çš„æ—¶å€™ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¹Ÿä¼šé»˜è®¤ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/fastpb">Fastpb&lt;/a>ã€‚&lt;/p>
&lt;p>ä¸‹é¢åˆ—å‡ºçš„æ˜¯ &lt;a href="https://github.com/cloudwego/fastpb">Fastpb&lt;/a> ä¸å®˜æ–¹ Protobuf åºåˆ—åŒ–çš„æ€§èƒ½å¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯ç¼–ç è¿˜æ˜¯è§£ç ï¼Œåœ¨æ•ˆç‡å’Œå†…å­˜åˆ†é…ä¸Šï¼Œ&lt;a href="https://github.com/cloudwego/fastpb">Fastpb&lt;/a> éƒ½è¿œè¿œä¼˜äºå®˜æ–¹ Protobuf åºåˆ—åŒ–åº“ã€‚&lt;/p>
&lt;ul>
&lt;li>FastWrite: &lt;strong>(ns/op) â†“67.8% ï¼Œ(B/op) â†“83.9%&lt;/strong>&lt;/li>
&lt;li>FastRead: &lt;strong>(ns/op) â†“41.5% ï¼Œ(B/op) â†“4.5%&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h4 id="grpc-æ€§èƒ½ä¼˜åŒ–">gRPC æ€§èƒ½ä¼˜åŒ–&lt;/h4>
&lt;p>å¼€æºåˆæœŸï¼Œæˆ‘ä»¬å¯¹ gRPC æ•´ä½“ç¨³å®šæ€§å’Œæ€§èƒ½çš„å…³æ³¨æ˜¯æ¯”è¾ƒå°‘çš„ã€‚å› ä¸ºå†…éƒ¨ä½¿ç”¨çš„åœºæ™¯ä¸æ˜¯å¾ˆå¤šã€‚å¼€æºåæ”¶åˆ°äº†å¾ˆå¤šå¤–éƒ¨åŒå­¦çš„åé¦ˆï¼Œ
æ‰€ä»¥æˆ‘ä»¬é’ˆå¯¹ gRPC åšäº†ä¸€ä¸ªä¸“é¡¹çš„é—®é¢˜æ²»ç†ä»¥åŠæ€§èƒ½ä¼˜åŒ–ã€‚ä»Šå¹´ä¸­æ—¬æˆ‘ä»¬å·²ç»æŠŠç›¸å…³çš„ä¼˜åŒ–æ­£å¼æäº¤åˆ°å¼€æºåº“ï¼Œåœ¨ v0.4.0 ç‰ˆæœ¬å‘å¸ƒã€‚&lt;/p>
&lt;p>Kitex v0.4.0: &lt;a href="https://mp.weixin.qq.com/s/ezifbQkHcZQP6MygmJABYA">https://mp.weixin.qq.com/s/ezifbQkHcZQP6MygmJABYA&lt;/a>&lt;/p>
&lt;p>ä¸‹å›¾ä¸­å·¦ä¾§æ˜¯ä¼˜åŒ–å‰ Kitex-gRPC å’Œå®˜æ–¹ gRPC æ¡†æ¶å¯¹ &lt;strong>Unary è¯·æ±‚&lt;/strong>çš„å‹æµ‹ååå¯¹æ¯”ï¼Œåœ¨å¹¶å‘æ¯”è¾ƒä½çš„æƒ…å†µä¸‹ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„ååå¹¶ä¸å…·æœ‰ä¼˜åŠ¿ï¼Œ
ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/fastpb">Fastpb&lt;/a> çš„æ—¶å€™ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„ååè¡¨ç°ä¼šå¥½ä¸€äº›ï¼Œä½†ä½å¹¶å‘çš„ååä¾ç„¶ä½äºå®˜æ–¹ gRPCã€‚åœ¨ä¼˜åŒ–ä¹‹åï¼Œååå¯¹æ¯”å¦‚å³å›¾æ‰€ç¤ºã€‚&lt;strong>ç›¸æ¯”ä¼˜åŒ–å‰ååæå‡ 46% - 70%ï¼Œç›¸æ¯”å®˜æ–¹ gRPC æ¡†æ¶ï¼Œååé«˜ 51% - 70%ã€‚&lt;/strong>&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/13.png" alt="image">&lt;/p>
&lt;p>ä¸‹å›¾ä¸­å³ä¾§æ˜¯ä¼˜åŒ–å &lt;strong>Unary è¯·æ±‚&lt;/strong>çš„å»¶è¿Ÿå¯¹æ¯”ï¼Œåœ¨ååæ¯”å®˜æ–¹ gRPC é«˜å‡ºå¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å»¶è¿Ÿä¹Ÿæ˜¾è‘—ä½äºå®˜æ–¹çš„ gRPCã€‚åŒæ—¶å°± &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è‡ªèº«è€Œè¨€ï¼Œåœ¨ä¼˜åŒ–åå»¶è¿Ÿè¡¨ç°ä¹Ÿå¥½äº†å¾ˆå¤šã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/14.png" alt="image">&lt;/p>
&lt;p>æˆ‘ä»¬å†çœ‹ä¸‹ &lt;strong>Streaming è¯·æ±‚&lt;/strong>çš„å‹æµ‹æ€§èƒ½å¯¹æ¯”ï¼Œä¼˜åŒ–å‰ Streaming è¯·æ±‚çš„è¡¨ç°åŒæ ·åœ¨ä½å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œç›¸å¯¹ gRPC æ¡†æ¶æ²¡æœ‰ä¼˜åŠ¿ã€‚
ç»è¿‡ä¼˜åŒ–åï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ååæ˜¾è‘—é«˜äºå®˜æ–¹ gRPCï¼Œå¦‚ä¸‹å›¾ï¼ŒåŒæ—¶ä½å¹¶å‘ä¸‹ååé«˜ä½†å»¶è¿ŸæŒå¹³ï¼Œå¢åŠ å¹¶å‘åèƒ½çœ‹åˆ°å»¶è¿Ÿå‡ºç°åˆ†å‰ã€‚æ‰€ä»¥åœ¨æ€§èƒ½ä¸Šï¼Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ”¯æŒçš„ gRPC åè®®ç›¸å¯¹å®˜æ–¹æœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/15.png" alt="image">&lt;/p>
&lt;p>è™½ç„¶åœ¨éƒ¨åˆ†åŠŸèƒ½ä¸Šï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è¿˜æ²¡æœ‰å®Œå…¨å¯¹é½ï¼Œä½†æ˜¯ç›®å‰å·²ç»å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„åœºæ™¯éœ€æ±‚ï¼Œæˆ‘ä»¬åç»­ä¹Ÿä¼šç»§ç»­è¿›è¡ŒåŠŸèƒ½å¯¹é½ã€‚&lt;/p>
&lt;h2 id="ç¤¾åŒºå…±å»ºå®Œå–„ç”Ÿæ€åŠä¼ä¸šè½åœ°">ç¤¾åŒºå…±å»ºå®Œå–„ç”Ÿæ€åŠä¼ä¸šè½åœ°&lt;/h2>
&lt;h3 id="ç¤¾åŒºå…±å»ºçš„-kitex-æ‰©å±•ç”Ÿæ€">ç¤¾åŒºå…±å»ºçš„ Kitex æ‰©å±•ç”Ÿæ€&lt;/h3>
&lt;p>å¼€æºåï¼Œæˆ‘ä»¬å¾ˆæ¬£æ…°å¾—åˆ°äº†å¾ˆå¤šå¼€å‘è€…çš„å…³æ³¨ï¼Œå¦ç™½è¯´å†…éƒ¨å›¢é˜Ÿç²¾åŠ›æœ‰é™ï¼Œæ— æ³•å¿«é€Ÿå»ºç«‹èµ·é¢å‘å¤–éƒ¨ç”¨æˆ·çš„ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ‰©å±•ç”Ÿæ€ã€‚ä½†æ˜¯ä¸€å¹´ä»¥æ¥å€ŸåŠ©ç¤¾åŒºçš„åŠ›é‡ï¼Œ
&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨ &lt;strong>æœåŠ¡æ³¨å†Œ/å‘ç°&lt;/strong>ã€ &lt;strong>å¯è§‚æµ‹æ€§&lt;/strong>ã€&lt;strong>æœåŠ¡æ²»ç†&lt;/strong>å‡ éƒ¨åˆ†çš„æ‰©å±•å¾—åˆ°äº†å¾ˆå¤šè¡¥å……ï¼Œå°¤å…¶æ˜¯æœåŠ¡æ³¨å†Œ/å‘ç°ç›¸å…³çš„æ‰©å±•ï¼Œç›®å‰å¼€æºçš„ä¸»æµæ³¨å†Œä¸­å¿ƒéƒ½å·²å®Œæˆå¯¹æ¥ï¼Œ
è™½ç„¶åœ¨åŠŸèƒ½ä¸°å¯Œåº¦ä¸Šæˆ‘ä»¬è¿˜æœ‰å¾…åŠ å¼ºï¼Œä½†ç»“åˆå·²æœ‰çš„æ”¯æŒï¼Œå¯¹äºå¤–éƒ¨ç”¨æˆ·å·²ç»å…·å¤‡äº†æ­å»ºå¾®æœåŠ¡æ¶æ„çš„èƒ½åŠ›ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/16.png" alt="image">&lt;/p>
&lt;p>è¡·å¿ƒæ„Ÿè°¢ç§¯æå‚ä¸ CloudWeGo ç¤¾åŒºå»ºè®¾çš„åŒå­¦ä»¬ï¼å…³äº &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ç›¸å…³çš„ç”Ÿæ€æ”¯æŒï¼Œå¤§å®¶å¯ä»¥è¿›å…¥ &lt;a href="https://github.com/kitex-contrib">kitex-contrib&lt;/a> äº†è§£æ›´å¤šçš„å¼€æºä»“åº“ã€‚&lt;/p>
&lt;h3 id="å¯¹æ¥å¤–éƒ¨ä¼ä¸šååŠ©è½åœ°">å¯¹æ¥å¤–éƒ¨ä¼ä¸šï¼ŒååŠ©è½åœ°&lt;/h3>
&lt;p>æˆ‘ä»¬å¼€æºçš„åˆè¡·æ˜¯ä¸ºäº†åŠ©åŠ›å…¶ä»–å¤–éƒ¨ä¼ä¸šå¿«é€Ÿåœ°æ­å»ºä¼ä¸šçº§çš„äº‘åŸç”Ÿæ¶æ„ã€‚å¼€æºåï¼Œæ£®é©¬ã€åå…´è¯åˆ¸ã€è´ªç©æ¸¸æˆã€ç¦¾å¤šç§‘æŠ€å…ˆåä¸»åŠ¨ä¸æˆ‘ä»¬è”ç³»ï¼Œåé¦ˆä½¿ç”¨é—®é¢˜ã€æå‡ºéœ€æ±‚ï¼Œ
çš„ç¡®è®©æˆ‘ä»¬å‘ç°äº†ä¸€äº›å’Œå†…éƒ¨åœºæ™¯ä¸ä¸€æ ·çš„é—®é¢˜ï¼Œéœ€è¦æˆ‘ä»¬å»å…³æ³¨ã€æ”¯æŒå’Œä¼˜åŒ–ï¼Œæˆ‘ä»¬å¾ˆå¼€å¿ƒ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> èƒ½åœ¨è¿™äº›ä¼ä¸šå†…éƒ¨å¾—åˆ°åº”ç”¨ã€‚
åœ¨ä»Šå¹´ 6 æœˆ 25 æ—¥çš„ CloudWeGo Meetup ä¸­ï¼Œæ£®é©¬å’Œåå…´è¯åˆ¸çš„ç ”å‘åŒå­¦ä¹Ÿåˆ†äº«äº†ä»–ä»¬ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å†…éƒ¨å®è·µã€‚&lt;/p>
&lt;p>æ£®é©¬ï¼šhttps://mp.weixin.qq.com/s/JAurW4P2E3NIduFaVY6jew&lt;/p>
&lt;p>åå…´è¯åˆ¸ï¼šhttps://mp.weixin.qq.com/s/QqGdzp-7rTdlxedy6bsXiw&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/17.png" alt="image">&lt;/p>
&lt;p>é™¤äº†ä»¥ä¸Šä¼ä¸šï¼Œè¿˜æœ‰ä¸€äº›å…¬å¸ä¹Ÿç§ä¸‹å‘æˆ‘ä»¬å’¨è¯¢è¿‡ä½¿ç”¨é—®é¢˜ï¼Œæˆ‘ä»¬éå¸¸æ„Ÿè°¢è¿™äº›ä¼ä¸šç”¨æˆ·çš„æ”¯æŒï¼Œä»¥åŠå‘æˆ‘ä»¬æå‡ºçš„åé¦ˆä¿¡æ¯ã€‚
å¦‚ç¬¬ä¸€éƒ¨åˆ†æ‰€è®²ï¼Œæ”¶é›†ç¤¾åŒºå’Œä¼ä¸šçš„åé¦ˆå¯ä»¥ä¿ƒè¿› &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> é¢å‘å¤šå…ƒåœºæ™¯æ”¯æŒçš„æ¼”è¿›ï¼Œä¼ä¸šç”¨æˆ·å¦‚æœæœ‰ç›¸å…³éœ€æ±‚ï¼Œæ¬¢è¿è”ç³»æˆ‘ä»¬ã€‚&lt;/p>
&lt;h3 id="å¦‚ä½•ä½¿ç”¨-kitex-ä¸å†…éƒ¨åŸºç¡€è®¾æ–½é›†æˆ">å¦‚ä½•ä½¿ç”¨ Kitex ä¸å†…éƒ¨åŸºç¡€è®¾æ–½é›†æˆ&lt;/h3>
&lt;p>è¿™é‡Œå†ç®€å•ä»‹ç»ä¸‹å¦‚ä½•ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸å¤§å®¶çš„å†…éƒ¨åŸºç¡€è®¾æ–½é›†æˆã€‚ä»¥å­—èŠ‚å†…éƒ¨ä¸ºä¾‹ï¼Œå†…éƒ¨ä»“åº“é‡Œæœ‰å¼€æºåº“ä¸­çš„æ‰©å±•å®ç°ï¼Œé›†æˆå†…éƒ¨çš„èƒ½åŠ›ï¼Œ
åœ¨ bytedSuite ä¸­ï¼Œæˆ‘ä»¬é’ˆå¯¹ä¸åŒåœºæ™¯å¯¹ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼Œç”¨æˆ·åªéœ€è¦åœ¨æ„é€  Client å’Œ Server æ—¶å¢åŠ ä¸€ä¸ª option é…ç½®å°±å¯ä»¥å®Œæˆé›†æˆï¼Œ
ä¸è¿‡ä¸ºäº†è®©ç”¨æˆ·å®Œå…¨ä¸éœ€å…³æ³¨å†…éƒ¨èƒ½åŠ›çš„é›†æˆï¼Œæˆ‘ä»¬å°†è¯¥é…ç½®æ”¾åœ¨äº†ç”Ÿæˆçš„è„šæ‰‹æ¶ä»£ç ä¸­ï¼Œå…³äºé…ç½®å¦‚ä½•å†…åµŒåœ¨ç”Ÿæˆä»£ç ä¸­ï¼Œåç»­æˆ‘ä»¬ä¹Ÿä¼šå¼€æ”¾å‡ºæ¥ï¼Œæ–¹ä¾¿å¤–éƒ¨çš„æ¡†æ¶äºŒæ¬¡å¼€å‘è€…èƒ½ä»¥åŒæ ·çš„æ–¹å¼ä¸ºä¸šåŠ¡å¼€å‘åŒå­¦æä¾›é›†æˆèƒ½åŠ›ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/1st_RPC_Kitex/18.png" alt="image">&lt;/p>
&lt;h2 id="æ€»ç»“å’Œå±•æœ›">æ€»ç»“å’Œå±•æœ›&lt;/h2>
&lt;h3 id="æ€»ç»“">æ€»ç»“&lt;/h3>
&lt;p>æœ¬æ¬¡åˆ†äº«ä¸»è¦ä»‹ç»äº†ä»¥ä¸‹å†…å®¹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¦‚ä½•ä¿æŒå†…å¤–ç»Ÿä¸€åœ°ä»å†…éƒ¨åº”ç”¨è¾ƒå¹¿çš„æ¡†æ¶è½¬ä¸ºå¼€æºæ¡†æ¶ï¼›&lt;/li>
&lt;li>å¼€æºä¸€å¹´ä»¥æ¥å‘å¸ƒäº†å“ªäº›é‡è¦çš„åŠŸèƒ½ç‰¹æ€§ï¼Œåšäº†å“ªäº›æ€§èƒ½ä¼˜åŒ–ï¼›&lt;/li>
&lt;li>å€ŸåŠ©ç¤¾åŒºçš„åŠ›é‡ç°åœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„å‘¨è¾¹ç”Ÿæ€å¦‚ä½•ã€ä¼ä¸šè½åœ°æƒ…å†µä»¥åŠå¦‚ä½•ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¼˜é›…åœ°é›†æˆå†…éƒ¨èƒ½åŠ›ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="å±•æœ›">å±•æœ›&lt;/h3>
&lt;ul>
&lt;li>ä¸ç¤¾åŒºåŒå­¦å…±å»ºï¼ŒæŒç»­ä¸°å¯Œç¤¾åŒºç”Ÿæ€ï¼›&lt;/li>
&lt;li>ç»“åˆå·¥ç¨‹å®è·µï¼Œä¸ºå¾®æœåŠ¡å¼€å‘è€…æä¾›æ›´å¤šä¾¿åˆ©ï¼›&lt;/li>
&lt;li>å®Œå–„å¥½ BDThrift ç”Ÿæ€ï¼ŒæŒç»­ä¼˜åŒ– Protobuf/gRPCï¼›&lt;/li>
&lt;li>æ›´å¤šç‰¹æ€§æ”¯æŒæˆ–å¼€æºï¼ŒShmIPCã€QUICã€Protobuf æ³›åŒ–â€¦&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.4.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/08/26/kitex-v0.4.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Fri, 26 Aug 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/08/26/kitex-v0.4.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="é‡è¦å˜æ›´ä»‹ç»">é‡è¦å˜æ›´ä»‹ç»&lt;/h2>
&lt;h3 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>é‡è¯•åŠŸèƒ½å¢å¼º&lt;/strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ç»“æœé‡è¯•ï¼›æ”¯æŒè¯·æ±‚ç²’åº¦é…ç½®é‡è¯•ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/retry/">é‡è¯•æŒ‡å—&lt;/a>&lt;/li>
&lt;li>&lt;strong>Frugal(thrift)&lt;/strong>: æ”¯æŒäº† IDL é»˜è®¤å€¼ï¼›ä½¿ç”¨ Frugal å¯ä»¥æ”¯æŒä¸ç”Ÿæˆç¼–è§£ç ä»£ç ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/codec_frugal/#2-%E5%B8%A6%E4%B8%8A--thrift-frugal_tag-%E5%8F%82%E6%95%B0%E9%87%8D%E6%96%B0%E7%94%9F%E6%88%90%E4%B8%80%E6%AC%A1%E4%BB%A3%E7%A0%81">frugal&lt;/a>&lt;/li>
&lt;li>&lt;strong>Tool-Protobuf&lt;/strong>ï¼šç»“åˆ go_package é…ç½®æ”¯æŒä¾èµ–å¤–éƒ¨åº“ï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/code_generation/#%E4%BD%BF%E7%94%A8-protobuf-idl-%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">protobuf IDL çš„æ³¨æ„äº‹é¡¹&lt;/a>ï¼›æ”¯æŒä»æ–‡ä»¶æ‰©å±•åçŒœæµ‹ IDL çš„ç±»å‹ï¼Œç”Ÿæˆ proto ä»£ç æ—¶æ— éœ€å†æŒ‡å®š type å‚æ•°&lt;/li>
&lt;li>&lt;strong>Fastpb(protobuf)&lt;/strong>: æ”¯æŒ fastpb ä¼˜åŒ– pb ç¼–è§£ç ï¼Œå¹¶é»˜è®¤é›†æˆåˆ° Kitexï¼Œè¯¦è§ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/fastpb/">fastpb&lt;/a>&lt;/li>
&lt;li>&lt;strong>æ³›åŒ–è°ƒç”¨&lt;/strong>ï¼šæ”¯æŒ HTTP+Protobuf æ³›åŒ–è°ƒç”¨&lt;/li>
&lt;li>&lt;strong>Kitex ä¾èµ–åº“æ”¯æŒ Windows&lt;/strong>ï¼šä¾¿äº Windows ç¯å¢ƒè¿è¡Œï¼ˆå·¥å…·æš‚æœªæ”¯æŒï¼‰&lt;/li>
&lt;/ol>
&lt;h3 id="ä¼˜åŒ–å’Œä¿®å¤">ä¼˜åŒ–å’Œä¿®å¤&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>æ€§èƒ½ä¼˜åŒ–&lt;/strong>ï¼šgRPC Unary ååæå‡ 46-70%ï¼Œç›¸æ¯”å®˜æ–¹ gRPC ååé«˜ 51%-70%ï¼Œè¯¦è§ &lt;a href="https://github.com/cloudwego/kitex-benchmark">benchmark &lt;/a>&lt;/li>
&lt;li>&lt;strong>æ³›åŒ–è°ƒç”¨&lt;/strong>ï¼šHTTP / Map / JSON æ³›åŒ–è°ƒç”¨æ”¯æŒäº† Thrift é»˜è®¤å€¼&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="è¯¦ç»†å˜æ›´">è¯¦ç»†å˜æ›´&lt;/h2>
&lt;h3 id="feature">Feature&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/571">#571&lt;/a>] åŠŸèƒ½(protobuf): é»˜è®¤é›†æˆ &lt;a href="https://github.com/cloudwego/fastpb">fastpb&lt;/a> åˆ° Kitexï¼Œè¯¦æƒ…å‚è€ƒ &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/code-gen/fastpb/">doc&lt;/a>ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/592">#592&lt;/a>] åŠŸèƒ½(generic): HTTP/Map/JSON æ³›åŒ–è°ƒç”¨æ”¯æŒ Thrift é»˜è®¤å€¼ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/600">#600&lt;/a>] åŠŸèƒ½(thrift): æ”¯æŒå½“ä½¿ç”¨ frugal æ—¶ä¸ç”Ÿæˆç¼–è§£ç ä»£ç ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/607">#607&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/610">#610&lt;/a>] åŠŸèƒ½(proxyless): æä¾› xDS æ‰©å±•çš„æ¥å£ã€‚æ”¯æŒåŸºäº xDS çš„æµé‡è·¯ç”±ï¼Œè¶…æ—¶é…ç½®åŠæœåŠ¡å‘ç°ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/541">#541&lt;/a>] åŠŸèƒ½(trans): ä¼ è¾“å±‚å¢åŠ  go net ä½œä¸ºæ‰©å±•ï¼Œå¹¶åœ¨ Windows OS ä¸‹ä½œä¸ºé»˜è®¤ç½‘ç»œåº“ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/540">#540&lt;/a>] åŠŸèƒ½(retry): Retry æ”¯æŒæŒ‡å®š error æˆ– resp é‡è¯•ï¼ŒåŒæ—¶æ–°å¢ option ç”¨æ¥æ”¯æŒä¸ºæ–¹æ³•è®¾ç½®é‡è¯•ç­–ç•¥ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/533">#533&lt;/a>] åŠŸèƒ½(generic): æ³›åŒ–è°ƒç”¨ js_conv æ³¨è§£æ”¯æŒ map ç±»å‹è½¬æ¢ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="optimize">Optimize&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/522">#522&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/538">#538&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/605">#605&lt;/a>] ä¼˜åŒ–(grpc): ä¼˜åŒ– gRPC åè®®æ€§èƒ½ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/590">#590&lt;/a>] ä¼˜åŒ–(tool): æ”¯æŒä»æ–‡ä»¶æ‰©å±•åçŒœæµ‹ IDL çš„ç±»å‹ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/559">#559&lt;/a>] ä¼˜åŒ–(timeout): åœ¨è¶…æ—¶ä¸­é—´ä»¶ä¸­ä½¿ç”¨è¶…æ—¶å°è£…æ–¹æ³•åˆ¤æ–­åº•å±‚è¶…æ—¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›å®šåˆ¶è¶…æ—¶é”™è¯¯æ—¥å¿—ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/581">#581&lt;/a>] ä¼˜åŒ–(tool): Kitex å‘½ä»¤å¢åŠ ä½¿ç”¨ç¤ºä¾‹ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="bugfix">Bugfix&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/564">#564&lt;/a>] ä¿®å¤(oneway): å½“ oneway è¯·æ±‚å‘é€å®Œæ¯•åï¼Œå…³é—­å¯¹åº”çš„è¿æ¥ï¼Œå¦åˆ™åç»­çš„å‘é€åˆ°è¯¥è¿æ¥ä¸Šçš„è¯·æ±‚ä¼šè¢«é˜»å¡åœ¨ server ç«¯ï¼Œç›´åˆ° server ç«¯æŠŠä¸Šä¸€ä¸ª oneway è¯·æ±‚å¤„ç†å®Œã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/577">#577&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/584">#584&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/602">#602&lt;/a>] ä¿®å¤(rpcinfo): ä¿®å¤é•¿è¿æ¥åœºæ™¯ä¸‹ rpcinfo å¤ç”¨é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/578">#578&lt;/a>] ä¿®å¤: ä¿®å¤ long pool dump å¯èƒ½å¯¼è‡´ panic çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/583">#583&lt;/a>] ä¿®å¤(tool): ä¿®å¤ protobuf ç”Ÿæˆä»£ç å¼•ç”¨äº†é”™è¯¯çš„ package åå­—çš„é—®é¢˜&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/587">#587&lt;/a>] ä¿®å¤(tool): ç”Ÿæˆä»£ç çš„æ—¶å€™è·³è¿‡æŒ‡å®šäº†å¤–éƒ¨ import path çš„ proto æ–‡ä»¶ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/594">#594&lt;/a>] ä¿®å¤(generic): æ³›åŒ–è°ƒç”¨æ”¯æŒå•å¼•å·ä¸­åŒå¼•å·å¸¦è½¬ä¹‰ç¬¦çš„ tag æ ¼å¼ä»¥å…¼å®¹æ—§ç‰ˆæœ¬é€»è¾‘ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/595">#595&lt;/a>] ä¿®å¤: ä¿®å¤ union ä¸º nil æ—¶ BLength ä¼š panic çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/589">#589&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/596">#596&lt;/a>] ä¿®å¤(frugal): ä¿®å¤ frugal build tagã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="refactor">Refactor&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/566">#566&lt;/a>] refactor(metainfo): ç§»é™¤ HTTP2 header ä¸­æ²¡æœ‰ä½¿ç”¨çš„ meta keysã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/593">#593&lt;/a>] refactor(trans): æœåŠ¡ç«¯æ”¯æŒé€šè¿‡ WithListener é…ç½® listenerï¼Œå…¶ä¼˜å…ˆçº§é«˜äº WithServiceAddrã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/582">#582&lt;/a>] refactor(tool): kitex å·¥å…·ä»¥æ–‡ä»¶åµŒå…¥æ–¹å¼ä½¿ç”¨æ¨¡æ¿å¹¶å¯¼å‡ºéƒ¨åˆ† API ä¾›å¤–éƒ¨ä½¿ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="test">Test&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/579">#579&lt;/a>] test: é•¿è¿æ¥æ±  dump å¢åŠ å•æµ‹ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/608">#608&lt;/a>] test: ä¿®å¤ TestClientConnDecoupledFromApplicationRead çš„ data race é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/609">#609&lt;/a>] test: ä¿®å¤ gonet å•æµ‹ä¸­çš„ç«¯å£å†²çªé—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/480">#480&lt;/a>] test: ç»™ client package å¢åŠ å•æµ‹ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="chore">Chore&lt;/h3>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/558">#558&lt;/a>] ci: ä¿®å¤ ci ä¸­ setup-python çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/487">#487&lt;/a>] ci: Workflow ä¸­å¢åŠ  golangci-lintã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/580">#580&lt;/a>] chore: ä¿®å¤ remote æ¨¡å—ä¸­ go net ç›¸å…³çš„é”™è¯¯æ‹¼å†™ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/601">#601&lt;/a>] chore: ä¿®å¤é”™è¯¯æ‹¼å†™å¹¶æ›¿æ¢æ‰ä¸€äº›åŠŸèƒ½é‡å¤çš„ä»£ç ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/604">#604&lt;/a>] chore: å‡çº§ fastpb åˆ° v0.0.2ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/603">#603&lt;/a>] chore: å‡çº§ frugal åˆ° v0.1.2ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="dependency-change">Dependency Change&lt;/h3>
&lt;p>github.com/cloudwego/frugal v0.1.1 -&amp;gt; v0.1.3&lt;/p>
&lt;p>github.com/cloudwego/netpoll v0.2.5 -&amp;gt; v0.2.6&lt;/p>
&lt;p>github.com/cloudwego/thriftgo v0.1.2 -&amp;gt; v0.2.0&lt;/p>
&lt;p>google.golang.org/protobuf v1.26.0 -&amp;gt; v1.28.0&lt;/p>
&lt;p>github.com/choleraehyq/pid v0.0.13 -&amp;gt; v0.0.15&lt;/p>
&lt;p>æ–°å¢&lt;/p>
&lt;p>github.com/cloudwego/fastpb v0.0.2&lt;/p>
&lt;p>github.com/jhump/protoreflect v1.8.2&lt;/p></description></item><item><title>Blog: Kitex v0.3.2 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/06/02/kitex-v0.3.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Thu, 02 Jun 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/06/02/kitex-v0.3.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="feature">Feature&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/473">#473&lt;/a>] åŠŸèƒ½ (grpc): ä¸º Kitex gRPC unary æ¨¡å¼å¢åŠ çŸ­è¿æ¥åŠŸèƒ½ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/431">#431&lt;/a>] åŠŸèƒ½ (limiter):
&lt;ol>
&lt;li>æ”¯æŒè‡ªå®šä¹‰çš„é™æµå®ç°ï¼Œæ¥å£å¢åŠ äº†è¯·æ±‚å‚æ•°çš„ä¼ é€’ï¼›&lt;/li>
&lt;li>ä¿®å¤å¤šè·¯å¤ç”¨åœºæ™¯ä¸‹ Server çš„ QPS é™æµå™¨é—®é¢˜ï¼Œæ·»åŠ åŸºäº OnMessage çš„é™æµï¼›&lt;/li>
&lt;li>è°ƒæ•´é»˜è®¤çš„é™æµç”Ÿæ•ˆæ—¶æœºï¼Œåªæœ‰ä½¿ç”¨æ¡†æ¶ QPS é™æµä¸”éå¤šè·¯å¤ç”¨çš„åœºæ™¯ä¸‹ï¼Œæ‰ä½¿ç”¨åŸºäº OnRead çš„é™æµã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h2 id="optimize">Optimize&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/465">#465&lt;/a>] ä¼˜åŒ– (ttheader): Client ç«¯åœ¨ TTHeader è§£ç ç»“æŸåèµ‹å€¼ Remote Address (ç”¨äº Proxy åœºæ™¯è¯·æ±‚å¤±è´¥æ—¶è·å–å¯¹ç«¯åœ°å€)ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/466">#466&lt;/a>] ä¼˜åŒ– (mux): è¿æ¥å¤šè·¯å¤ç”¨åœºæ™¯çš„ ErrReadTimeout ç”¨ ErrRPCTimeout å°è£…è¿”å›ã€‚Proxy åœºæ™¯è¯·æ±‚å¤±è´¥æ—¶è·å–å¯¹ç«¯åœ°å€)ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/425">#425&lt;/a>] ä¼˜åŒ– (limiter): ä¼˜åŒ–é™æµå®ç°ï¼Œä¿è¯ç¬¬ä¸€ç§’çš„ Tokens ä¸ä¼šå¤§å¹…è¶…è¿‡é™åˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="bugfix">Bugfix&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/485">#485&lt;/a>] ä¿®å¤ (grpc): ä¿®å¤ grpc å†…ä¸æ°å½“çš„ int ç±»å‹è½¬æ¢ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/474">#474&lt;/a>] ä¿®å¤ (trans): åœ¨ detection handler ä¸­å¢åŠ æ£€æµ‹ã€‚å½“ OnInactive æ¯” OnActive å…ˆå‘ç”Ÿï¼Œæˆ–è€… OnActive è¿”å› error æ—¶ï¼Œé˜²æ­¢ç©ºæŒ‡é’ˆ panicã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/445">#445&lt;/a>] ä¿®å¤ (retry):
&lt;ol>
&lt;li>ä¿®å¤é‡è¯•ä¸­ &lt;code>callTimes&lt;/code> å­—æ®µçš„ race é—®é¢˜ï¼›&lt;/li>
&lt;li>ä¿®å¤ &lt;code>rpcStats&lt;/code> ä¸­ä¸€äº›å­—æ®µçš„ race é—®é¢˜ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/471">#471&lt;/a>] ä¿®å¤ (retry): ä¿®å¤åœ¨ backup request ä¸­çš„ä¸€ä¸ª race é—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="test">Test&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/404">#404&lt;/a>] test: å¢åŠ  pkg/retry çš„å•æµ‹ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/439">#439&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/472">#472&lt;/a>] test: å¢åŠ  pkg/remote/remotecli çš„å•æµ‹ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/462">#462&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/457">#457&lt;/a>] test: å¢åŠ  pkg/remote/trans/nphttp2/grpc çš„å•æµ‹ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/420">#420&lt;/a>] test: å¢åŠ  pkg/remote/trans/nphttp2 çš„å•æµ‹ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="refactor">Refactor&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/464">#464&lt;/a>] refactor (ttheader): ä¿®æ”¹ Kitex Protobuf åœ¨ TTHeader ä¸­çš„ protocolIDï¼ŒåŒæ—¶ä¿è¯è¯¥å˜æ›´ä¸ä½ç‰ˆæœ¬çš„å…¼å®¹æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/453">#453&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/475">#475&lt;/a>] chore: æ›´æ–° netpoll å’Œ bytedance/gopkg çš„ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/458">#458&lt;/a>] chore: ä¿®å¤äº† reviewdog å¤±æ•ˆçš„é—®é¢˜ä¸ fork pr å•æµ‹çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/454">#454&lt;/a>] chore: ç°åœ¨çš„ CI å—é™äº github runner çš„æ€§èƒ½ç»å¸¸ä¼šå¤±è´¥ï¼Œå°è¯•æ”¹æˆ self-hosted runner æ¥æå‡æ€§èƒ½ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/449">#449&lt;/a>] chore: æ›´æ–° issue templateï¼Œä¿®æ”¹ä¸ºæ›´é€‚åˆ Kitex é¡¹ç›®çš„é—®é¢˜æ¨¡æ¿ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="style">Style&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/486">#486&lt;/a>] style (trans): ä¸º detection trans handler å¢åŠ æ³¨é‡Šä¿¡æ¯ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="docs">Docs&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/482">#482&lt;/a>] docs: åœ¨ Readme ä¸­å¢åŠ  FAQ é“¾æ¥ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="dependency-change">Dependency Change&lt;/h2>
&lt;ul>
&lt;li>github.com/cloudwego/netpoll: v0.2.2 -&amp;gt; v0.2.4&lt;/li>
&lt;/ul></description></item><item><title>Blog: å­—èŠ‚å¾®æœåŠ¡æ¡†æ¶çš„æŒ‘æˆ˜å’Œæ¼”è¿›</title><link>https://www.cloudwego.io/zh/blog/2022/05/19/%E5%AD%97%E8%8A%82%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6%E7%9A%84%E6%8C%91%E6%88%98%E5%92%8C%E6%BC%94%E8%BF%9B/</link><pubDate>Thu, 19 May 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/05/19/%E5%AD%97%E8%8A%82%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6%E7%9A%84%E6%8C%91%E6%88%98%E5%92%8C%E6%BC%94%E8%BF%9B/</guid><description>
&lt;h2 id="å­—èŠ‚å¾®æœåŠ¡æ¡†æ¶çš„æŒ‘æˆ˜å’Œæ¼”è¿›">å­—èŠ‚å¾®æœåŠ¡æ¡†æ¶çš„æŒ‘æˆ˜å’Œæ¼”è¿›&lt;/h2>
&lt;p>2014 å¹´ä»¥æ¥ï¼Œå­—èŠ‚è·³åŠ¨å†…éƒ¨ä¸šåŠ¡çš„å¿«é€Ÿå‘å±•ï¼Œæ¨åŠ¨äº†é•¿è¿æ¥æ¨é€æœåŠ¡ï¼Œå®ƒä»¬é¢ä¸´ç€é«˜å¹¶å‘çš„ä¸šåŠ¡éœ€æ±‚é—®é¢˜ï¼Œå¯¹æ€§èƒ½å’Œå¼€å‘æ•ˆç‡éƒ½æœ‰å¾ˆé«˜è¦æ±‚ã€‚å½“æ—¶çš„ä¸šåŠ¡ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ç”± Python å¼€å‘ï¼Œéš¾ä»¥åº”å¯¹æ–°å‡ºç°çš„é—®é¢˜ã€‚
é¡¹ç›®è´Ÿè´£äººåœ¨ä¸€ä¼—ç°å­˜çš„æŠ€æœ¯æ ˆä¸­é€‰æ‹©äº† Golang è¿™ä¸€é—¨æ–°å…´çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¿«é€Ÿè§£å†³äº†æ€§èƒ½å’Œå¼€å‘æ•ˆç‡çš„é—®é¢˜ã€‚éšåï¼Œå­—èŠ‚è·³åŠ¨å†…éƒ¨å¼€å§‹é€æ¸æ¨å¹¿ä½¿ç”¨ Golang è¿›è¡ŒæœåŠ¡å¼€å‘ã€‚&lt;/p>
&lt;p>2016 å¹´ï¼Œ ç¬¬ä¸€ä»£ Golang RPC æ¡†æ¶ Kite æ­£å¼å‘å¸ƒã€‚Kite æ˜¯ä¸€ä¸ªåŸºäº Apache Thrift è¿›è¡ŒåŒ…è£…çš„ RPC æ¡†æ¶ï¼Œå®ƒåœ¨ Facebook å¼€æºçš„ Thrift ä¹‹ä¸Šæä¾›äº†ç»“åˆå­—èŠ‚è·³åŠ¨å†…éƒ¨åŸºç¡€è®¾æ–½çš„æ²»ç†åŠŸèƒ½ï¼Œ
åŒæ—¶è¿˜æä¾›äº†ä¸€å¥—ç®€å•æ˜“ç”¨çš„ç”Ÿæˆå·¥å…·ã€‚éšç€ Kite çš„å‘å±•ï¼Œä¸šåŠ¡å¼€å§‹å¤§è§„æ¨¡ä½¿ç”¨ Golangã€‚ç„¶è€Œï¼Œåœ¨ä¸šåŠ¡å‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºç ”å‘ä¸“æ³¨äºå®ç°ä¸šåŠ¡éœ€æ±‚ï¼Œå¯¹äºæ¡†æ¶çš„å¯ç»´æŠ¤æ€§è€ƒé‡ä¸è¶³ï¼ŒKite é€æ¸èƒŒä¸Šäº†ä¸€äº›æŠ€æœ¯åŒ…è¢±ï¼Œ
è¶Šæ¥è¶Šéš¾ä»¥æ»¡è¶³ä¸šåŠ¡åœ¨é«˜æ€§èƒ½å’Œæ–°ç‰¹æ€§æ–¹é¢çš„éœ€æ±‚ã€‚å› æ­¤æˆ‘ä»¬å†³å®šå¯¹ Kite è¿›è¡Œé‡æ–°è®¾è®¡ï¼Œäºæ˜¯å‡ºç°äº† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚&lt;/p>
&lt;p>2020 å¹´ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨å†…éƒ¨å‘å¸ƒäº† v1.0.0ï¼Œå¹¶ä¸”ç›´æ¥æ¥å…¥äº† 1,000+ æœåŠ¡ã€‚ç”±äº &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„ä¼˜ç§€æ€§èƒ½å’Œæ˜“ç”¨æ€§ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨å†…éƒ¨å¾—åˆ°äº†å¤§è§„æ¨¡å‘å±•ã€‚
ç›´åˆ° 2021 å¹´å¹´ä¸­ï¼Œå­—èŠ‚è·³åŠ¨å†…éƒ¨å·²æœ‰ 2w+ æœåŠ¡ä½¿ç”¨äº† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†³å®šå…¨é¢ä¼˜åŒ– &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ï¼Œå°†å…¶å®è·µæˆæœè¿›è¡Œå¼€æºï¼Œåé¦ˆç»™å¼€æºç¤¾åŒºã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/GolangRPC.png" alt="image">&lt;/p>
&lt;p align="center">
å­—èŠ‚è·³åŠ¨ Golang RPC æ¡†æ¶çš„æ¼”è¿›
&lt;/p>
&lt;h3 id="kite-çš„ç¼ºé™·">Kite çš„ç¼ºé™·&lt;/h3>
&lt;p>Kite ä½œä¸ºå­—èŠ‚è·³åŠ¨ç¬¬ä¸€ä»£ Golang RPC æ¡†æ¶ï¼Œä¸»è¦å­˜åœ¨ä»¥ä¸‹ç¼ºé™·ï¼š&lt;/p>
&lt;ol>
&lt;li>Kite ä¸ºäº†å¿«é€Ÿæ”¯æŒä¸šåŠ¡å‘å±•éœ€æ±‚ï¼Œä¸å¯é¿å…åœ°è€¦åˆäº†éƒ¨åˆ†ä¸­å°ä¸šåŠ¡çš„åŠŸèƒ½ï¼›&lt;/li>
&lt;li>Kite å¯¹ Go modules æ”¯æŒä¸å‹å¥½ï¼ˆGo modules åœ¨ 2019 å¹´æ‰è¿›å…¥è¯­è¨€æ ¸å¿ƒï¼‰ï¼›&lt;/li>
&lt;li>Kite è‡ªèº«çš„ä»£ç æ‹†åˆ†æˆå¤šä»“åº“ï¼Œç‰ˆæœ¬æ›´æ–°æ—¶æ¨åŠ¨ä¸šåŠ¡å‡çº§å›°éš¾ï¼›&lt;/li>
&lt;li>Kite å¼ºè€¦åˆäº†æ—©æœŸç‰ˆæœ¬çš„ Apache Thriftï¼Œåè®®å’ŒåŠŸèƒ½æ‹“å±•å›°éš¾ï¼›&lt;/li>
&lt;li>Kite çš„ç”Ÿæˆä»£ç é€»è¾‘ä¸æ¡†æ¶æ¥å£å¼ºè€¦åˆï¼Œæˆä¸ºäº†æ€§èƒ½ä¼˜åŒ–çš„å¤©èŠ±æ¿ã€‚&lt;/li>
&lt;/ol>
&lt;p>å› æ­¤ï¼Œä¸šåŠ¡çš„å¿«é€Ÿå‘å±•å’Œéœ€æ±‚åœºæ™¯çš„å¤šæ ·åŒ–ï¼Œå‚¬ç”Ÿäº†æ–°ä¸€ä»£ Golang RPC æ¡†æ¶ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚&lt;/p>
&lt;h3 id="kitex">Kitex&lt;/h3>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ¶æ„ä¸»è¦åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼šKitex Toolã€Kitex Coreã€Kitex Bytedã€Second Party Pkgã€‚&lt;/p>
&lt;ul>
&lt;li>Kitex Core æ˜¯ä¸€ä¸ªæºå¸¦äº†ä¸€å¥—å¾®æœåŠ¡æ²»ç†åŠŸèƒ½çš„ RPC æ¡†æ¶ï¼Œå®ƒæ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚&lt;/li>
&lt;li>Kitex Byted æ˜¯ä¸€å¥—ç»“åˆäº†å­—èŠ‚è·³åŠ¨å†…éƒ¨åŸºç¡€è®¾æ–½çš„æ‹“å±•é›†åˆã€‚é€šè¿‡è¿™ä¸€å¥—æ‹“å±•é›†åˆï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> èƒ½å¤Ÿåœ¨å†…éƒ¨æ”¯æŒä¸šåŠ¡çš„å‘å±•ã€‚&lt;/li>
&lt;li>Kitex Tool æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œèƒ½å¤Ÿåœ¨å‘½ä»¤è¡Œç”Ÿæˆæˆ‘ä»¬çš„ä»£ç ä»¥åŠæœåŠ¡çš„è„šæ‰‹æ¶ï¼Œå¯ä»¥æä¾›éå¸¸ä¾¿æ·çš„å¼€å‘ä½“éªŒã€‚&lt;/li>
&lt;li>Second Party Pkgï¼Œä¾‹å¦‚ &lt;a href="https://github.com/cloudwego/netpoll">Netpoll&lt;/a>ï¼Œ Netpoll-http2ï¼Œæ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åº•å±‚çš„ç½‘ç»œåº“ï¼Œè¿™ä¸¤ä¸ªåº“ä¹Ÿå¼€æºåœ¨ CloudWeGo ç»„ç»‡ä¸­ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Architecture_design.png" alt="image">&lt;/p>
&lt;p align="center">
Kitex çš„æ¶æ„è®¾è®¡
&lt;/p>
&lt;p>æ€»çš„æ¥è¯´ï¼Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸»è¦æœ‰äº”ä¸ªç‰¹ç‚¹ï¼šé¢å‘å¼€æºã€åŠŸèƒ½ä¸°å¯Œã€çµæ´»å¯æ‹“å±•ã€æ”¯æŒå¤šåè®®ã€é«˜æ€§èƒ½ã€‚&lt;/p>
&lt;h3 id="é¢å‘å¼€æº">é¢å‘å¼€æº&lt;/h3>
&lt;p>ç”±äºä¹‹å‰å·²ç»ä½“éªŒè¿‡äº† Kite ç»´æŠ¤çš„å„ç§é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ç«‹é¡¹ä¹‹åˆå°±è€ƒè™‘åˆ°äº†æœªæ¥å¯èƒ½ä¼šå¼€æº &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¾è®¡çš„ç¬¬ä¸€ä¸ªå®—æ—¨å°±æ˜¯ä¸å°† &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å’Œå…¬å¸å†…éƒ¨çš„åŸºç¡€è®¾æ–½è¿›è¡Œå¼ºè€¦åˆæˆ–è€…ç¡¬ç¼–ç ç»‘å®šã€‚
Kitex Core æ˜¯ä¸€ä¸ªéå¸¸ç®€æ´çš„æ¡†æ¶ï¼Œå…¬å¸å†…éƒ¨çš„æ‰€æœ‰åŸºç¡€è®¾æ–½éƒ½ä»¥æ‹“å±•çš„æ–¹å¼æ³¨å…¥åˆ° Kitex Core é‡Œã€‚å³ä½¿æˆ‘ä»¬ç°åœ¨å·²ç»å¼€æºäº†ï¼Œå®ƒä¹Ÿä»¥è¿™ç§å½¢å¼å­˜åœ¨ã€‚
å…¬å¸å†…éƒ¨åŸºç¡€è®¾æ–½çš„æ›´æ–°æ¢ä»£ï¼Œå’Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è‡ªèº«çš„è¿­ä»£æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè¿™å¯¹äºä¸šåŠ¡æ¥è¯´æ˜¯éå¸¸å¥½çš„ä½“éªŒã€‚åŒæ—¶ï¼Œåœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ¥å£è®¾è®¡ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Golang ç»å…¸çš„ Option æ¨¡å¼ï¼Œ
å®ƒæ˜¯å¯å˜å‚æ•°ï¼Œé€šè¿‡ Option èƒ½å¤Ÿæä¾›å„ç§å„æ ·çš„åŠŸèƒ½ï¼Œè¿™ä¸ºæˆ‘ä»¬çš„å¼€å‘å’Œä¸šåŠ¡çš„ä½¿ç”¨éƒ½å¸¦æ¥äº†éå¸¸å¤§çš„çµæ´»æ€§ã€‚&lt;/p>
&lt;h3 id="kitex-çš„åŠŸèƒ½ç‰¹æ€§">Kitex çš„åŠŸèƒ½ç‰¹æ€§&lt;/h3>
&lt;h4 id="æ²»ç†èƒ½åŠ›">æ²»ç†èƒ½åŠ›&lt;/h4>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å†…ç½®äº†ä¸°å¯Œçš„æœåŠ¡æ²»ç†èƒ½åŠ›ï¼Œä¾‹å¦‚è¶…æ—¶ç†”æ–­ã€é‡è¯•ã€è´Ÿè½½å‡è¡¡ã€æ³›åŒ–è°ƒç”¨ã€æ•°æ®é€ä¼ ç­‰åŠŸèƒ½ã€‚ä¸šåŠ¡æˆ–è€…å¤–éƒ¨çš„ç”¨æˆ·ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> éƒ½æ˜¯å¯ä»¥å¼€ç®±å³ç”¨çš„ã€‚
å¦‚æœä½ æœ‰éå¸¸ç‰¹æ®Šçš„éœ€æ±‚ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æˆ‘ä»¬çš„æ³¨å…¥ç‚¹å»è¿›è¡Œå®šåˆ¶åŒ–æ“ä½œï¼Œæ¯”å¦‚ä½ å¯ä»¥è‡ªå®šä¹‰ä¸­é—´ä»¶å»è¿‡æ»¤æˆ–è€…æ‹¦æˆªè¯·æ±‚ï¼Œå®šä¹‰è·Ÿè¸ªå™¨å»æ³¨å…¥æ—¥å¿—ã€å»æ³¨å…¥æœåŠ¡å‘ç°ç­‰ã€‚
åœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸­ï¼Œå‡ ä¹ä¸€åˆ‡è·Ÿç­–ç•¥ç›¸å…³çš„ä¸œè¥¿éƒ½æ˜¯å¯ä»¥å®šåˆ¶çš„ã€‚&lt;/p>
&lt;p>ä»¥æœåŠ¡å‘ç°ä¸ºä¾‹ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ ¸å¿ƒåº“é‡Œå®šä¹‰äº†ä¸€ä¸ª Resolver interface ã€‚ä»»ä½•ä¸€ä¸ªå®ç°äº†è¿™å››ä¸ªæ–¹æ³•çš„ç±»å‹éƒ½å¯ä»¥ä½œä¸ºä¸€ä¸ªæœåŠ¡å‘ç°çš„ç»„ä»¶ï¼Œç„¶åæ³¨å…¥åˆ° &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ¥å–ä»£ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æœåŠ¡å‘ç°åŠŸèƒ½ã€‚
åœ¨ä½¿ç”¨æ—¶ï¼Œå®¢æˆ·ç«¯åªéœ€è¦åˆ›å»ºä¸€ä¸ª Resolver çš„å¯¹è±¡ï¼Œç„¶åé€šè¿‡ client.WithResolver æ³¨å…¥å®¢æˆ·ç«¯ï¼Œå°±å¯ä»¥ä½¿ç”¨è‡ªå·±å¼€å‘çš„æœåŠ¡å‘ç°ç»„ä»¶ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Resolver.png" alt="image">&lt;/p>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„ä¸€ä¸ªåˆ›æ–°ä¹‹å¤„æ˜¯ä½¿ç”¨ Suite æ¥æ‰“åŒ…è‡ªå®šä¹‰çš„åŠŸèƒ½ï¼Œæä¾›ä¸€é”®é…ç½®åŸºç¡€ä¾èµ–çš„ä½“éªŒã€‚&lt;/p>
&lt;p>å®ƒèƒ½åœ¨ä»€ä¹ˆåœ°æ–¹èµ·ä½œç”¨å‘¢ï¼Ÿä¾‹å¦‚ï¼Œä¸€ä¸ªå¤–éƒ¨ä¼ä¸šæƒ³è¦å¯ç”¨æˆ–è€…æ¥å…¥ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ï¼Œ å®ƒä¸å¯èƒ½æ‹¥æœ‰å­—èŠ‚è·³åŠ¨å†…éƒ¨çš„æ‰€æœ‰åŸºç¡€è®¾æ–½ã€‚é‚£ä¹ˆä¼ä¸šåœ¨ä½¿ç”¨çš„æ—¶å€™è‚¯å®šéœ€è¦å®šåˆ¶åŒ–ï¼Œä»–å¯èƒ½éœ€è¦å®šä¹‰è‡ªå·±çš„æ³¨å†Œä¸­å¿ƒã€è´Ÿè½½å‡è¡¡ã€è¿æ¥æ± ç­‰ç­‰ã€‚
å¦‚æœä¸šåŠ¡æ–¹è¦ä½¿ç”¨è¿™äº›åŠŸèƒ½çš„è¯ï¼Œå°±éœ€è¦åŠ å…¥éå¸¸éå¸¸å¤šçš„å‚æ•°ã€‚è€Œ Suite å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„ç±»ä¸€æ¬¡æ€§åŒ…è£…è¿™äº›åŠŸèƒ½ï¼Œç”±æ­¤ï¼Œä¸šåŠ¡æ–¹ä½¿ç”¨æ—¶ï¼Œä»ç„¶æ˜¯ä»¥å•ä¸€çš„å‚æ•°çš„æ–¹å¼æ·»åŠ ï¼Œååˆ†æ–¹ä¾¿ã€‚
åˆä¾‹å¦‚ï¼Œæˆ‘ç°åœ¨å¼€å‘ä¸€ä¸ªå« mysuite çš„ä¸œè¥¿ï¼Œæˆ‘å¯èƒ½æä¾›ä¸€ä¸ªç‰¹æ®Šçš„æœåŠ¡å‘ç°åŠŸèƒ½ï¼Œæä¾›äº†ä¸€ä¸ªæ‹¦æˆªçš„ä¸­é—´ä»¶ï¼Œè¿˜æœ‰è´Ÿè½½å‡è¡¡åŠŸèƒ½ç­‰ã€‚
ä¸šåŠ¡æ–¹ä½¿ç”¨æ—¶ï¼Œä¸éœ€è¦æ„ŸçŸ¥å¾ˆå¤šä¸œè¥¿å»é…ç½®ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª Suite å°±è¶³å¤Ÿäº†ï¼Œè¿™ç‚¹éå¸¸æ–¹ä¾¿ä¸€äº›ä¸­å°æ–¹æˆ–è€…ç¬¬ä¸‰æ–¹å»åšå®šåˆ¶ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Suite.png" alt="image">&lt;/p>
&lt;p align="center">
ç¤ºä¾‹
&lt;/p>
&lt;h4 id="å¤šåè®®">å¤šåè®®&lt;/h4>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ç½‘ç»œå±‚åŸºäºé«˜æ€§èƒ½ç½‘ç»œåº“ &lt;a href="https://github.com/cloudwego/netpoll">Netpoll&lt;/a> å®ç°ã€‚åœ¨ &lt;a href="https://github.com/cloudwego/netpoll">Netpoll&lt;/a> ä¸Šï¼Œæˆ‘ä»¬æ„å»ºäº† Thrift å’Œ Netpoll-http2ï¼›åœ¨ Thrift ä¸Šï¼Œæˆ‘ä»¬è¿˜åšäº†ä¸€äº›ç‰¹æ®Šçš„å®šåˆ¶ï¼Œä¾‹å¦‚ï¼Œæ”¯æŒ Thrift çš„æ³›åŒ–è°ƒç”¨ï¼Œè¿˜æœ‰åŸºäº Thrift çš„è¿æ¥å¤šè·¯å¤ç”¨ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Multi-protocol.png" alt="image">&lt;/p>
&lt;p align="center">
å¤šåè®®
&lt;/p>
&lt;h4 id="ä»£ç ç”Ÿæˆå·¥å…·">ä»£ç ç”Ÿæˆå·¥å…·&lt;/h4>
&lt;p>å’Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¸€åŒå‡ºç°çš„ï¼Œè¿˜æœ‰æˆ‘ä»¬å¼€å‘çš„ä¸€ä¸ªç®€å•æ˜“ç”¨çš„å‘½ä»¤è¡Œå·¥å…· kitexã€‚å¦‚æœæˆ‘ä»¬å†™äº†ä¸€ä¸ª IDLï¼Œåªéœ€è¦æä¾›ä¸€ä¸ª module å‚æ•°å’Œä¸€ä¸ªæœåŠ¡åç§°ï¼Œkitex å°±ä¼šä¸ºä½ ç”ŸæˆæœåŠ¡ä»£ç è„šæ‰‹æ¶ã€‚&lt;/p>
&lt;p>ç›®å‰ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ”¯æŒäº† Protobuf å’Œ Thrift è¿™ä¸¤ç§ IDL çš„å®šä¹‰ã€‚å‘½ä»¤è¡Œå·¥å…·å†…ç½®ä¸°å¯Œçš„é€‰é¡¹ï¼Œå¯ä»¥è¿›è¡Œé¡¹ç›®ä»£ç å®šåˆ¶ï¼›åŒæ—¶ï¼Œå®ƒåº•å±‚ä¾èµ– Protobuf å®˜æ–¹çš„ç¼–è¯‘å™¨ï¼Œå’Œæˆ‘ä»¬è‡ªç ”çš„ Thriftgo çš„ç¼–è¯‘å™¨ï¼Œä¸¤è€…éƒ½æ”¯æŒè‡ªå®šä¹‰çš„ç”Ÿæˆä»£ç æ’ä»¶ã€‚&lt;/p>
&lt;h3 id="kitex-çš„æ€§èƒ½è¡¨ç°">Kitex çš„æ€§èƒ½è¡¨ç°&lt;/h3>
&lt;p>å­—èŠ‚è·³åŠ¨å†…éƒ¨ RPC æ¡†æ¶ä½¿ç”¨çš„åè®®ä¸»è¦éƒ½æ˜¯åŸºäº Thriftï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ Thrift ä¸Šæ·±è€•å·²ä¹…ã€‚ç»“åˆè‡ªç ”çš„ &lt;a href="https://github.com/cloudwego/netpoll">Netpoll&lt;/a> èƒ½åŠ›ï¼Œå®ƒå¯ä»¥ç›´æ¥æš´éœ²åº•å±‚è¿æ¥çš„ bufferã€‚
åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è®¾è®¡å‡ºäº† FastRead/FastWrite ç¼–è§£ç å®ç°ï¼Œæµ‹è¯•å‘ç°å®ƒå…·æœ‰è¿œè¶…è¿‡ apache thrift ç”Ÿæˆä»£ç çš„æ€§èƒ½ã€‚æ•´ä½“è€Œè¨€ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ€§èƒ½ç›¸å½“ä¸é”™ï¼Œä»Šå¹´ 1 æœˆä»½çš„æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ
å¯ä»¥çœ‹åˆ°ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨ä½¿ç”¨ Thrift ä½œä¸º Payload çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¼˜äºå®˜æ–¹ gRPCï¼Œååæ¥è¿‘ gRPC çš„ä¸¤å€ï¼›æ­¤å¤–ï¼Œåœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä½¿ç”¨å®šåˆ¶çš„ Protobuf åè®®æ—¶ï¼Œæ€§èƒ½ä¹Ÿä¼˜äº gRPCã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Kitex_gRPC.png" alt="image">&lt;/p>
&lt;p align="center">
Kitex/gRPC æ€§èƒ½å¯¹æ¯”ï¼ˆ2022 å¹´ 1 æœˆæ•°æ®ï¼‰
&lt;/p>
&lt;h3 id="kitexä¸€ä¸ª-demo">Kitexï¼šä¸€ä¸ª demo&lt;/h3>
&lt;p>ä¸‹é¢ç®€å•æ¼”ç¤ºä¸€ä¸‹ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ˜¯å¦‚ä½•å¼€å‘ä¸€ä¸ªæœåŠ¡çš„ã€‚&lt;/p>
&lt;p>é¦–å…ˆï¼Œå®šä¹‰ IDLã€‚è¿™é‡Œä½¿ç”¨ Thrift ä½œä¸º IDL çš„å®šä¹‰ï¼Œç¼–å†™ä¸€ä¸ªåä¸º Demo çš„ serviceã€‚æ–¹æ³• Test çš„å‚æ•°æ˜¯ Stringï¼Œå®ƒçš„è¿”å›ä¹Ÿæ˜¯ Stringã€‚
ç¼–å†™å®Œè¿™ä¸ª demo.thrift æ–‡ä»¶ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨å‘½ä»¤è¡Œç”ŸæˆæŒ‡å®šçš„ç”Ÿæˆä»£ç ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œåªéœ€è¦ä¼ å…¥ module nameï¼Œservice name å’Œç›®æ ‡ IDL å°±è¡Œäº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/IDL.png" alt="image">&lt;/p>
&lt;p align="center">
å®šä¹‰ IDL
&lt;/p>
&lt;p>éšåï¼Œæˆ‘ä»¬éœ€è¦å¡«å……ä¸šåŠ¡é€»è¾‘ã€‚æ–‡ä»¶ä¸­é™¤äº†ç¬¬ 12 è¡Œï¼Œå…¨éƒ¨ä»£ç éƒ½æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å‘½ä»¤è¡Œå·¥å…·ç”Ÿæˆçš„ã€‚é€šå¸¸ä¸€ä¸ª RPC æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ª Responseï¼Œä¾‹å¦‚è¿™é‡Œéœ€è¦è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»™ Response èµ‹å€¼å³å¯ã€‚
æ¥ä¸‹æ¥éœ€è¦é€šè¿‡ go mod tidy æŠŠä¾èµ–æ‹‰ä¸‹æ¥ï¼Œç„¶åç”¨ build.sh æ„å»ºï¼Œå°±å¯ä»¥å¯åŠ¨æœåŠ¡äº†ã€‚&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> é»˜è®¤çš„æ¥å¬ç«¯å£æ˜¯ 8888ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Handler.png" alt="image">&lt;/p>
&lt;p align="center">
å®šä¹‰ Handler æ–¹æ³•
&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Compile_run.png" alt="image">&lt;/p>
&lt;p align="center">
ç¼–è¯‘ã€è¿è¡Œ
&lt;/p>
&lt;p>å¯¹äºåˆšåˆšå¯åŠ¨çš„æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„å®¢æˆ·ç«¯å»è°ƒç”¨å®ƒã€‚æœåŠ¡ç«¯å†™å®Œä¹‹åï¼Œå†™å®¢æˆ·ç«¯ä¹Ÿæ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚
è¿™é‡ŒåŒæ ·æ˜¯ import åˆšåˆšç”Ÿæˆçš„ç”Ÿæˆä»£ç ï¼Œåˆ›å»º Clientã€æŒ‡å®šæœåŠ¡åå­—ã€æ„æˆç›¸åº”çš„å‚æ•°ï¼Œå¡«ä¸Šâ€œ Helloï¼Œwordï¼â€ ï¼Œç„¶åå°±å¯ä»¥è°ƒç”¨äº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Client.png" alt="image">&lt;/p>
&lt;p align="center">
ç¼–å†™ Client
&lt;/p>
&lt;h2 id="kitex-åœ¨å­—èŠ‚å†…éƒ¨çš„è½åœ°">Kitex åœ¨å­—èŠ‚å†…éƒ¨çš„è½åœ°&lt;/h2>
&lt;h3 id="ä¸å†…éƒ¨åŸºç¡€è®¾æ–½çš„é›†æˆ">ä¸å†…éƒ¨åŸºç¡€è®¾æ–½çš„é›†æˆ&lt;/h3>
&lt;p>è°ˆåˆ°è½åœ°ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å’Œå­—èŠ‚è·³åŠ¨å†…éƒ¨çš„åŸºç¡€è®¾æ–½è¿›è¡Œç»“åˆã€‚å­—èŠ‚è·³åŠ¨å†…éƒ¨çš„æ‰€æœ‰åŸºç¡€è®¾æ–½éƒ½æ˜¯ä»¥ä¾èµ–çš„æ–¹å¼æ³¨å…¥åˆ° &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„ã€‚
æˆ‘ä»¬å°†æ—¥å¿—ã€ç›‘æ§ã€tracing éƒ½å®šä¹‰ä¸º tracerï¼Œç„¶åé€šè¿‡ WithTracer è¿™ä¸ª Option å°†å…¶æ³¨å…¥åˆ° &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> é‡Œï¼›æœåŠ¡å‘ç°æ˜¯ WithResolverï¼›Service Mesh åˆ™æ˜¯ WithProxy ç­‰ã€‚
å­—èŠ‚è·³åŠ¨å†…éƒ¨çš„åŸºç¡€è®¾æ–½éƒ½æ˜¯é€šè¿‡ Option è¢«æ³¨å…¥åˆ° &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„ï¼Œè€Œä¸”æ‰€æœ‰çš„ Option éƒ½æ˜¯é€šè¿‡å‰é¢è¯´çš„ Suite æ‰“åŒ…ï¼Œç®€å•åœ°æ·»åŠ åˆ°ä¸šåŠ¡çš„ä»£ç é‡Œå®Œæˆã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Integration.png" alt="image">&lt;/p>
&lt;p align="center">
ä¸å†…éƒ¨åŸºç¡€è®¾æ–½çš„é›†æˆ
&lt;/p>
&lt;h3 id="å†…éƒ¨è½åœ°çš„ç»å…¸æ¡ˆä¾‹åˆå¹¶éƒ¨ç½²">å†…éƒ¨è½åœ°çš„ç»å…¸æ¡ˆä¾‹ï¼šåˆå¹¶éƒ¨ç½²&lt;/h3>
&lt;p>è¿™é‡Œä»‹ç»ä¸€ä¸ªå†…éƒ¨è½åœ°çš„ç»å…¸æ¡ˆä¾‹ï¼šåˆå¹¶éƒ¨ç½²ã€‚å…¶èƒŒæ™¯æ˜¯ï¼Œåœ¨å¼€å‘å¾®æœåŠ¡æ—¶ï¼Œç”±äºä¸šåŠ¡æ‹†åˆ†å’Œä¸šåŠ¡åœºæ™¯çš„å¤šæ ·åŒ–ï¼Œå¾®æœåŠ¡å®¹æ˜“å‡ºç°è¿‡å¾®çš„æƒ…å†µã€‚
å½“æœåŠ¡æ•°é‡è¶Šæ¥è¶Šå¤šï¼Œç½‘ç»œä¼ è¾“å’Œåºåˆ—åŒ–å¼€é”€å°±ä¼šè¶Šæ¥è¶Šå¤§ï¼Œå˜å¾—ä¸å¯å¿½è§†ã€‚å› æ­¤ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ¡†æ¶éœ€è¦è€ƒè™‘å¦‚ä½•å‡å°ç½‘ç»œä¼ è¾“å’Œåºåˆ—åŒ–çš„å¼€é”€ã€‚&lt;/p>
&lt;p>å­—èŠ‚è·³åŠ¨åŸºç¡€æ¶æ„ç»è¿‡ä¸€ç³»åˆ—çš„æ¢ç´¢å’Œå®è·µï¼Œæœ€ç»ˆæ¨å‡ºäº†åˆå¹¶éƒ¨ç½²çš„æœºåˆ¶ã€‚&lt;strong>å®ƒçš„æ€è·¯&lt;/strong>æ˜¯ï¼šå°†æœ‰å¼ºä¾èµ–å…³ç³»çš„æœåŠ¡è¿›è¡ŒåŒæœºéƒ¨ç½²ï¼Œå‡å°‘å®ƒä»¬ä¹‹é—´çš„è°ƒç”¨å¼€é”€ã€‚ç†è®ºä¸Šè¯´èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œå®é™…è¿‡ç¨‹ä¸­éœ€è¦éå¸¸å¤šçš„ç»„ä»¶è¿›è¡Œé…åˆã€‚&lt;/p>
&lt;p>&lt;strong>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„åšæ³•&lt;/strong>æ˜¯ï¼šé¦–å…ˆï¼Œå®ƒä¼šä¾èµ–ä¸€å¥—ä¸­å¿ƒåŒ–çš„éƒ¨ç½²è°ƒåº¦å’Œæµé‡æ§åˆ¶ï¼›å…¶æ¬¡ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€å¥—åŸºäºå…±äº«å†…å­˜çš„é€šä¿¡åè®®ï¼Œå®ƒå¯ä»¥ä½¿å¾—æˆ‘ä»¬ä¸¤ä¸ªä¸åŒçš„æœåŠ¡åœ¨åŒä¸€å°æœºå™¨éƒ¨ç½²æ—¶ï¼Œä¸éœ€è¦é€šè¿‡ç½‘ç»œè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œç›´æ¥é€šè¿‡å…±äº«å†…å­˜ï¼Œå‡å°‘é¢å¤–çš„æ•°æ®æ‹·è´ã€‚&lt;/p>
&lt;p>åœ¨æœåŠ¡åˆå¹¶éƒ¨ç½²çš„æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹æ®Šçš„æœåŠ¡å‘ç°å’Œè¿æ¥æ± çš„å®ç°ã€å®šåˆ¶åŒ–çš„æœåŠ¡å¯åŠ¨å’Œç›‘å¬é€»è¾‘ã€‚è¿™äº›åœ¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ¡†æ¶é‡Œéƒ½æ˜¯é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼ç»™æ·»åŠ è¿›æ¥çš„ã€‚
&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æœåŠ¡åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¼šæ„ŸçŸ¥åˆ°æˆ‘ä»¬ PaaS å¹³å°æä¾›çš„æŒ‡å®šçš„ç¯å¢ƒå˜é‡ã€‚å½“å®ƒå¯Ÿè§‰åˆ°è‡ªå·±éœ€è¦æŒ‰åˆå¹¶éƒ¨ç½²çš„æ–¹å¼å¯åŠ¨ä¹‹åï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ªé¢„å…ˆæ³¨å…¥çš„ç‰¹å®š Suiteï¼Œéšåå°†ç›¸åº”çš„åŠŸèƒ½å…¨éƒ½æ·»åŠ è¿›æ¥å†å¯åŠ¨ï¼Œå°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„åˆå¹¶éƒ¨ç½²ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆï¼Œå®ƒçš„æ•ˆæœå¦‚ä½•å‘¢ï¼Ÿåœ¨ 2021 å¹´çš„å®è·µè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹æŠ–éŸ³çš„æŸä¸ªæœåŠ¡çº¦ 30% çš„æµé‡è¿›è¡Œäº†åˆå¹¶ï¼ŒæœåŠ¡ç«¯çš„ CPU çš„æ¶ˆè€—å‡å°‘äº† 19%ï¼Œ TP99 å»¶è¿Ÿä¸‹é™åˆ° 29%ï¼Œæ•ˆæœç›¸å½“æ˜¾è‘—ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Merge_deployment.png" alt="image">&lt;/p>
&lt;p align="center">
å†…éƒ¨è½åœ°çš„ç»å…¸æ¡ˆä¾‹ï¼šåˆå¹¶éƒ¨ç½²
&lt;/p>
&lt;h3 id="å¾®æœåŠ¡æ¡†æ¶æ¨è¿›çš„ç—›ç‚¹">å¾®æœåŠ¡æ¡†æ¶æ¨è¿›çš„ç—›ç‚¹&lt;/h3>
&lt;ul>
&lt;li>å‡çº§æ…¢&lt;/li>
&lt;/ul>
&lt;p>å¤§å®¶å¯èƒ½å¥½å¥‡ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨å­—èŠ‚è·³åŠ¨å†…éƒ¨æ¨å¹¿æ˜¯ä¸æ˜¯å¾ˆé¡ºç•…ï¼Ÿå…¶å®å¹¶ä¸æ˜¯ã€‚ä½œä¸ºä¸€ä¸ªç›¸å¯¹è€Œè¨€æ¯”è¾ƒæ–°çš„æ¡†æ¶ï¼Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å’Œå…¶å®ƒæ–°ç”Ÿé¡¹ç›®ä¸€æ ·ï¼Œåœ¨æ¨å¹¿çš„è¿‡ç¨‹ä¸­éƒ½ä¼šé‡åˆ°åŒæ ·çš„é—®é¢˜ã€‚
ç‰¹åˆ«æ˜¯ï¼Œ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä½œä¸ºä¸€ä¸ª RPC æ¡†æ¶ï¼Œæˆ‘ä»¬æä¾›ç»™ç”¨æˆ·çš„å…¶å®æ˜¯ä¸€ä¸ªä»£ç çš„ SDK, æˆ‘ä»¬çš„æ›´æ–°æ˜¯éœ€è¦ä¸šåŠ¡æ–¹çš„ç”¨æˆ·å»æ„ŸçŸ¥ã€å‡çº§ã€éƒ¨ç½²ä¸Šçº¿ï¼Œæ‰èƒ½æœ€ç»ˆä½“ç°åœ¨ä»–ä»¬çš„æœåŠ¡é€»è¾‘é‡Œï¼Œå› æ­¤å…·æœ‰å‡çº§æ…¢çš„é—®é¢˜ã€‚&lt;/p>
&lt;ul>
&lt;li>å¬å›æ…¢&lt;/li>
&lt;/ul>
&lt;p>åŒæ—¶ï¼Œå› ä¸ºä»£ç éƒ½æ˜¯ç”±ç ”å‘äººå‘˜ç¼–å†™ï¼Œå¦‚æœä»£ç å‡ºç°äº† bugï¼Œæˆ‘ä»¬å°±éœ€è¦åŠæ—¶åœ°å»æ„ŸçŸ¥å®šä½é—®é¢˜ï¼Œé€šçŸ¥è´Ÿè´£äººå»æ›´æ–°ç‰ˆæœ¬ã€‚å› æ­¤ï¼Œä¼šæœ‰å¬å›æ…¢çš„é—®é¢˜ã€‚&lt;/p>
&lt;ul>
&lt;li>é—®é¢˜æ’æŸ¥å›°éš¾&lt;/li>
&lt;/ul>
&lt;p>ä¸šåŠ¡æ–¹çš„ç”¨æˆ·åœ¨å†™ä»£ç æ—¶ï¼Œä»–ä»¬å…¶å®å¾€å¾€å…³æ³¨çš„æ˜¯è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œä»–ä»¬ä¸ä¼šæ·±å…¥ç†è§£ä¸€ä¸ªæ¡†æ¶å†…éƒ¨çš„å®ç°ã€‚æ‰€ä»¥å¦‚æœå‡ºç°é—®é¢˜ï¼Œä»–ä»¬å¾€å¾€ä¼šä¸çŸ¥æ‰€æªï¼Œéœ€è¦ä¾èµ–æˆ‘ä»¬çš„ä¸šåŠ¡åŒå­¦æ‰èƒ½è¿›è¡Œç›¸åº”çš„é—®é¢˜æ’æŸ¥ã€‚æ‰€ä»¥ä¼šæœ‰é—®é¢˜æ’æŸ¥å›°éš¾çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>é’ˆå¯¹&lt;strong>å‡çº§æ…¢&lt;/strong>ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ“ä½œã€‚ä¸€æ˜¯ï¼Œä»£ç ç”Ÿæˆå·¥å…·æ”¯æŒè‡ªåŠ¨æ›´æ–°ï¼šå½“ç”¨æˆ·åœ¨ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥æœ€æ–°ç‰ˆæœ¬ï¼Œç„¶åç›´æ¥å°†æˆ‘ä»¬çš„ç‰ˆæœ¬æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™æ ·å¯ä»¥åŠæ—¶æŠŠæˆ‘ä»¬çš„æ¡†æ¶æ–° featureã€bug fix ç›´æ¥æ¨é€åˆ°ä¸šåŠ¡æ–¹ï¼›
äºŒæ˜¯ï¼Œç”¨æˆ·ç¾¤å‘ç‰ˆå‘¨çŸ¥ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡ åƒäººçš„ç”¨æˆ·ç¾¤ï¼Œå½“æœ‰äº†æ–°ç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä¼šåœ¨ç”¨ç¾¤é‡Œå‘¨çŸ¥ï¼Œå¯ä»¥æœ€å¤§èŒƒå›´çš„è¦†ç›–åˆ°æˆ‘ä»¬çš„ç›®æ ‡ç”¨æˆ·ã€‚&lt;/p>
&lt;p>é’ˆå¯¹&lt;strong>å¬å›æ…¢&lt;/strong>ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªæ“ä½œã€‚ä¸€æ˜¯ï¼Œæˆ‘ä»¬åœ¨çº¿ä¸Šå»ºç«‹å®Œæ•´çš„ç‰ˆæœ¬åˆ†å¸ƒç»Ÿè®¡ï¼Œç›‘æ§æ‰€æœ‰æœåŠ¡ä¸Šçº¿éƒ¨ç½²çš„æ¡†æ¶çš„ç‰ˆæœ¬ï¼›
äºŒæ˜¯ï¼Œæˆ‘ä»¬ä¼šè·Ÿ PaaS å¹³å°åˆä½œï¼Œåœ¨æœåŠ¡ä¸Šçº¿æ—¶è¿›è¡Œå¡ç‚¹æ“ä½œï¼Œæ£€æŸ¥å®ƒä»¬ä½¿ç”¨çš„æ¡†æ¶ç‰ˆæœ¬æ˜¯ä¸æ˜¯æœ‰ bugï¼Œæ˜¯å¦éœ€è¦æ‹¦æˆªï¼›ä¸‰æ˜¯ï¼Œé’ˆå¯¹æœ‰é—®é¢˜çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä¼šåŠæ—¶å°ç¦ï¼ŒåŠæ—¶æ¨åŠ¨ç”¨æˆ·æ›´æ–°ã€‚&lt;/p>
&lt;p>é’ˆå¯¹&lt;strong>é—®é¢˜æ’æŸ¥å›°éš¾&lt;/strong>ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ“ä½œã€‚ä¸€æ˜¯ï¼Œæˆ‘ä»¬ç§¯ç´¯äº†éå¸¸ä¸°å¯Œçš„ Wiki å’Œé—®é¢˜æ’æŸ¥æ‰‹å†Œï¼Œä¾‹å¦‚è¶…æ—¶é—®é¢˜ã€ åè®®è§£æé—®é¢˜ç­‰ã€‚
äºŒæ˜¯ï¼Œå¦‚æœé‡åˆ°éš¾ä»¥è§£å†³çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨çº¿ä¸ŠæœåŠ¡é»˜è®¤å¼€å¯äº† Debug ç«¯å£ï¼Œä¿è¯æ¡†æ¶å¼€å‘åŒå­¦å¯ä»¥ç¬¬ä¸€æ—¶é—´èµ¶åˆ°ç°åœºå»æ’æŸ¥ã€‚&lt;/p>
&lt;h2 id="kitex-åœ¨å­—èŠ‚å†…éƒ¨çš„å‘å±•">Kitex åœ¨å­—èŠ‚å†…éƒ¨çš„å‘å±•&lt;/h2>
&lt;p>æ•°æ®æ˜¾ç¤ºï¼Œåœ¨ 2020 å¹´ï¼Œv1.0 ç‰ˆæœ¬å‘å¸ƒçš„åˆå§‹é˜¶æ®µï¼Œç”¨æˆ·çš„æ¥å—åº¦æ¯”è¾ƒä½ã€‚ç›´åˆ° 2020 å¹´ 6 æœˆï¼Œçº¿ä¸Šæ¥å— &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> çš„æ•°é‡è¿˜ä¸åˆ° 1000ã€‚
éšåè¿›å…¥å¿«é€Ÿå‘å±•çš„é˜¶æ®µï¼Œåˆ° 2021 å¹´å¹´åˆï¼Œç´¯ç§¯æ¥è¿‘ 1w+ çš„æœåŠ¡å¼€å§‹ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚2021 å¹´åº•ï¼Œ4w+æœåŠ¡ä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/Evolution_Kitex_High-performance/Number_of_AccessServices.png" alt="image">&lt;/p>
&lt;h2 id="kitex-çš„å¼€æºå®è·µ">Kitex çš„å¼€æºå®è·µ&lt;/h2>
&lt;p>å¼€æºå·¥ä½œä¸»è¦åŒ…æ‹¬ä»£ç ã€æ–‡æ¡£å’Œç¤¾åŒºè¿è¥ä¸‰ä¸ªå±‚é¢ã€‚&lt;/p>
&lt;p>&lt;strong>ä»£ç å±‚é¢&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ä»£ç æ‹†åˆ†ã€è„±æ•ï¼›&lt;/li>
&lt;li>å†…éƒ¨ä»“åº“å¼•ç”¨å¼€æºä»“åº“ï¼Œé¿å…å†…å¤–å¤šå‰¯æœ¬åŒæ—¶ç»´æŠ¤ï¼›&lt;/li>
&lt;li>åœ¨å¼€æºè¿‡ç¨‹ä¸­ç¡®ä¿å†…éƒ¨ç”¨æˆ·å¹³æ»‘åˆ‡æ¢ã€ä½“éªŒæ— æŸï¼›&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>æ–‡æ¡£å±‚é¢&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>é‡æ–°æ¢³ç†ç”¨æˆ·æ–‡æ¡£ï¼Œè¦†ç›–æ–¹æ–¹é¢é¢ï¼›&lt;/li>
&lt;li>å»ºç«‹è¯¦å°½çš„ç”¨ä¾‹ä»“åº“(CloudWeGo/Kitex-examples)ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ç¤¾åŒºè¿è¥&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>å®˜ç½‘å»ºè®¾ï¼›&lt;/li>
&lt;li>ç»„å»ºç”¨æˆ·ç¾¤ï¼Œè¿›è¡Œç­”ç–‘è§£æƒ‘ï¼›&lt;/li>
&lt;li>é£ä¹¦æœºå™¨äººå¯¹æ¥ Github çš„ Issue ç®¡ç†ã€PR ç®¡ç†ä¹‹ç±»çš„ä¸šåŠ¡ï¼Œå¯ä»¥å¿«é€Ÿå“åº”ï¼›&lt;/li>
&lt;li>å¯¹ä¼˜ç§€è´¡çŒ®è€…è¿›è¡Œå¥–åŠ±ã€‚&lt;/li>
&lt;/ul>
&lt;p>åœ¨ä»¥ä¸ŠåŠªåŠ›ä¸‹ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">CloudWeGo/Kitex&lt;/a> ä»“åº“ç›®å‰æ”¶è·äº† 4.1k+ starsï¼›&lt;a href="https://github.com/kitex-contrib">kitex-contrib&lt;/a> è·å¾—å¤šä¸ªå¤–éƒ¨ç”¨æˆ·è´¡çŒ®çš„ä»“åº“ï¼›CloudWeGo é£ä¹¦ç”¨æˆ·ç¾¤è¿‘ 950 ä¸ªç”¨æˆ·â€¦â€¦&lt;/p>
&lt;h2 id="æœªæ¥å±•æœ›">æœªæ¥å±•æœ›&lt;/h2>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬ä»ç„¶ä¼šæŒç»­å‘å¼€æºç¤¾åŒºåé¦ˆæœ€æ–°çš„æŠ€æœ¯è¿›å±•ã€‚ä¾‹å¦‚åœ¨ Thrift åè®®ä¸Šï¼Œè™½ç„¶å¯¹ Thrift çš„ç¼–è§£ç å·²ç»åšåˆ°éå¸¸æè‡´çš„ä¼˜åŒ–äº†ï¼Œæˆ‘ä»¬è¿˜åœ¨æ¢ç´¢åˆ©ç”¨ JIT æ‰‹æ®µæ¥æä¾›æ›´å¤šçš„æ€§èƒ½æå‡ï¼›
åœ¨ Protobuf ä¸Šï¼Œæˆ‘ä»¬ä¼šè¡¥è¶³çŸ­æ¿ï¼Œå°†åœ¨ Thrift æ–¹é¢çš„ä¼˜åŒ–ç»éªŒè¿ç§»åˆ° Protobuf ä¸Šï¼Œå¯¹ Protobuf çš„ç”Ÿæˆä»£ç å’Œç¼–è§£ç è¿›è¡Œä¼˜åŒ–ï¼› &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åç»­ä¹Ÿä¼šè¿›ä¸€æ­¥èå…¥äº‘åŸç”Ÿç¤¾åŒºï¼Œæ‰€ä»¥ä¹Ÿåœ¨è€ƒè™‘æ”¯æŒ xDS åè®®ã€‚
å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¼šå»æ‹“å±•æ›´å¤šçš„å¼€æºç»„ä»¶ï¼Œå»å¯¹æ¥ç°å­˜çš„äº‘åŸç”Ÿç¤¾åŒºçš„å„ç§å¸¸ç”¨çš„æˆ–è€…çƒ­é—¨ç»„ä»¶ã€‚æœ€åï¼Œæˆ‘ä»¬ä¹Ÿä¼šå°è¯•å»å¯¹æ¥æ›´å¤šçš„å…¬æœ‰äº‘åŸºç¡€è®¾æ–½ï¼Œä½¿å¾—ç”¨æˆ·åœ¨å…¬æœ‰äº‘ä¸Šä½¿ç”¨ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ—¶èƒ½å¤Ÿæ‹¥æœ‰æ„‰æ‚¦çš„ä½“éªŒã€‚&lt;/p></description></item><item><title>Blog: Kitex v0.3.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/04/29/kitex-v0.3.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Fri, 29 Apr 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/04/29/kitex-v0.3.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="feature">Feature&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/366">#366&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/426">#426&lt;/a> ] åŠŸèƒ½(client): å®¢æˆ·ç«¯æ”¯æŒé¢„çƒ­æ“ä½œ&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/395">#395&lt;/a> ] åŠŸèƒ½(mux): è¿æ¥å¤šè·¯å¤ç”¨æ”¯æŒä¼˜é›…å…³é—­&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/399">#399&lt;/a> ] åŠŸèƒ½(protobuf): å®šä¹‰ fastpb protocol API å¹¶åœ¨ç¼–è§£ç æ¨¡å—å¯¹åº”æ”¯æŒ&lt;/li>
&lt;/ul>
&lt;h2 id="optimise">Optimise&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/402">#402&lt;/a> ] ä¼˜åŒ–(connpool): å¯¼å‡º pkg/remote/connpool é‡Œçš„ getCommonReporter&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/389">#389&lt;/a> ] ä¼˜åŒ–(rpcinfo)ï¼šå¡«å……ç”± defaultCodec è§£ç å¾—åˆ°çš„ rpcinfo ä¸­ç¼ºå¤±çš„ Invocation().PackageName, Invocation().ServiceName and Config().TransportProtocol å­—æ®µ&lt;/li>
&lt;/ul>
&lt;h2 id="bugfix">Bugfix&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/413">#413&lt;/a> ] ä¿®å¤(mux): åœ¨ NetpollMux transHandler ä¸­è®¾ç½® sendMsgçš„PayloadCodecï¼Œä»¥ä¿®å¤æ³›åŒ–è¯·æ±‚ç¼–ç æŠ¥é”™é—®é¢˜&lt;a href="https://github.com/cloudwego/kitex/issues/411">issue #411&lt;/a>&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/406">#406&lt;/a> ] ä¿®å¤(grpc): ä¿®å¤ http2 framer çš„è¯»å†™é€»è¾‘ï¼Œä¾‹å¦‚é¿å…å¯¹ç«¯æ— æ³•åŠæ—¶æ”¶åˆ° framer&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/398">#398&lt;/a> ] ä¿®å¤(utils)ï¼šä¿®å¤äº† Dump() æ¥å£æ— æ³• dump å‡º ring é‡Œæ‰€æœ‰æ•°æ®çš„ bug&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/428">#428&lt;/a> ] ä¿®å¤(trans)ï¼šå½“å†™å…¥å¤±è´¥æ—¶ï¼Œå…³é—­è¿æ¥ä»¥é¿å…å†…å­˜æ³„æ¼&lt;/li>
&lt;/ul>
&lt;h2 id="tool">Tool&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/340">#340&lt;/a> ] tool(protobuf): é‡æ–°è®¾è®¡å¹¶å®ç° Protobuf ç”Ÿæˆä»£ç ï¼Œä¸ä½¿ç”¨åå°„å®Œæˆç¼–è§£ç ï¼Œå½“å‰ä»…æ”¯æŒ proto3&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/396">#396&lt;/a> ] chore: ç”¨ bytedance/gopkg é‡Œçš„ xxhash3 æ›¿æ¢æ‰ cespare/xxhash&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/400">#400&lt;/a> ] chore: å‡çº§ workflow çš„ go ç‰ˆæœ¬åˆ° 1.18&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/407">#407&lt;/a> ] chore: å•ç‹¬å¢åŠ æ–‡ä»¶å¯¹ grpc æºç ä½¿ç”¨åšå£°æ˜&lt;/li>
&lt;/ul>
&lt;h2 id="test">Test&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/401">#401&lt;/a> ] test: è¡¥å…… kitex/server çš„å•æµ‹&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/393">#393&lt;/a> ] test: è¡¥å…… pkg/remote/bound package å•æµ‹&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/403">#403&lt;/a> ] test: è¡¥å…… netpollmux package å•æµ‹&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/401">#401&lt;/a> ] test: è¡¥å…… klog package å•æµ‹&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/392">#392&lt;/a> ] test: è¡¥å…… utils package å•æµ‹&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/373">#373&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/432">#432&lt;/a>, &lt;a href="https://github.com/cloudwego/kitex/pull/434">#434&lt;/a> ] test: è¡¥å…… gRPC transport éƒ¨åˆ†çš„å•æµ‹ï¼Œå•æµ‹è¦†ç›–ç‡æå‡åˆ° 76%&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/424">#424&lt;/a> ] test: è¡¥å…… transmeta å®ç° handler çš„å•å…ƒæµ‹è¯•&lt;/li>
&lt;/ul>
&lt;h2 id="dependency-change">Dependency Change&lt;/h2>
&lt;ul>
&lt;li>github.com/cloudwego/netpoll: v0.2.0 -&amp;gt; v0.2.2&lt;/li>
&lt;li>github.com/bytedance/gopkg: 20210910103821-e4efae9c17c3 -&amp;gt; 20220413063733-65bf48ffb3a7&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.2.1 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/03/24/kitex-v0.2.1-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Thu, 24 Mar 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/03/24/kitex-v0.2.1-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="bugfix">Bugfix&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/383">#383&lt;/a> ] ä¿®å¤(generic)ï¼šåœ¨æ³›åŒ–è°ƒç”¨çš„æ—¶å€™æ£€æŸ¥ IDL æ˜¯å¦æœ‰å¾ªç¯ä¾èµ–ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/359">#359&lt;/a> ] ä¿®å¤(tool)ï¼šä¿®å¤ protobuf CombineService ç¼ºå¤± streaming å¼•ç”¨çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/363">#363&lt;/a> ] ä¿®å¤(client)ï¼šä¿®å¤ oneway è¯·æ±‚çš„ sequence ID æ²¡æœ‰è¢«ç¼–ç çš„é—®é¢˜ä»¥åŠé™ä½ oneway è°ƒç”¨çš„ä¸¢åŒ…ç‡ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/367">#367&lt;/a> ] ä¿®å¤(generic/tool)ï¼šä¿®å¤ CombineServices å¯èƒ½å­˜åœ¨å¤šæ¬¡åŠ è½½åŒä¸€ä¸ª service é—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="optimise">Optimise&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/362">#362&lt;/a> ] ä¼˜åŒ–(diagnosis)ï¼šlbcaches æ˜¯å…¨å±€çš„ï¼Œæ— éœ€ä¸ºæ¯ä¸ª client æ³¨å†Œ ProbeFunc ç”¨äºè¯Šæ–­æŸ¥è¯¢ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/374">#374&lt;/a> ] ä¼˜åŒ–(rpcinfo)ï¼šRPCInfo.To().Tag() ä¼˜å…ˆä½¿ç”¨æœåŠ¡å‘ç°çš„ instance tag è€Œä¸æ˜¯ remoteinfo tagã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/355">#355&lt;/a> ] ä¼˜åŒ–(è¿æ¥æ± )ï¼šä¿®æ”¹é»˜è®¤çš„è¿æ¥æ± æœ€å°ç©ºé—²ç­‰å¾…æ—¶é—´ä¸º 2sã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/354">#354&lt;/a> ] ä¼˜åŒ–(hook)ï¼šä¸º &lt;code>onServerStart&lt;/code>å’Œ &lt;code>onShutdown&lt;/code>æ·»åŠ èµ„æºé”ï¼Œå½“åšä¸€äº›å¦‚&lt;code>RegisterStartHook&lt;/code>å’Œ &lt;code>server.Run&lt;/code>ä¸­çš„ &lt;code>range&lt;/code>ä¹‹ç±»çš„è¯»å†™æ“ä½œæ—¶è¯·æ±‚å¯¹åº”çš„èµ„æºé”ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/331">#331&lt;/a> ] ä¼˜åŒ–(discovery)ï¼šå¢åŠ ã€Œå®ä¾‹ä¸å­˜åœ¨ã€é”™è¯¯å®šä¹‰ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="refactor">Refactor&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/352">#352&lt;/a> ] é‡æ„(event)ï¼šåˆ é™¤é¢å¤–çš„åŸå­æ“ä½œå¹¶ç”¨æ™®é€šèµ‹å€¼æ“ä½œæ›¿æ¢ã€‚&lt;/li>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/343">#343&lt;/a> ] é‡æ„(loadbalancer)ï¼šå°† buildWeightedVirtualNodes å‡½æ•°åˆå…¥ buildVirtualNodes å‡½æ•°ä¸­ï¼Œæˆä¸ºä¸€ä¸ªå‡½æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/376">#376&lt;/a> ] å‡çº§ä¾èµ– choleraehyq/pid ä»¥å…¼å®¹Go 1.18ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="docs">Docs&lt;/h2>
&lt;ul>
&lt;li>[&lt;a href="https://github.com/cloudwego/kitex/pull/364">#364&lt;/a> ] æ›´æ–° README åˆ°æ–°åšå®¢çš„é“¾æ¥ã€‚&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.2.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/02/24/kitex-v0.2.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Thu, 24 Feb 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/02/24/kitex-v0.2.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="feature">Feature&lt;/h2>
&lt;ul>
&lt;li>Feat(grpc): gRPC ç›¸å…³é…ç½®æ”¯æŒé€šè¿‡ options æ¥è®¾ç½®ï¼Œå¹¶ä¸”ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬é»˜è®¤çª—å£å¤§å°è°ƒæ•´ä¸º 64K&lt;/li>
&lt;li>Feat(kerror): ä¸º basicError æ·»åŠ æ–°çš„ error å°è£… func WithCauseAndExtraMsg&lt;/li>
&lt;li>Feat(rpcinfo): æ·»åŠ  FreezeRPCInfo ä»¥æ”¯æŒå¼‚æ­¥ context ä½¿ç”¨&lt;/li>
&lt;li>Feat(codec): é»˜è®¤ç¼–è§£ç å™¨æ”¯æŒé™å®šåŒ…ä½“ç§¯å¤§å°&lt;/li>
&lt;/ul>
&lt;h2 id="bugfix">Bugfix&lt;/h2>
&lt;ul>
&lt;li>Fix(remotecli): ä¿®å¤é‡ç½®çš„è¿æ¥å¯èƒ½è¢«å¤ç”¨çš„é—®é¢˜&lt;/li>
&lt;li>Fix(generic): ä¿®å¤æ³›åŒ–è°ƒç”¨çš„å®¢æˆ·ç«¯ä¸èƒ½ä½¿ç”¨ç»§æ‰¿çš„ service çš„æ–¹æ³•çš„é—®é¢˜&lt;/li>
&lt;li>Fix(generic): ä¿®å¤æ³›åŒ–è°ƒç”¨ client ä¾§åˆ¤æ–­ Oneway ä¸å‡†ç¡®çš„é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h2 id="optimise">Optimise&lt;/h2>
&lt;ul>
&lt;li>Optimize(retry): æé«˜å¼‚å¸¸é‡è¯•çš„é‡è¯•æˆåŠŸç‡
&lt;blockquote>
&lt;p>å¦‚æœè¶…æ—¶çš„è¯·æ±‚å…ˆäºé‡è¯•çš„è¯·æ±‚è¿”å›ï¼Œå¯èƒ½ä¼šå¯¼è‡´é‡è¯•è¯·æ±‚ä¹Ÿå¤±è´¥ï¼›åŒæ—¶ä¹Ÿå¯ä»¥é¿å…è¶…æ—¶è¯·æ±‚ä¸å¿…è¦çš„è§£ç å¤„ç†ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;ul>
&lt;li>Chore: å‡çº§ netpoll çš„ç‰ˆæœ¬è‡³ v0.2.0&lt;/li>
&lt;li>Chore: æ·»åŠ ç¬¬ä¸‰æ–¹åº“çš„license&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.1.4 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2022/01/18/kitex-v0.1.4-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Tue, 18 Jan 2022 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2022/01/18/kitex-v0.1.4-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="åŠŸèƒ½ä¼˜åŒ–">åŠŸèƒ½ä¼˜åŒ–&lt;/h2>
&lt;ul>
&lt;li>åœ¨ rpctimeout çš„ middleware çš„è¾“å‡ºæ—¥å¿—ä¸­è¿‡æ»¤æ‰è¶…æ—¶æ—¥å¿—&lt;/li>
&lt;li>è°ƒæ•´é»˜è®¤æ—¥å¿—çº§åˆ«ä¸º Info&lt;/li>
&lt;li>ç»™ sentAt å˜é‡åŠ é”ï¼Œé¿å…å•æµ‹å‡ºç° DATA RACEï¼Œå®é™…ä¸Šä¸ä¼šæœ‰å¹¶å‘é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤å®¢æˆ·ç«¯ç¼–ç å¤±è´¥æ—¶è¿æ¥ä¼šæ³„æ¼çš„é—®é¢˜&lt;/li>
&lt;li>ä¿®å¤ middleware builder ä¸­è®¾ç½® TimeoutAdjust ä¸ç”Ÿæ•ˆçš„é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h2 id="å·¥å…·">å·¥å…·&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤ protobuf çš„ handler å‚æ•°å
&lt;blockquote>
&lt;p>kitex ä¼šç»™æ¯ä¸ª stream server ç”Ÿæˆä¸€ä¸ªåä¸º &amp;ldquo;{{.ServiceName}}&lt;em>{{.Name}}Server&amp;rdquo; çš„ stream ç±»å‹ï¼Œ
ä½†æ˜¯åœ¨ handler.go ä¸­ä½¿ç”¨çš„æ˜¯ &amp;ldquo;{{.ServiceName}}&lt;/em>{{.RawName}}Server&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;ul>
&lt;li>åˆ é™¤ä¸å¿…è¦çš„ç±»å‹è½¬æ¢&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.1.3 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/12/30/kitex-v0.1.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Thu, 30 Dec 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/12/30/kitex-v0.1.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="åŠŸèƒ½ä¼˜åŒ–">åŠŸèƒ½ä¼˜åŒ–&lt;/h2>
&lt;ul>
&lt;li>JSON æ³›åŒ–è°ƒç”¨åœºæ™¯ï¼Œå‘æœåŠ¡ç«¯ä¼ é€’ Base ä¿¡æ¯ï¼Œä»è€ŒæœåŠ¡ç«¯å¯è·å– Caller ç­‰ä¿¡æ¯&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤ streaming çš„ metric ä¸ŠæŠ¥ï¼ˆserverä¾§ï¼‰ä¸¢å¤± method ä¿¡æ¯çš„é—®é¢˜&lt;/li>
&lt;li>ä¿®å¤ JSON å’Œ HTTP æ³›åŒ–ä¸­ base64 å’Œ binary çš„ä¸å…¼å®¹æ”¹åŠ¨&lt;/li>
&lt;li>ä¿®å¤ gRPC æµæ§ç›¸å…³çš„é—®é¢˜ï¼Œè¯¥é—®é¢˜ä¼šå¯¼è‡´ client ä¾§å‡ºç°æŒç»­è¶…æ—¶&lt;/li>
&lt;/ul>
&lt;h2 id="ci">CI&lt;/h2>
&lt;ul>
&lt;li>å¢åŠ åœºæ™¯æµ‹è¯•&lt;/li>
&lt;/ul>
&lt;h2 id="chore">Chore&lt;/h2>
&lt;ul>
&lt;li>æ›´æ–°äº† &lt;a href="https://github.com/cloudwego/kitex/blob/develop/ROADMAP.md">ROADMAP&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.1.2 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/12/22/kitex-v0.1.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Wed, 22 Dec 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/12/22/kitex-v0.1.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="hotfix">Hotfix&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤ v0.1.0 gRPC è¯·æ±‚ä¼˜åŒ–å¼•å…¥çš„éƒ¨åˆ†é—®é¢˜&lt;/li>
&lt;li>ä¿®å¤ IDL ä¸­æœªå®šä¹‰ package æ—¶ï¼ŒgRPC çš„æ–¹æ³•ä¿¡æ¯é”™è¯¯é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h2 id="ä¾èµ–æ›´æ–°">ä¾èµ–æ›´æ–°&lt;/h2>
&lt;ul>
&lt;li>æ›´æ–° netpoll-http2 ä¾èµ–ï¼Œè§£å†³ streaming åœºæ™¯ä¸‹å¤§åŒ…ï¼ˆ&amp;gt;4Kï¼‰è¯·æ±‚æŠ¥é”™çš„é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h2 id="æ‚é¡¹">æ‚é¡¹&lt;/h2>
&lt;ul>
&lt;li>ä½¿ç”¨ GitHub çš„ PR æ¨¡æ¿ï¼Œå¼ºåˆ¶å¼€å‘è€…æäº¤ PR æ—¶å¡«å†™ç›¸å…³æè¿°&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.1.0 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/12/13/kitex-v0.1.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Mon, 13 Dec 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/12/13/kitex-v0.1.0-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="åŠŸèƒ½">åŠŸèƒ½&lt;/h2>
&lt;h3 id="æ³›åŒ–è°ƒç”¨">æ³›åŒ–è°ƒç”¨&lt;/h3>
&lt;ul>
&lt;li>IDL è§£ææ”¯æŒå¤š Service&lt;/li>
&lt;li>æš´éœ² SetSeqID æ–¹æ³•ä¾¿äºäºŒè¿›åˆ¶æ³›åŒ–åœºæ™¯ server ä¾§ä½¿ç”¨&lt;/li>
&lt;li>æ³›åŒ– client æ”¯æŒå…³é—­ï¼Œè§„é¿å†…å­˜æ³„æ¼é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h3 id="æ—¥å¿—">æ—¥å¿—&lt;/h3>
&lt;ul>
&lt;li>ä¿®æ”¹æ—¥å¿—é£æ ¼ï¼Œä½¿ç”¨ &amp;ldquo;key=value&amp;rdquo; åˆ—å‡ºä¿¡æ¯&lt;/li>
&lt;li>ä½¿ç”¨ klog ä½œä¸ºå…¨å±€çš„æ—¥å¿—è¾“å‡ºå·¥å…·&lt;/li>
&lt;li>ä½¿ç”¨å…¨å±€çš„ default logger&lt;/li>
&lt;li>æ—¥å¿—æ‰“å°æ›´å¤š context ä¿¡æ¯ï¼Œä¾‹å¦‚ logIdï¼Œæ–¹ä¾¿é—®é¢˜æ’æŸ¥&lt;/li>
&lt;li>go func ä¼ å…¥æœåŠ¡ä¿¡æ¯ç”¨äº recover panic åè¾“å‡ºå…³é”®ä¿¡æ¯æ–¹ä¾¿é—®é¢˜æ’æŸ¥&lt;/li>
&lt;/ul>
&lt;h3 id="option">Option&lt;/h3>
&lt;ul>
&lt;li>å¢åŠ  NewThriftCodecDisableFastMode æ–¹æ³•ï¼Œæ¥å…³é—­ FastWrite å’Œ FastRead&lt;/li>
&lt;li>Kitex server æ”¯æŒç«¯å£å¤ç”¨&lt;/li>
&lt;li>é»˜è®¤ RPC è¶…æ—¶è®¾ç½®ä¸º 0ï¼ˆåœ¨åç»­ PR ä¸­ï¼Œrevert äº†è¯¥å˜æ›´ï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="proxy">Proxy&lt;/h3>
&lt;ul>
&lt;li>Proxy å¢åŠ  ContextHandler æ¥å£ç”¨äºä¼ é€’åˆå§‹åŒ–ctxç»™ mwbuilder&lt;/li>
&lt;li>æ³¨å†Œ lbcache çš„ Dump ç»™ diagnosisï¼Œç”¨äºé—®é¢˜è¯Šæ–­&lt;/li>
&lt;li>å°† PRCConfig ä¼ é€’ç»™ proxy.Config&lt;/li>
&lt;/ul>
&lt;h2 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h2>
&lt;ul>
&lt;li>å‡å°‘äº†å¯¹è±¡çš„å †åˆ†é…&lt;/li>
&lt;li>ä¼˜åŒ–å¤šè·¯å¤ç”¨æ€§èƒ½&lt;/li>
&lt;li>ä¼˜åŒ– grpc ç¼–è§£ç æ€§èƒ½ï¼Œé€šè¿‡ Release æ—¶é‡Šæ”¾(Close) LinkBuffer&lt;/li>
&lt;li>åœ¨è®¡ç®— backup request çš„æ¶ˆè€—(cost)æ—¶ï¼ŒåŒºåˆ† ErrRPCFinish&lt;/li>
&lt;li>å¤šè·¯å¤ç”¨åˆ†ç‰‡é˜Ÿåˆ—é€»è¾‘ç§»åŠ¨è‡³ netpoll/muxï¼Œå¹¶é‡å‘½ååˆ†ç‰‡å­—å…¸&lt;/li>
&lt;li>ä¼˜åŒ–Fast apiä¸­å®¹å™¨ç±»å‹çš„é•¿åº¦ç¼–ç é€»è¾‘&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤ server ç«¯ WithErrorHandler é…ç½®ä¸ç”Ÿæ•ˆé—®é¢˜&lt;/li>
&lt;li>è°ƒæ•´ lbcache ä¸­çš„ Balancer åˆå§‹åŒ–é€»è¾‘&lt;/li>
&lt;li>ä¿®å¤ TraceCtl å¯èƒ½ä¸º nil çš„é—®é¢˜(ä»…å½±å“å•æµ‹)&lt;/li>
&lt;li>è®¾ç½®é»˜è®¤çš„ rpc timeout, å¹¶æ”¯æŒè®¾ç½® WithRPCTimeout(0) æ¥å…³é—­è¶…æ—¶ä¸­é—´ä»¶&lt;/li>
&lt;li>ä¿®å¤ default logger ä½¿ç”¨é”™è¯¯çš„ call depth&lt;/li>
&lt;li>é‡å‘½å BackwardProxy ä¸º ReverseProxy&lt;/li>
&lt;li>ä¿®å¤ grpc åœºæ™¯ä¸‹çš„ panic&lt;/li>
&lt;li>ä¿®å¤ grpc åœºæ™¯ä¸‹çš„æ½œåœ¨é£é™©ï¼ˆkeepalive è¶…æ—¶å¯¼è‡´ panicï¼‰&lt;/li>
&lt;li>ä¿®å¤ void æ–¹æ³•ä¸­çš„å¼‚å¸¸ç¼ºå¤±&lt;/li>
&lt;li>ä¿®å¤å®ä¾‹å˜æ›´æ—¶ dump ä¿¡æ¯ä¸æ­£ç¡®é—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ–‡æ¡£">æ–‡æ¡£&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤å¤±æ•ˆçš„ä¸­æ–‡é“¾æ¥&lt;/li>
&lt;li>å°†å…¨éƒ¨ doc ç§»è‡³å®˜ç½‘ cloudwego.io&lt;/li>
&lt;/ul>
&lt;h2 id="netpoll-api-change">Netpoll API Change:&lt;/h2>
&lt;ul>
&lt;li>é€‚åº” netpoll.Writer.Append çš„ API æ”¹åŠ¨ï¼Œè¿”å›å€¼ä» 2ä¸ª å˜ä¸º 1ä¸ª&lt;/li>
&lt;/ul>
&lt;h2 id="ä¾èµ–å˜åŒ–">ä¾èµ–å˜åŒ–&lt;/h2>
&lt;ul>
&lt;li>github.com/cloudwego/netpoll: v0.0.4 -&amp;gt; v0.1.2&lt;/li>
&lt;/ul></description></item><item><title>Blog: RPC æ¡†æ¶ Kitex å®è·µå…¥é—¨ï¼šæ€§èƒ½æµ‹è¯•æŒ‡å—</title><link>https://www.cloudwego.io/zh/blog/2021/11/24/rpc-%E6%A1%86%E6%9E%B6-kitex-%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E6%8C%87%E5%8D%97/</link><pubDate>Wed, 24 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/11/24/rpc-%E6%A1%86%E6%9E%B6-kitex-%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E6%8C%87%E5%8D%97/</guid><description>
&lt;p>æ—¥å‰ï¼Œå­—èŠ‚è·³åŠ¨æœåŠ¡æ¡†æ¶å›¢é˜Ÿæ­£å¼å¼€æº CloudWeGo ï¼Œåœ¨æŠ–éŸ³ã€ä»Šæ—¥å¤´æ¡å‡æœ‰æ·±åº¦åº”ç”¨çš„ Golang å¾®æœåŠ¡ RPC æ¡†æ¶ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> ä¹ŸåŒ…å«åœ¨å…¶ä¸­ã€‚&lt;/p>
&lt;p>æœ¬æ–‡æ—¨åœ¨åˆ†äº«å¼€å‘è€…åœ¨å‹æµ‹ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æ—¶éœ€è¦äº†è§£çš„åœºæ™¯å’ŒæŠ€æœ¯é—®é¢˜ã€‚è¿™äº›å»ºè®®æœ‰åŠ©äºç”¨æˆ·æ›´å¥½åœ°ç»“åˆçœŸå® RPC åœºæ™¯å¯¹ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è¿›è¡Œè°ƒä¼˜ï¼Œä½¿ä¹‹æ›´è´´åˆä¸šåŠ¡éœ€è¦ã€å‘æŒ¥æœ€ä½³æ€§èƒ½ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥å‚è€ƒå®˜æ–¹æä¾›çš„å‹æµ‹é¡¹ç›® &lt;a href="https://github.com/cloudwego/kitex-benchmark">kitex-benchmark&lt;/a> äº†è§£æ›´å¤šç»†èŠ‚ã€‚&lt;/p>
&lt;h2 id="å¾®æœåŠ¡åœºæ™¯çš„ç‰¹ç‚¹">å¾®æœåŠ¡åœºæ™¯çš„ç‰¹ç‚¹&lt;/h2>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> è¯ç”Ÿäºå­—èŠ‚è·³åŠ¨å¤§è§„æ¨¡å¾®æœåŠ¡æ¶æ„å®è·µï¼Œé¢å‘çš„åœºæ™¯è‡ªç„¶æ˜¯å¾®æœåŠ¡åœºæ™¯ï¼Œå› æ­¤ä¸‹é¢ä¼šå…ˆä»‹ç»å¾®æœåŠ¡çš„ç‰¹ç‚¹ï¼Œæ–¹ä¾¿å¼€å‘è€…æ·±å…¥ç†è§£ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨å…¶ä¸­çš„è®¾è®¡æ€è€ƒã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>RPC é€šä¿¡æ¨¡å‹&lt;/p>
&lt;p>å¾®æœåŠ¡é—´çš„é€šä¿¡é€šå¸¸ä»¥ PingPong æ¨¡å‹ä¸ºä¸»ï¼Œæ‰€ä»¥é™¤äº†å¸¸è§„çš„ååæ€§èƒ½æŒ‡æ ‡å¤–ï¼Œæ¯æ¬¡ RPC çš„å¹³å‡æ—¶å»¶ä¹Ÿæ˜¯å¼€å‘è€…éœ€è¦è€ƒè™‘çš„ç‚¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¤æ‚çš„è°ƒç”¨é“¾è·¯&lt;/p>
&lt;p>ä¸€æ¬¡ RPC è°ƒç”¨å¾€å¾€éœ€è¦å¤šä¸ªå¾®æœåŠ¡åä½œå®Œæˆï¼Œè€Œä¸‹æ¸¸æœåŠ¡åˆä¼šæœ‰å…¶è‡ªèº«ä¾èµ–ï¼Œæ‰€ä»¥æ•´ä¸ªè°ƒç”¨é“¾è·¯ä¼šæ˜¯ä¸€ä¸ªå¤æ‚çš„ç½‘çŠ¶ç»“æ„ã€‚
åœ¨è¿™ç§å¤æ‚è°ƒç”¨å…³ç³»ä¸­ï¼ŒæŸä¸ªä¸­é—´èŠ‚ç‚¹å‡ºç°çš„å»¶è¿Ÿæ³¢åŠ¨å¯èƒ½ä¼šä¼ å¯¼åˆ°æ•´ä¸ªé“¾è·¯ä¸Šï¼Œå¯¼è‡´æ•´ä½“è¶…æ—¶ã€‚å½“é“¾è·¯ä¸Šçš„èŠ‚ç‚¹è¶³å¤Ÿå¤šæ—¶ï¼Œå³ä¾¿æ¯ä¸ªèŠ‚ç‚¹çš„æ³¢åŠ¨æ¦‚ç‡å¾ˆä½ï¼Œæœ€ç»ˆæ±‡èšåˆ°é“¾è·¯ä¸Šçš„è¶…æ—¶æ¦‚ç‡ä¹Ÿä¼šè¢«æ”¾å¤§ã€‚
æ‰€ä»¥å•ä¸€æœåŠ¡çš„å»¶è¿Ÿæ³¢åŠ¨ â€”â€” å³ P99 å»¶è¿ŸæŒ‡æ ‡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªä¼šå¯¹çº¿ä¸ŠæœåŠ¡äº§ç”Ÿé‡å¤§å½±å“çš„å…³é”®æŒ‡æ ‡ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åŒ…ä½“ç§¯å¤§å°&lt;/p>
&lt;p>è™½ç„¶ä¸€ä¸ªæœåŠ¡é€šä¿¡åŒ…çš„å¤§å°å–å†³äºå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œä½†åœ¨å­—èŠ‚è·³åŠ¨çš„å†…éƒ¨ç»Ÿè®¡ä¸­ï¼Œæˆ‘ä»¬å‘ç°çº¿ä¸Šè¯·æ±‚å¤§å¤šä»¥å°åŒ…ï¼ˆ&amp;lt;2KBï¼‰ä¸ºä¸»ï¼Œæ‰€ä»¥åœ¨å…¼é¡¾å¤§åŒ…åœºæ™¯çš„åŒæ—¶ï¼Œä¹Ÿé‡ç‚¹ä¼˜åŒ–äº†å°åŒ…åœºæ™¯ä¸‹çš„æ€§èƒ½ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="é’ˆå¯¹å¾®æœåŠ¡åœºæ™¯è¿›è¡Œå‹æµ‹">é’ˆå¯¹å¾®æœåŠ¡åœºæ™¯è¿›è¡Œå‹æµ‹&lt;/h2>
&lt;h3 id="ç¡®å®šå‹æµ‹å¯¹è±¡">ç¡®å®šå‹æµ‹å¯¹è±¡&lt;/h3>
&lt;p>è¡¡é‡ä¸€ä¸ª RPC æ¡†æ¶çš„æ€§èƒ½éœ€è¦ä»ä¸¤ä¸ªè§†è§’åˆ†åˆ«å»æ€è€ƒï¼šClient è§†è§’ä¸ Server è§†è§’ã€‚åœ¨å¤§è§„æ¨¡çš„ä¸šåŠ¡æ¶æ„ä¸­ï¼Œä¸Šæ¸¸ Client ä¸è§å¾—ä½¿ç”¨çš„ä¹Ÿæ˜¯ä¸‹æ¸¸çš„æ¡†æ¶ï¼Œè€Œå¼€å‘è€…è°ƒç”¨çš„ä¸‹æ¸¸æœåŠ¡ä¹ŸåŒæ ·å¦‚æ­¤ï¼Œå¦‚æœå†è€ƒè™‘åˆ° Service Mesh çš„æƒ…å†µå°±æ›´å¤æ‚äº†ã€‚&lt;/p>
&lt;p>ä¸€äº›å‹æµ‹é¡¹ç›®é€šå¸¸ä¼šæŠŠ Client å’Œ Server è¿›ç¨‹æ··éƒ¨è¿›è¡Œå‹æµ‹ï¼Œç„¶åå¾—å‡º&lt;strong>æ•´ä¸ªæ¡†æ¶&lt;/strong>çš„æ€§èƒ½æ•°æ®ï¼Œè¿™å…¶å®å’Œçº¿ä¸Šå®é™…è¿è¡Œæƒ…å†µå¾ˆå¯èƒ½æ˜¯ä¸ç¬¦çš„ã€‚&lt;/p>
&lt;p>å¦‚æœè¦å‹æµ‹ Serverï¼Œåº”è¯¥ç»™ Client å°½å¯èƒ½å¤šçš„èµ„æºï¼ŒæŠŠ Server å‹åˆ°æé™ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœ Client å’Œ Server éƒ½åªç»™äº† 4 æ ¸ CPU è¿›è¡Œå‹æµ‹ï¼Œä¼šå¯¼è‡´å¼€å‘è€…æ— æ³•åˆ¤æ–­æœ€ç»ˆå¾—å‡ºæ¥çš„æ€§èƒ½æ•°æ®æ˜¯å“ªä¸ªè§†è§’ä¸‹çš„ï¼Œæ›´æ— æ³•ç»™çº¿ä¸ŠæœåŠ¡åšå®é™…çš„å‚è€ƒã€‚&lt;/p>
&lt;h3 id="å¯¹é½è¿æ¥æ¨¡å‹">å¯¹é½è¿æ¥æ¨¡å‹&lt;/h3>
&lt;p>å¸¸è§„ RPC çš„è¿æ¥æ¨¡å‹ä¸»è¦æœ‰ä¸‰ç§ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>çŸ­è¿æ¥&lt;/strong>ï¼šæ¯æ¬¡è¯·æ±‚éƒ½åˆ›å»ºæ–°è¿æ¥ï¼Œå¾—åˆ°è¿”å›åç«‹å³å…³é—­è¿æ¥&lt;/li>
&lt;li>&lt;strong>é•¿è¿æ¥æ± &lt;/strong>ï¼šå•ä¸ªè¿æ¥åŒæ—¶åªèƒ½å¤„ç†ä¸€æ¬¡å®Œæ•´è¯·æ±‚ä¸è¿”å›&lt;/li>
&lt;li>&lt;strong>è¿æ¥å¤šè·¯å¤ç”¨&lt;/strong>ï¼šå•ä¸ªè¿æ¥å¯ä»¥åŒæ—¶å¼‚æ­¥å¤„ç†å¤šä¸ªè¯·æ±‚ä¸è¿”å›&lt;/li>
&lt;/ul>
&lt;p>æ¯ç±»è¿æ¥æ¨¡å‹æ²¡æœ‰ç»å¯¹å¥½åï¼Œå–å†³äºå®é™…ä½¿ç”¨åœºæ™¯ã€‚è¿æ¥å¤šè·¯å¤ç”¨è™½ç„¶ä¸€èˆ¬æ¥è¯´æ€§èƒ½ç›¸å¯¹æœ€å¥½ï¼Œä½†åº”ç”¨ä¸Šå¿…é¡»ä¾èµ–åè®®èƒ½å¤Ÿæ”¯æŒåŒ…åºåˆ—å·ï¼Œä¸”ä¸€äº›è€æ¡†æ¶æœåŠ¡å¯èƒ½ä¹Ÿå¹¶ä¸æ”¯æŒå¤šè·¯å¤ç”¨çš„æ–¹å¼è°ƒç”¨ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> æœ€æ—©ä¸ºä¿è¯æœ€å¤§ç¨‹åº¦çš„å…¼å®¹æ€§ï¼Œåœ¨ Client ç«¯é»˜è®¤ä½¿ç”¨äº†çŸ­è¿æ¥ï¼Œè€Œå…¶ä»–ä¸»æµå¼€æºæ¡†æ¶é»˜è®¤ä½¿ç”¨è¿æ¥å¤šè·¯å¤ç”¨ï¼Œè¿™å¯¼è‡´ä¸€äº›ç”¨æˆ·åœ¨ä½¿ç”¨é»˜è®¤é…ç½®å‹æµ‹æ—¶ï¼Œå‡ºç°äº†æ¯”è¾ƒå¤§çš„æ€§èƒ½æ•°æ®åå·®ã€‚&lt;/p>
&lt;p>åæ¥ä¸ºäº†å¥‘åˆå¼€æºç”¨æˆ·çš„å¸¸è§„ä½¿ç”¨åœºæ™¯ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨ v0.0.2 ä¸­ä¹ŸåŠ å…¥äº†&lt;a href="https://github.com/cloudwego/kitex/pull/40/files">é»˜è®¤ä½¿ç”¨é•¿è¿æ¥&lt;/a>çš„è®¾ç½®ã€‚&lt;/p>
&lt;h3 id="å¯¹é½åºåˆ—åŒ–æ–¹å¼">å¯¹é½åºåˆ—åŒ–æ–¹å¼&lt;/h3>
&lt;p>å¯¹äº RPC æ¡†æ¶æ¥è¯´ï¼Œä¸è€ƒè™‘æœåŠ¡æ²»ç†çš„è¯ï¼Œè®¡ç®—å¼€é”€ä¸»è¦éƒ½é›†ä¸­åœ¨åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ä¸­ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å¯¹äº Protobuf çš„åºåˆ—åŒ–ä½¿ç”¨çš„æ˜¯å®˜æ–¹çš„ &lt;a href="https://github.com/golang/protobuf">Protobuf&lt;/a> åº“ï¼Œå¯¹äº Thrift çš„åºåˆ—åŒ–ï¼Œåˆ™ä¸“é—¨è¿›è¡Œäº†æ€§èƒ½ä¼˜åŒ–ï¼Œè¿™æ–¹é¢çš„å†…å®¹åœ¨&lt;a href="https://www.cloudwego.io/zh/blog/2021/09/23/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-go-rpc-%E6%A1%86%E6%9E%B6-kitex-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#thrift-%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%BC%98%E5%8C%96">å®˜ç½‘åšå®¢&lt;/a>ä¸­æœ‰ä»‹ç»ã€‚&lt;/p>
&lt;p>å½“å‰å¼€æºæ¡†æ¶å¤§å¤šä¼˜å…ˆæ”¯æŒ Protobufï¼Œè€Œéƒ¨åˆ†æ¡†æ¶å†…ç½®ä½¿ç”¨çš„ Protobuf å…¶å®æ˜¯åšäº†è®¸å¤šæ€§èƒ½ä¼˜åŒ–çš„ &lt;a href="https://github.com/gogo/protobuf">gogo/protobuf&lt;/a> ç‰ˆæœ¬ï¼Œä½†ç”±äº gogo/protobuf å½“å‰æœ‰&lt;a href="https://github.com/gogo/protobuf/issues/691">å¤±å»ç»´æŠ¤çš„é£é™©&lt;/a>ï¼Œæ‰€ä»¥å‡ºäºå¯ç»´æŠ¤æ€§è§’åº¦è€ƒè™‘ï¼Œæˆ‘ä»¬ä¾ç„¶å†³å®šåªä½¿ç”¨å®˜æ–¹çš„ Protobuf åº“ï¼Œå½“ç„¶åç»­æˆ‘ä»¬ä¹Ÿä¼šè®¡åˆ’å¯¹ Protobuf è¿›è¡Œä¼˜åŒ–ã€‚&lt;/p>
&lt;h3 id="ä½¿ç”¨ç‹¬å -cpu">ä½¿ç”¨ç‹¬å  CPU&lt;/h3>
&lt;p>è™½ç„¶çº¿ä¸Šåº”ç”¨é€šå¸¸æ˜¯å¤šä¸ªè¿›ç¨‹å…±äº« CPUï¼Œä½†åœ¨å‹æµ‹åœºæ™¯ä¸‹ï¼ŒClient ä¸ Server è¿›ç¨‹éƒ½å¤„äºæç«¯ç¹å¿™çš„çŠ¶å†µï¼Œå¦‚æœåŒæ—¶è¿˜å…±äº« CPU ä¼šå¯¼è‡´å¤§é‡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œä½¿å¾—æ•°æ®ç¼ºä¹å¯å‚è€ƒæ€§ï¼Œä¸”å®¹æ˜“äº§ç”Ÿå‰åå¾ˆå¤§æ³¢åŠ¨ã€‚&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬å»ºè®®æ˜¯å°† Client ä¸ Server è¿›ç¨‹éš”ç¦»åœ¨ä¸åŒ CPU æˆ–è€…ä¸åŒç‹¬å æœºå™¨ä¸Šè¿›è¡Œã€‚å¦‚æœè¿˜æƒ³è¦è¿›ä¸€æ­¥é¿å…å…¶ä»–è¿›ç¨‹äº§ç”Ÿå½±å“ï¼Œå¯ä»¥å†åŠ ä¸Š nice -n -20 å‘½ä»¤è°ƒé«˜å‹æµ‹è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚&lt;/p>
&lt;p>å¦å¤–å¦‚æœæ¡ä»¶å…è®¸ï¼Œç›¸æ¯”äº‘å¹³å°è™šæ‹Ÿæœºï¼Œä½¿ç”¨çœŸå®ç‰©ç†æœºä¼šä½¿å¾—æµ‹è¯•ç»“æœæ›´åŠ ä¸¥è°¨ä¸å…·å¤‡å¯å¤ç°æ€§ã€‚&lt;/p>
&lt;h2 id="æ€§èƒ½æ•°æ®å‚è€ƒ">æ€§èƒ½æ•°æ®å‚è€ƒ&lt;/h2>
&lt;p>åœ¨æ»¡è¶³ä¸Šè¿°è¦æ±‚çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å¯¹å¤šä¸ªæ¡†æ¶ä½¿ç”¨ Protobuf è¿›è¡Œäº†å‹æµ‹å¯¹æ¯”ï¼Œå‹æµ‹ä»£ç åœ¨ kitex-benchmark ä»“åº“ã€‚åœ¨å……åˆ†å‹æ»¡ Server çš„ç›®æ ‡ä¸‹ï¼Œ&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨è¿æ¥æ± æ¨¡å¼ä¸‹çš„ P99 Latency åœ¨æ‰€æœ‰æ¡†æ¶ä¸­æœ€ä½ã€‚è€Œåœ¨å¤šè·¯å¤ç”¨æ¨¡å¼ä¸‹ï¼ŒKitex åœ¨å„æŒ‡æ ‡ä¸Šä¹Ÿéƒ½å…·æœ‰æ›´åŠ æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚&lt;/p>
&lt;p>&lt;strong>é…ç½®ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>Client 16 CPUsï¼ŒServer 4 CPUs&lt;/li>
&lt;li>1KB è¯·æ±‚å¤§å°ï¼ŒEcho åœºæ™¯&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å‚è€ƒæ•°æ®ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>KITEXï¼šè¿æ¥æ± æ¨¡å¼ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰&lt;/li>
&lt;li>KITEX-MUXï¼šå¤šè·¯å¤ç”¨æ¨¡å¼&lt;/li>
&lt;li>å…¶ä»–æ¡†æ¶å‡ä½¿ç”¨å¤šè·¯å¤ç”¨æ¨¡å¼&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/kitex_performance_testing/qps.png" alt="image">
&lt;img src="https://www.cloudwego.io/img/blog/kitex_performance_testing/tp99.png" alt="image">&lt;/p>
&lt;h2 id="ç»“è¯­">ç»“è¯­&lt;/h2>
&lt;p>åœ¨å½“å‰ä¸»æµçš„ Golang å¼€æº RPC æ¡†æ¶ä¸­ï¼Œæ¯ä¸ªæ¡†æ¶å…¶å®åœ¨è®¾è®¡ç›®æ ‡ä¸Šéƒ½å„æœ‰ä¾§é‡ï¼šæœ‰äº›æ¡†æ¶ä¾§é‡äºé€šç”¨æ€§ï¼Œæœ‰äº›ä¾§é‡äºç±»ä¼¼ Redis è¿™ç§è½»ä¸šåŠ¡é€»è¾‘çš„åœºæ™¯ï¼Œæœ‰äº›ä¾§é‡äºååæ€§èƒ½ï¼Œè€Œæœ‰äº›åˆ™æ›´ä¾§é‡ P99 æ—¶å»¶ã€‚&lt;/p>
&lt;p>å­—èŠ‚è·³åŠ¨çš„ä¸šåŠ¡åœ¨æ—¥å¸¸è¿­ä»£ä¸­ï¼Œå¸¸å¸¸ä¼šå‡ºç°å› æŸä¸ª feature å¯¼è‡´ä¸€ä¸ªæŒ‡æ ‡ä¸Šå‡ï¼Œå¦ä¸€ä¸ªæŒ‡æ ‡ä¸‹é™çš„æƒ…å†µï¼Œå› æ­¤ &lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> åœ¨è®¾è®¡ä¹‹åˆå°±æ›´å€¾å‘äºè§£å†³å¤§è§„æ¨¡å¾®æœåŠ¡åœºæ™¯ä¸‹å„ç§é—®é¢˜ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/cloudwego/kitex">Kitex&lt;/a> å‘å¸ƒåï¼Œæˆ‘ä»¬æ¥åˆ°äº†å¤§é‡æ¥è‡ªç”¨æˆ·çš„è‡ªæµ‹æ•°æ®ï¼Œæ„Ÿè°¢ç¤¾åŒºå¯¹æˆ‘ä»¬çš„å…³æ³¨å’Œæ”¯æŒï¼Œä¹Ÿæ¬¢è¿å¹¿å¤§å¼€å‘è€…åŸºäºæœ¬æ–‡æä¾›çš„æµ‹è¯•æŒ‡å—ï¼Œé’ˆå¯¹è‡ªå·±çš„å®é™…åœºæ™¯é€‰æ‹©åˆé€‚çš„å·¥å…·ã€‚æ›´å¤šé—®é¢˜ï¼Œè¯·åœ¨ GitHub ä¸Šæ Issue äº¤æµã€‚&lt;/p>
&lt;h2 id="ç›¸å…³é“¾æ¥">ç›¸å…³é“¾æ¥&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Kitex: &lt;a href="https://github.com/cloudwego/kitex">https://github.com/cloudwego/kitex&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Netpoll: &lt;a href="https://github.com/cloudwego/netpoll">https://github.com/cloudwego/netpoll&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>kitex-benchmark: &lt;a href="https://github.com/cloudwego/kitex-benchmark">https://github.com/cloudwego/kitex-benchmark&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>netpoll-benchmark: &lt;a href="https://github.com/cloudwego/netpoll-benchmark">https://github.com/cloudwego/netpoll-benchmark&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å®˜æ–¹ Protobuf åº“: &lt;a href="https://github.com/golang/protobuf">https://github.com/golang/protobuf&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Thriftgo: &lt;a href="https://github.com/cloudwego/thriftgo">https://github.com/cloudwego/thriftgo&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.0.8 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/11/05/kitex-v0.0.8-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Fri, 05 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/11/05/kitex-v0.0.8-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h2>
&lt;ul>
&lt;li>ä½¿ç”¨åˆ†ç‰‡ ring å‡å°‘è¿æ¥æ± çš„é”å¼€é”€ã€‚&lt;/li>
&lt;li>è£…å¡« TTHeader ä¸­çš„ä¸Šæ¸¸æœåŠ¡ä¿¡æ¯åˆ° rpcinfo ä¸­ï¼Œç”¨äºåœ¨ decode å‡ºé”™æ—¶è¾“å‡ºæ¥æºä¿¡æ¯ã€‚&lt;/li>
&lt;li>Unlink uds è°ƒæ•´è‡³ CreateListener ä¸­ã€‚&lt;/li>
&lt;li>event.go å’Œ ring_single.go ä¸­çš„ Mutex æ”¹ä¸º RWMutexã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤ netpollmux shard index æº¢å‡ºçš„é—®é¢˜ã€‚&lt;/li>
&lt;li>ç§»é™¤ &lt;code>WithCircuitBreaker&lt;/code> option é‡Œå¯¹å‚æ•°çš„åå°„ï¼Œé¿å… data-raceã€‚&lt;/li>
&lt;li>åœ¨é‡è¯•åœºæ™¯ä¸‹ï¼Œ ä¿®å¤ rpc finish é”™è¯¯å¯¼è‡´çš„å°æ¦‚ç‡å¤±è´¥çš„é—®é¢˜ï¼Œå¹¶ä¸”åŠ ä¸Šäº†ç†”æ–­ sample çš„æ ¡éªŒã€‚&lt;/li>
&lt;li>ä¿®å¤ endpoint_test.go ä¸­çš„ä¸€å¤„å•æµ‹é”™è¯¯ã€‚&lt;/li>
&lt;li>ä¿®æ”¹ conn_wrapper.go ä¸­ longconn å˜é‡å‘½åä¸º conn.ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ç”Ÿæˆå·¥å…·">ç”Ÿæˆå·¥å…·&lt;/h2>
&lt;ul>
&lt;li>ä»£ç ç”Ÿæˆå·¥å…·æ”¯æŒé€ä¼ thrift-goæ’ä»¶å‚æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ–‡æ¡£">æ–‡æ¡£&lt;/h2>
&lt;ul>
&lt;li>å°† README ä¸­çš„æ€§èƒ½ç»“æœæ”¹ä¸ºå¼•ç”¨ kitex-benchmark ä»“åº“çš„æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä¾èµ–å˜åŒ–">ä¾èµ–å˜åŒ–&lt;/h2>
&lt;ul>
&lt;li>github.com/tidwall/gjson: v1.8.0 -&amp;gt; v1.9.3&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.0.5 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/09/26/kitex-v0.0.5-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Sun, 26 Sep 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/09/26/kitex-v0.0.5-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="åŠŸèƒ½">åŠŸèƒ½:&lt;/h2>
&lt;ul>
&lt;li>å¢åŠ é»˜è®¤çš„ ErrorHandler å°è£… Errorï¼ˆç”¨æˆ·æŒ‡å®šä¼šè¢«è¦†ç›–ï¼‰ã€‚&lt;/li>
&lt;li>metainfo æ”¯æŒåå‘ä¼ é€’ã€‚&lt;/li>
&lt;li>æ”¯æŒäº† JSON æ³›åŒ–è°ƒç”¨ï¼Œä½¿ç”¨æŒ‡å—å¯å‚è€ƒï¼š&lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/">Kitex æ³›åŒ–è°ƒç”¨ä½¿ç”¨æŒ‡å—&lt;/a>ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä¼˜åŒ–">ä¼˜åŒ–:&lt;/h2>
&lt;ul>
&lt;li>å¤šè·¯å¤ç”¨åœºæ™¯ä¸‹ä½¿ç”¨äº†æ–°çš„ netpoll API æ¥æ”¹å–„ååå’Œå»¶è¿Ÿã€‚&lt;/li>
&lt;li>å¤šè·¯å¤ç”¨åœºæ™¯ä¸‹æ”¯æŒ metainfo çš„æ­£å‘å’Œåå‘ä¼ é€’ã€‚&lt;/li>
&lt;li>Client ä¼šåœ¨éœ€è¦çš„æ—¶å€™é»˜è®¤ä½¿ç”¨ RPCTimeout ä¸­é—´ä»¶ã€‚&lt;/li>
&lt;li>è¿æ¥æ± é…ç½®å¢åŠ å…¨å±€ç©ºé—²è¿æ¥å’Œå•å®ä¾‹ç©ºé—²è¿æ¥åˆæ³•æ€§æ ¡éªŒã€‚&lt;/li>
&lt;li>å½“æ›´æ–° QPS æœ€å¤§é™åˆ¶æ—¶ä¼šé‡ç½®è®¡æ•°å™¨ã€‚&lt;/li>
&lt;li>å‡å° QPS é™æµçš„è¯¯å·®ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤:&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤ WithExitWaitTime æ²¡æœ‰æ­£ç¡®è®¾ç½®é€€å‡ºç­‰å¾…æ—¶é—´çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>ä¿®å¤æ›´æ–° QPS é™åˆ¶å™¨æ›´æ–°é—´éš”æ—¶ï¼Œåç¨‹æ³„æ¼çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>æœåŠ¡æ³¨å†Œä½¿ç”¨çœŸå®ç›‘å¬çš„åœ°å€ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å·¥å…·">å·¥å…·:&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤äº†å½“ protobuf æ–‡ä»¶åªæœ‰ unary æ–¹æ³•æ—¶ï¼Œç”Ÿæˆå‡ºé”™çš„é—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ–‡æ¡£">æ–‡æ¡£:&lt;/h2>
&lt;ul>
&lt;li>æä¾›äº†è‹±æ–‡ç‰ˆçš„READMEå’Œå…¶ä»–æ–‡æ¡£ã€‚&lt;/li>
&lt;li>è¡¥å……äº†æ³›åŒ–è°ƒç”¨æ‰‹å†Œï¼š &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/">English&lt;/a> | &lt;a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/advanced-feature/generic-call/">ä¸­æ–‡&lt;/a>ã€‚&lt;/li>
&lt;li>README ä¸­å¢åŠ äº† landsapce å’Œ roadmapã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä¾èµ–å˜åŒ–">ä¾èµ–å˜åŒ–:&lt;/h2>
&lt;ul>
&lt;li>github.com/cloudwego/netpoll: v0.0.3 -&amp;gt; v0.0.4&lt;/li>
&lt;li>github.com/bytedance/gopkg: v0.0.0-20210709064845-3c00f9323f09 -&amp;gt; v0.0.0-20210910103821-e4efae9c17c3&lt;/li>
&lt;/ul></description></item><item><title>Blog: å­—èŠ‚è·³åŠ¨ Go RPC æ¡†æ¶ Kitex æ€§èƒ½ä¼˜åŒ–å®è·µ</title><link>https://www.cloudwego.io/zh/blog/2021/09/23/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-go-rpc-%E6%A1%86%E6%9E%B6-kitex-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/</link><pubDate>Thu, 23 Sep 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/09/23/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-go-rpc-%E6%A1%86%E6%9E%B6-kitex-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/</guid><description>
&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>Kitex æ˜¯å­—èŠ‚è·³åŠ¨æ¡†æ¶ç»„ç ”å‘çš„ä¸‹ä¸€ä»£é«˜æ€§èƒ½ã€å¼ºå¯æ‰©å±•æ€§çš„ Go RPC æ¡†æ¶ã€‚é™¤å…·å¤‡ä¸°å¯Œçš„æœåŠ¡æ²»ç†ç‰¹æ€§å¤–ï¼Œç›¸æ¯”å…¶ä»–æ¡†æ¶è¿˜æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
é›†æˆäº†è‡ªç ”çš„ç½‘ç»œåº“ Netpollï¼›æ”¯æŒå¤šæ¶ˆæ¯åè®®ï¼ˆThriftã€Protobufï¼‰å’Œå¤šäº¤äº’æ–¹å¼ï¼ˆPing-Pongã€Onewayã€ Streamingï¼‰ï¼›æä¾›äº†æ›´åŠ çµæ´»å¯æ‰©å±•çš„ä»£ç ç”Ÿæˆå™¨ã€‚&lt;/p>
&lt;p>ç›®å‰å…¬å¸å†…ä¸»è¦ä¸šåŠ¡çº¿éƒ½å·²ç»å¤§èŒƒå›´ä½¿ç”¨ Kitexï¼Œæ®ç»Ÿè®¡å½“å‰æ¥å…¥æœåŠ¡æ•°é‡å¤šè¾¾ 8kã€‚Kitex æ¨å‡ºåï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ä¸æ–­åœ°ä¼˜åŒ–æ€§èƒ½ï¼Œæœ¬æ–‡å°†åˆ†äº«æˆ‘ä»¬åœ¨ Netpoll å’Œ åºåˆ—åŒ–æ–¹é¢çš„ä¼˜åŒ–å·¥ä½œã€‚&lt;/p>
&lt;h2 id="è‡ªç ”ç½‘ç»œåº“-netpoll-ä¼˜åŒ–">è‡ªç ”ç½‘ç»œåº“ Netpoll ä¼˜åŒ–&lt;/h2>
&lt;p>è‡ªç ”çš„åŸºäº epoll çš„ç½‘ç»œåº“ â€”â€” Netpollï¼Œåœ¨æ€§èƒ½æ–¹é¢æœ‰äº†è¾ƒä¸ºæ˜¾è‘—çš„ä¼˜åŒ–ã€‚æµ‹è¯•æ•°æ®è¡¨æ˜ï¼Œå½“å‰ç‰ˆæœ¬(2020.12) ç›¸æ¯”äºä¸Šæ¬¡åˆ†äº«æ—¶(2020.05)ï¼Œååèƒ½åŠ› â†‘30%ï¼Œå»¶è¿Ÿ AVG â†“25%ï¼ŒTP99 â†“67%ï¼Œæ€§èƒ½å·²è¿œè¶…å®˜æ–¹ net åº“ã€‚ä»¥ä¸‹ï¼Œæˆ‘ä»¬å°†åˆ†äº«ä¸¤ç‚¹æ˜¾è‘—æå‡æ€§èƒ½çš„æ–¹æ¡ˆã€‚&lt;/p>
&lt;h3 id="epoll_wait-è°ƒåº¦å»¶è¿Ÿä¼˜åŒ–">epoll_wait è°ƒåº¦å»¶è¿Ÿä¼˜åŒ–&lt;/h3>
&lt;p>Netpoll åœ¨åˆšå‘å¸ƒæ—¶ï¼Œé‡åˆ°äº†å»¶è¿Ÿ AVG è¾ƒä½ï¼Œä½† TP99 è¾ƒé«˜çš„é—®é¢˜ã€‚ç»è¿‡è®¤çœŸç ”ç©¶ epoll_waitï¼Œæˆ‘ä»¬å‘ç°ç»“åˆ polling å’Œ event trigger ä¸¤ç§æ¨¡å¼ï¼Œå¹¶ä¼˜åŒ–è°ƒåº¦ç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—é™ä½å»¶è¿Ÿã€‚&lt;/p>
&lt;p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ Go å®˜æ–¹æä¾›çš„ syscall.EpollWait æ–¹æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">EpollWait&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">epfd&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">events&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#000">EpollEvent&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">n&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œå…±æä¾› 3 ä¸ªå‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤º epoll çš„ fdã€å›è°ƒäº‹ä»¶ã€ç­‰å¾…æ—¶é—´ï¼Œå…¶ä¸­åªæœ‰ msec æ˜¯åŠ¨æ€å¯è°ƒçš„ã€‚&lt;/p>
&lt;p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸»åŠ¨è°ƒç”¨ EpollWait éƒ½ä¼šè®¾ç½® msec=-1ï¼Œå³æ— é™ç­‰å¾…äº‹ä»¶åˆ°æ¥ã€‚äº‹å®ä¸Šä¸å°‘å¼€æºç½‘ç»œåº“ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ã€‚ä½†æ˜¯æˆ‘ä»¬ç ”ç©¶å‘ç°ï¼Œmsec=-1 å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚&lt;/p>
&lt;p>epoll_wait å†…æ ¸æºç (å¦‚ä¸‹) è¡¨æ˜ï¼Œmsec=-1 æ¯” msec=0 å¢åŠ äº† fetch_events æ£€æŸ¥ï¼Œå› æ­¤è€—æ—¶æ›´é•¿ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">static&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span> &lt;span style="color:#000">ep_poll&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">eventpoll&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">ep&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">epoll_event&lt;/span> &lt;span style="color:#000">__user&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">events&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span> &lt;span style="color:#000">maxevents&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">long&lt;/span> &lt;span style="color:#000">timeout&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">timeout&lt;/span> &lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">else&lt;/span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">timeout&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">==&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">goto&lt;/span> &lt;span style="color:#000">send_events&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">fetch_events&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">eavail&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">goto&lt;/span> &lt;span style="color:#000">send_events&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">send_events&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Benchmark è¡¨æ˜ï¼Œåœ¨æœ‰äº‹ä»¶è§¦å‘çš„æƒ…å†µä¸‹ï¼Œmsec=0 æ¯” msec=-1 è°ƒç”¨è¦å¿« 18% å·¦å³ï¼Œå› æ­¤åœ¨é¢‘ç¹äº‹ä»¶è§¦å‘åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ msec=0 è°ƒç”¨æ˜æ˜¾æ˜¯æ›´ä¼˜çš„ã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">Benchmark&lt;/th>
&lt;th style="text-align: left">time/op&lt;/th>
&lt;th style="text-align: left">bytes/op&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">BenchmarkEpollWait, msec=0&lt;/td>
&lt;td style="text-align: left">270 ns/op&lt;/td>
&lt;td style="text-align: left">0 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkEpollWait, msec=-1&lt;/td>
&lt;td style="text-align: left">328 ns/op&lt;/td>
&lt;td style="text-align: left">0 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">EpollWait Delta&lt;/td>
&lt;td style="text-align: left">-17.68%&lt;/td>
&lt;td style="text-align: left">~&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>è€Œåœ¨æ— äº‹ä»¶è§¦å‘çš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ msec=0 æ˜¾ç„¶ä¼šé€ æˆæ— é™è½®è¯¢ï¼Œç©ºè€—å¤§é‡èµ„æºã€‚&lt;/p>
&lt;p>ç»¼åˆè€ƒè™‘åï¼Œæˆ‘ä»¬æ›´å¸Œæœ›åœ¨æœ‰äº‹ä»¶è§¦å‘æ—¶ï¼Œä½¿ç”¨ msec=0 è°ƒç”¨ï¼Œè€Œåœ¨æ— äº‹ä»¶æ—¶ï¼Œä½¿ç”¨ msec=-1 æ¥å‡å°‘è½®è¯¢å¼€é”€ã€‚ä¼ªä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">n&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">syscall&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">EpollWait&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">epfd&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">events&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">msec&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">n&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥äº†å—ï¼Ÿäº‹å®è¯æ˜ä¼˜åŒ–æ•ˆæœå¹¶ä¸æ˜æ˜¾ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å†åšæ€è€ƒï¼š&lt;/p>
&lt;p>msec=0 ä»…å•æ¬¡è°ƒç”¨è€—æ—¶å‡å°‘ 50nsï¼Œå½±å“å¤ªå°ï¼Œå¦‚æœæƒ³è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå¿…é¡»è¦åœ¨è°ƒåº¦é€»è¾‘ä¸Šåšå‡ºè°ƒæ•´ã€‚&lt;/p>
&lt;p>è¿›ä¸€æ­¥æ€è€ƒï¼š&lt;/p>
&lt;p>ä¸Šè¿°ä¼ªä»£ç ä¸­ï¼Œå½“æ— äº‹ä»¶è§¦å‘ï¼Œè°ƒæ•´ msec=-1 æ—¶ï¼Œç›´æ¥ continue ä¼šç«‹å³å†æ¬¡æ‰§è¡Œ EpollWaitï¼Œè€Œç”±äºæ— äº‹ä»¶ï¼Œmsec=-1ï¼Œå½“å‰ goroutine ä¼š block å¹¶è¢« P åˆ‡æ¢ã€‚
ä½†æ˜¯è¢«åŠ¨åˆ‡æ¢æ•ˆç‡è¾ƒä½ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ continue å‰ä¸»åŠ¨ä¸º P åˆ‡æ¢ goroutineï¼Œåˆ™å¯ä»¥èŠ‚çº¦æ—¶é—´ã€‚å› æ­¤æˆ‘ä»¬å°†ä¸Šè¿°ä¼ªä»£ç æ”¹ä¸ºå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">n&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">syscall&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">EpollWait&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">epfd&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">events&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">msec&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">n&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">runtime&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Gosched&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msec&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æµ‹è¯•è¡¨æ˜ï¼Œè°ƒæ•´ä»£ç åï¼Œååé‡ â†‘12%ï¼ŒTP99 â†“64%ï¼Œè·å¾—äº†æ˜¾è‘—çš„å»¶è¿Ÿæ”¶ç›Šã€‚&lt;/p>
&lt;h3 id="åˆç†åˆ©ç”¨-unsafepointer">åˆç†åˆ©ç”¨ unsafe.Pointer&lt;/h3>
&lt;p>ç»§ç»­ç ”ç©¶ epoll_waitï¼Œæˆ‘ä»¬å‘ç° Go å®˜æ–¹å¯¹å¤–æä¾›çš„ syscall.EpollWait å’Œ runtime è‡ªç”¨çš„ epollwait æ˜¯ä¸åŒçš„ç‰ˆæœ¬ï¼Œå³ä¸¤è€…ä½¿ç”¨äº†ä¸åŒçš„ EpollEventã€‚ä»¥ä¸‹æˆ‘ä»¬å±•ç¤ºä¸¤è€…çš„åŒºåˆ«ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// @syscall&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">EpollEvent&lt;/span> &lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Events&lt;/span> &lt;span style="color:#204a87;font-weight:bold">uint32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Fd&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Pad&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// @runtime&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">epollevent&lt;/span> &lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">events&lt;/span> &lt;span style="color:#204a87;font-weight:bold">uint32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">8&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// unaligned uintptr&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬çœ‹åˆ°ï¼Œruntime ä½¿ç”¨çš„ epollevent æ˜¯ç³»ç»Ÿå±‚ epoll å®šä¹‰çš„åŸå§‹ç»“æ„ï¼›è€Œå¯¹å¤–ç‰ˆæœ¬åˆ™å¯¹å…¶åšäº†å°è£…ï¼Œå°† epoll_data(epollevent.data) æ‹†åˆ†ä¸ºå›ºå®šçš„ä¸¤å­—æ®µï¼šFd å’Œ Padã€‚
é‚£ä¹ˆ runtime åˆæ˜¯å¦‚ä½•ä½¿ç”¨çš„å‘¢ï¼Ÿåœ¨æºç é‡Œæˆ‘ä»¬çœ‹åˆ°è¿™æ ·çš„é€»è¾‘ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">**&lt;/span>&lt;span style="color:#000">pollDesc&lt;/span>&lt;span style="color:#000;font-weight:bold">)(&lt;/span>&lt;span style="color:#000">unsafe&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Pointer&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">ev&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">pd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">pd&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">**&lt;/span>&lt;span style="color:#000">pollDesc&lt;/span>&lt;span style="color:#000;font-weight:bold">)(&lt;/span>&lt;span style="color:#000">unsafe&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Pointer&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">ev&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¾ç„¶ï¼Œruntime ä½¿ç”¨ epoll_data(&amp;amp;ev.data) ç›´æ¥å­˜å‚¨äº† fd å¯¹åº”ç»“æ„ä½“(pollDesc)çš„æŒ‡é’ˆï¼Œè¿™æ ·åœ¨äº‹ä»¶è§¦å‘æ—¶ï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ°ç»“æ„ä½“å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œç›¸åº”é€»è¾‘ã€‚
è€Œå¯¹å¤–ç‰ˆæœ¬åˆ™ç”±äºåªèƒ½è·å¾—å°è£…åçš„ Fd å‚æ•°ï¼Œå› æ­¤éœ€è¦å¼•å…¥é¢å¤–çš„ Map æ¥å¢åˆ æ”¹æŸ¥ç»“æ„ä½“å¯¹è±¡ï¼Œè¿™æ ·æ€§èƒ½è‚¯å®šç›¸å·®å¾ˆå¤šã€‚&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬æœæ–­æŠ›å¼ƒäº† syscall.EpollWaitï¼Œè½¬è€Œä»¿ç…§ runtime è‡ªè¡Œè®¾è®¡äº† EpollWait è°ƒç”¨ï¼ŒåŒæ ·é‡‡ç”¨ unsafe.Pointer å­˜å–ç»“æ„ä½“å¯¹è±¡ã€‚æµ‹è¯•è¡¨æ˜ï¼Œè¯¥æ–¹æ¡ˆä¸‹ ååé‡ â†‘10%ï¼ŒTP99 â†“10%ï¼Œè·å¾—äº†è¾ƒä¸ºæ˜æ˜¾çš„æ”¶ç›Šã€‚&lt;/p>
&lt;h2 id="thrift-åºåˆ—åŒ–ååºåˆ—åŒ–ä¼˜åŒ–">Thrift åºåˆ—åŒ–/ååºåˆ—åŒ–ä¼˜åŒ–&lt;/h2>
&lt;p>åºåˆ—åŒ–æ˜¯æŒ‡æŠŠæ•°æ®ç»“æ„æˆ–å¯¹è±¡è½¬æ¢æˆå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼Œååºåˆ—åŒ–åˆ™æ˜¯ç›¸åçš„è¿‡ç¨‹ã€‚RPC åœ¨é€šä¿¡æ—¶éœ€è¦çº¦å®šå¥½åºåˆ—åŒ–åè®®ï¼Œclient åœ¨å‘é€è¯·æ±‚å‰è¿›è¡Œåºåˆ—åŒ–ï¼Œ
å­—èŠ‚åºåˆ—é€šè¿‡ç½‘ç»œä¼ è¾“åˆ° serverï¼Œserver å†ååºåˆ—è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå®Œæˆä¸€æ¬¡ RPC è¯·æ±‚ã€‚Thrift æ”¯æŒ Binaryã€Compact å’Œ JSON åºåˆ—åŒ–åè®®ã€‚ç›®å‰å…¬å¸å†…éƒ¨ä½¿ç”¨çš„åŸºæœ¬éƒ½æ˜¯ Binaryï¼Œè¿™é‡Œåªä»‹ç» Binary åè®®ã€‚&lt;/p>
&lt;p>Binary é‡‡ç”¨ TLV ç¼–ç å®ç°ï¼Œå³æ¯ä¸ªå­—æ®µéƒ½ç”± TLV ç»“æ„æ¥æè¿°ï¼ŒTLV æ„ä¸ºï¼šType ç±»å‹ï¼Œ Length é•¿åº¦ï¼ŒValue å€¼ï¼ŒValue ä¹Ÿå¯ä»¥æ˜¯ä¸ª TLV ç»“æ„ï¼Œå…¶ä¸­ Type å’Œ Length çš„é•¿åº¦å›ºå®šï¼ŒValue çš„é•¿åº¦åˆ™ç”± Length çš„å€¼å†³å®šã€‚
TLV ç¼–ç ç»“æ„ç®€å•æ¸…æ™°ï¼Œå¹¶ä¸”æ‰©å±•æ€§è¾ƒå¥½ï¼Œä½†æ˜¯ç”±äºå¢åŠ äº† Type å’Œ Lengthï¼Œæœ‰é¢å¤–çš„å†…å­˜å¼€é”€ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§éƒ¨åˆ†å­—æ®µéƒ½æ˜¯åŸºæœ¬ç±»å‹çš„æƒ…å†µä¸‹æœ‰ä¸å°çš„ç©ºé—´æµªè´¹ã€‚&lt;/p>
&lt;p>åºåˆ—åŒ–å’Œååºåˆ—çš„æ€§èƒ½ä¼˜åŒ–ä»å¤§çš„æ–¹é¢æ¥çœ‹å¯ä»¥ä»ç©ºé—´å’Œæ—¶é—´ä¸¤ä¸ªç»´åº¦è¿›è¡Œä¼˜åŒ–ã€‚ä»å…¼å®¹å·²æœ‰çš„ Binary åè®®æ¥çœ‹ï¼Œç©ºé—´ä¸Šçš„ä¼˜åŒ–ä¼¼ä¹ä¸å¤ªå¯è¡Œï¼Œåªèƒ½ä»æ—¶é—´ç»´åº¦è¿›è¡Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å‡å°‘å†…å­˜æ“ä½œæ¬¡æ•°ï¼ŒåŒ…æ‹¬å†…å­˜åˆ†é…å’Œæ‹·è´ï¼Œå°½é‡é¢„åˆ†é…å†…å­˜ï¼Œå‡å°‘ä¸å¿…è¦çš„å¼€é”€ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å‡å°‘å‡½æ•°è°ƒç”¨æ¬¡æ•°ï¼Œæ¯”å¦‚å¯è°ƒæ•´ä»£ç ç»“æ„å’Œ inline ç­‰æ‰‹æ®µè¿›è¡Œä¼˜åŒ–ï¼›&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="è°ƒç ”">è°ƒç ”&lt;/h3>
&lt;p>æ ¹æ® go_serialization_benchmarks çš„å‹æµ‹æ•°æ®ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€äº›æ€§èƒ½å“è¶Šçš„åºåˆ—åŒ–æ–¹æ¡ˆè¿›è¡Œè°ƒç ”ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹æˆ‘ä»¬çš„ä¼˜åŒ–å·¥ä½œæœ‰æ‰€å¯å‘ã€‚&lt;/p>
&lt;p>é€šè¿‡å¯¹ protobufã€gogoprotobuf å’Œ Cap&amp;rsquo;n Proto çš„åˆ†æï¼Œæˆ‘ä»¬å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ç½‘ç»œä¼ è¾“ä¸­å‡ºäº IO çš„è€ƒè™‘ï¼Œéƒ½ä¼šå°½é‡å‹ç¼©ä¼ è¾“æ•°æ®ï¼Œprotobuf é‡‡ç”¨äº† Varint ç¼–ç åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸­éƒ½æœ‰ç€ä¸é”™çš„å‹ç¼©æ•ˆæœï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>gogoprotobuf é‡‡ç”¨é¢„è®¡ç®—æ–¹å¼ï¼Œåœ¨åºåˆ—åŒ–æ—¶èƒ½å¤Ÿå‡å°‘å†…å­˜åˆ†é…æ¬¡æ•°ï¼Œè¿›è€Œå‡å°‘äº†å†…å­˜åˆ†é…å¸¦æ¥çš„ç³»ç»Ÿè°ƒç”¨ã€é”å’Œ GC ç­‰ä»£ä»·ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Cap&amp;rsquo;n Proto ç›´æ¥æ“ä½œ bufferï¼Œä¹Ÿæ˜¯å‡å°‘äº†å†…å­˜åˆ†é…å’Œå†…å­˜æ‹·è´ï¼ˆå°‘äº†ä¸­é—´çš„æ•°æ®ç»“æ„ï¼‰ï¼Œå¹¶ä¸”åœ¨ struct pointer çš„è®¾è®¡ä¸­æŠŠå›ºå®šé•¿åº¦ç±»å‹æ•°æ®å’Œéå›ºå®šé•¿åº¦ç±»å‹æ•°æ®åˆ†å¼€å¤„ç†ï¼Œé’ˆå¯¹å›ºå®šé•¿åº¦ç±»å‹å¯ä»¥å¿«é€Ÿå¤„ç†ï¼›&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ä»å…¼å®¹æ€§è€ƒè™‘ï¼Œä¸å¯èƒ½æ”¹å˜ç°æœ‰çš„ TLV ç¼–ç æ ¼å¼ï¼Œå› æ­¤æ•°æ®å‹ç¼©ä¸å¤ªç°å®ï¼Œä½†æ˜¯ 2 å’Œ 3 å¯¹æˆ‘ä»¬çš„ä¼˜åŒ–å·¥ä½œæ˜¯æœ‰å¯å‘çš„ï¼Œäº‹å®ä¸Šæˆ‘ä»¬ä¹Ÿæ˜¯é‡‡å–äº†ç±»ä¼¼çš„æ€è·¯ã€‚&lt;/p>
&lt;h3 id="æ€è·¯">æ€è·¯&lt;/h3>
&lt;h4 id="å‡å°‘å†…å­˜æ“ä½œ">å‡å°‘å†…å­˜æ“ä½œ&lt;/h4>
&lt;p>&lt;strong>buffer ç®¡ç†&lt;/strong>&lt;/p>
&lt;p>æ— è®ºæ˜¯åºåˆ—åŒ–è¿˜æ˜¯ååºåˆ—åŒ–ï¼Œéƒ½æ˜¯ä»ä¸€å—å†…å­˜æ‹·è´æ•°æ®åˆ°å¦ä¸€å—å†…å­˜ï¼Œè¿™å°±æ¶‰åŠåˆ°å†…å­˜åˆ†é…å’Œå†…å­˜æ‹·è´æ“ä½œï¼Œå°½é‡é¿å…å†…å­˜æ“ä½œå¯ä»¥å‡å°‘ä¸å¿…è¦çš„ç³»ç»Ÿè°ƒç”¨ã€é”å’Œ GC ç­‰å¼€é”€ã€‚&lt;/p>
&lt;p>äº‹å®ä¸Š Kitex å·²ç»æä¾›äº† LinkBuffer ç”¨äº buffer çš„ç®¡ç†ï¼ŒLinkBuffer è®¾è®¡ä¸Šé‡‡ç”¨é“¾å¼ç»“æ„ï¼Œç”±å¤šä¸ª block ç»„æˆï¼Œå…¶ä¸­ block æ˜¯å¤§å°å›ºå®šçš„å†…å­˜å—ï¼Œæ„å»ºå¯¹è±¡æ± ç»´æŠ¤ç©ºé—² blockï¼Œç”±æ­¤å¤ç”¨ blockï¼Œå‡å°‘å†…å­˜å ç”¨å’Œ GCã€‚&lt;/p>
&lt;p>åˆšå¼€å§‹æˆ‘ä»¬ç®€å•åœ°é‡‡ç”¨ sync.Pool æ¥å¤ç”¨ netpoll çš„ LinkBufferNodeï¼Œä½†æ˜¯è¿™æ ·ä»ç„¶æ— æ³•è§£å†³å¯¹äºå¤§åŒ…åœºæ™¯ä¸‹çš„å†…å­˜å¤ç”¨ï¼ˆå¤§çš„ Node ä¸èƒ½å›æ”¶ï¼Œå¦åˆ™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼‰ã€‚
ç›®å‰æˆ‘ä»¬æ”¹æˆäº†ç»´æŠ¤ä¸€ç»„ sync.Poolï¼Œæ¯ç»„ä¸­çš„ buffer size éƒ½ä¸åŒï¼Œæ–°å»º block æ—¶æ ¹æ®æœ€æ¥è¿‘æ‰€éœ€ size çš„ pool ä¸­å»è·å–ï¼Œè¿™æ ·å¯ä»¥å°½å¯èƒ½å¤ç”¨å†…å­˜ï¼Œä»æµ‹è¯•æ¥çœ‹å†…å­˜åˆ†é…å’Œ GC ä¼˜åŒ–æ•ˆæœæ˜æ˜¾ã€‚&lt;/p>
&lt;p>&lt;strong>string / binary é›¶æ‹·è´&lt;/strong>&lt;/p>
&lt;p>å¯¹äºæœ‰ä¸€äº›ä¸šåŠ¡ï¼Œæ¯”å¦‚è§†é¢‘ç›¸å…³çš„ä¸šåŠ¡ï¼Œä¼šåœ¨è¯·æ±‚æˆ–è€…è¿”å›ä¸­æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ Binary äºŒè¿›åˆ¶æ•°æ®ä»£è¡¨äº†å¤„ç†åçš„è§†é¢‘æˆ–è€…å›¾ç‰‡æ•°æ®ï¼ŒåŒæ—¶ä¼šæœ‰ä¸€äº›ä¸šåŠ¡ä¼šè¿”å›å¾ˆå¤§çš„ Stringï¼ˆå¦‚å…¨æ–‡ä¿¡æ¯ç­‰ï¼‰ã€‚
è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡ç«ç„°å›¾çœ‹åˆ°çš„çƒ­ç‚¹éƒ½åœ¨æ•°æ®çš„ copy ä¸Šï¼Œé‚£æˆ‘ä»¬å°±æƒ³äº†ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥å‡å°‘è¿™ç§æ‹·è´å‘¢ï¼Ÿ&lt;/p>
&lt;p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚æ—¢ç„¶æˆ‘ä»¬åº•å±‚ä½¿ç”¨çš„ Buffer æ˜¯ä¸ªé“¾è¡¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨é“¾è¡¨ä¸­é—´æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.cloudwego.io/img/blog/buffer-linkerd-list.png" alt="!image">&lt;/p>
&lt;p>æˆ‘ä»¬å°±é‡‡ç”¨äº†ç±»ä¼¼çš„æ€æƒ³ï¼Œå½“åºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­é‡åˆ°äº† string æˆ–è€… binary çš„æ—¶å€™ï¼Œ å°†è¿™ä¸ªèŠ‚ç‚¹çš„ buffer åˆ†æˆä¸¤æ®µï¼Œåœ¨ä¸­é—´åŸåœ°æ’å…¥ç”¨æˆ·çš„ string / binary å¯¹åº”çš„ bufferï¼Œè¿™æ ·å¯ä»¥é¿å…å¤§çš„ string / binary çš„æ‹·è´äº†ã€‚&lt;/p>
&lt;p>è¿™é‡Œå†ä»‹ç»ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨ []byte(string) å»è½¬æ¢ä¸€ä¸ª string åˆ° []byte çš„è¯å®é™…ä¸Šæ˜¯ä¼šå‘ç”Ÿä¸€æ¬¡æ‹·è´çš„ï¼ŒåŸå› æ˜¯ Go çš„è®¾è®¡ä¸­ string æ˜¯ immutable çš„ä½†æ˜¯ []byte æ˜¯ mutable çš„ï¼Œ
æ‰€ä»¥è¿™ä¹ˆè½¬æ¢çš„æ—¶å€™ä¼šæ‹·è´ä¸€æ¬¡ï¼›å¦‚æœè¦ä¸æ‹·è´è½¬æ¢çš„è¯ï¼Œå°±éœ€è¦ç”¨åˆ° unsafe äº†ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">StringToSliceByte&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">s&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">len&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">s&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span>&lt;span style="color:#000;font-weight:bold">)(&lt;/span>&lt;span style="color:#000">unsafe&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Pointer&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">reflect&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SliceHeader&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Data&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">reflect&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">StringHeader&lt;/span>&lt;span style="color:#000;font-weight:bold">)(&lt;/span>&lt;span style="color:#000">unsafe&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Pointer&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">s&lt;/span>&lt;span style="color:#000;font-weight:bold">))).&lt;/span>&lt;span style="color:#000">Data&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Len&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">l&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Cap&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">l&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ®µä»£ç çš„æ„æ€æ˜¯ï¼Œå…ˆæŠŠ string çš„åœ°å€æ‹¿åˆ°ï¼Œå†æ‹¼è£…ä¸Šä¸€ä¸ª slice byte çš„ headerï¼Œè¿™æ ·å°±å¯ä»¥ä¸æ‹·è´æ•°æ®è€Œå°† string è½¬æ¢æˆ []byte äº†ï¼Œä¸è¿‡è¦æ³¨æ„è¿™æ ·ç”Ÿæˆçš„ []byte ä¸å¯å†™ï¼Œå¦åˆ™è¡Œä¸ºæœªå®šä¹‰ã€‚&lt;/p>
&lt;p>&lt;strong>é¢„è®¡ç®—&lt;/strong>&lt;/p>
&lt;p>çº¿ä¸Šå­˜åœ¨æŸäº›æœåŠ¡æœ‰å¤§åŒ…ä¼ è¾“çš„åœºæ™¯ï¼Œè¿™ç§åœºæ™¯ä¸‹ä¼šå¼•å…¥ä¸å°çš„åºåˆ—åŒ– / ååºåˆ—åŒ–å¼€é”€ã€‚ä¸€èˆ¬å¤§åŒ…éƒ½æ˜¯å®¹å™¨ç±»å‹çš„å¤§å°éå¸¸å¤§å¯¼è‡´çš„ï¼Œå¦‚æœèƒ½å¤Ÿæå‰è®¡ç®—å‡º bufferï¼Œä¸€äº› O(n) çš„æ“ä½œå°±èƒ½é™åˆ° O(1)ï¼Œå‡å°‘äº†å‡½æ•°è°ƒç”¨æ¬¡æ•°ï¼Œåœ¨å¤§åŒ…åœºæ™¯ä¸‹ä¹Ÿå¤§é‡å‡å°‘äº†å†…å­˜åˆ†é…çš„æ¬¡æ•°ï¼Œå¸¦æ¥çš„æ”¶ç›Šæ˜¯å¯è§‚çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>åŸºæœ¬ç±»å‹&lt;/p>
&lt;ul>
&lt;li>å¦‚æœå®¹å™¨å…ƒç´ ä¸ºåŸºæœ¬ç±»å‹ï¼ˆbool, byte, i16, i32, i64, doubleï¼‰çš„è¯ï¼Œç”±äºåŸºæœ¬ç±»å‹å¤§å°å›ºå®šï¼Œåœ¨åºåˆ—åŒ–æ—¶æ˜¯å¯ä»¥æå‰è®¡ç®—å‡ºæ€»çš„å¤§å°ï¼Œå¹¶ä¸”ä¸€æ¬¡æ€§åˆ†é…è¶³å¤Ÿçš„ bufferï¼ŒO(n) çš„ malloc æ“ä½œæ¬¡æ•°å¯ä»¥é™åˆ° O(1)ï¼Œä»è€Œå¤§é‡å‡å°‘äº† malloc çš„æ¬¡æ•°ï¼ŒåŒç†åœ¨ååºåˆ—åŒ–æ—¶å¯ä»¥å‡å°‘ next çš„æ“ä½œæ¬¡æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>struct å­—æ®µé‡æ’&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä¸Šé¢çš„ä¼˜åŒ–åªèƒ½é’ˆå¯¹å®¹å™¨å…ƒç´ ç±»å‹ä¸ºåŸºæœ¬ç±»å‹çš„æœ‰æ•ˆï¼Œé‚£ä¹ˆå¯¹äºå…ƒç´ ç±»å‹ä¸º struct çš„æ˜¯å¦ä¹Ÿèƒ½ä¼˜åŒ–å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ²¿ç”¨ä¸Šé¢çš„æ€è·¯ï¼Œå‡å¦‚ struct ä¸­å¦‚æœå­˜åœ¨åŸºæœ¬ç±»å‹çš„ fieldï¼Œä¹Ÿå¯ä»¥é¢„å…ˆè®¡ç®—å‡ºè¿™äº› field çš„å¤§å°ï¼Œåœ¨åºåˆ—åŒ–æ—¶ä¸ºè¿™äº› field æå‰åˆ†é… bufferï¼Œå†™çš„æ—¶å€™ä¹ŸæŠŠè¿™äº› field é¡ºåºç»Ÿä¸€æ”¾åˆ°å‰é¢å†™ï¼Œè¿™æ ·ä¹Ÿèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘ malloc çš„æ¬¡æ•°ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>ä¸€æ¬¡æ€§è®¡ç®—&lt;/p>
&lt;ul>
&lt;li>ä¸Šé¢æåˆ°çš„æ˜¯åŸºæœ¬ç±»å‹çš„ä¼˜åŒ–ï¼Œå¦‚æœåœ¨åºåˆ—åŒ–æ—¶ï¼Œå…ˆéå†ä¸€é request æ‰€æœ‰ fieldï¼Œä¾¿å¯ä»¥è®¡ç®—å¾—åˆ°æ•´ä¸ª request çš„å¤§å°ï¼Œæå‰åˆ†é…å¥½ bufferï¼Œåœ¨åºåˆ—åŒ–å’Œååºåˆ—æ—¶ç›´æ¥æ“ä½œ bufferï¼Œè¿™æ ·å¯¹äºéåŸºæœ¬ç±»å‹ä¹Ÿèƒ½æœ‰ä¼˜åŒ–æ•ˆæœã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å®šä¹‰æ–°çš„ codec æ¥å£ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">thriftMsgFastCodec&lt;/span> &lt;span style="color:#204a87;font-weight:bold">interface&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">BLength&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// count length of whole req/resp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">FastWrite&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">FastRead&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>åœ¨ Marshal å’Œ Unmarshal æ¥å£ä¸­åšç›¸åº”æ”¹é€ ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span> &lt;span style="color:#000">thriftCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">Marshal&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Context&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">message&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Message&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">out&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ByteBuffer&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">.(&lt;/span>&lt;span style="color:#000">thriftMsgFastCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msgBeginLen&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">MessageBeginLength&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">methodName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">thrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TMessageType&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">msgType&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#204a87">int32&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">seqID&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msgEndLen&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">MessageEndLength&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">out&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Malloc&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">msgBeginLen&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BLength&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span> &lt;span style="color:#000">msgEndLen&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#8f5902;font-style:italic">// malloc once&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">perrors&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewProtocolErrorWithMsg&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Sprintf&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;thrift marshal, Malloc failed: %s&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Error&lt;/span>&lt;span style="color:#000;font-weight:bold">()))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WriteMessageBegin&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">methodName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">thrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TMessageType&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">msgType&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#204a87">int32&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">seqID&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FastWrite&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WriteMessageEnd&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span> &lt;span style="color:#000">thriftCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">Unmarshal&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Context&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">message&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Message&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">in&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ByteBuffer&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">message&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Data&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">.(&lt;/span>&lt;span style="color:#000">thriftMsgFastCodec&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#000">message&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">PayloadLen&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msgBeginLen&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">MessageBeginLength&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">methodName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">msgType&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">seqID&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">tProt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">next&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">message&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">PayloadLen&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span> &lt;span style="color:#000">msgBeginLen&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">MessageEndLength&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// next once&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewTransError&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">PROTOCOL_ERROR&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Error&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">_&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FastRead&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewTransError&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">PROTOCOL_ERROR&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Error&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">tProt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ReadMessageEnd&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewTransError&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">remote&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">PROTOCOL_ERROR&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Error&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">tProt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Recycle&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">err&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>ç”Ÿæˆä»£ç ä¸­ä¹Ÿåšç›¸åº”æ”¹é€ ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">p&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Demo&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">BLength&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">StructBeginLength&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Demo&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">p&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">field1Length&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">field2Length&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">field3Length&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FieldStopLength&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">l&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">StructEndLength&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">l&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">p&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Demo&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">FastWrite&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#204a87;font-weight:bold">byte&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WriteStructBegin&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:],&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;Demo&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">p&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fastWriteField2&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fastWriteField4&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fastWriteField1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">p&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fastWriteField3&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WriteFieldStop&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">offset&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+=&lt;/span> &lt;span style="color:#000">bthrift&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Binary&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WriteStructEnd&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">buf&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">offset&lt;/span>&lt;span style="color:#000;font-weight:bold">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">offset&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ä½¿ç”¨-simd-ä¼˜åŒ–-thrift-ç¼–ç ">ä½¿ç”¨ SIMD ä¼˜åŒ– Thrift ç¼–ç &lt;/h4>
&lt;p>å…¬å¸å†…å¹¿æ³›ä½¿ç”¨ list&amp;lt;i64/i32&amp;gt; ç±»å‹æ¥æ‰¿è½½ ID åˆ—è¡¨ï¼Œå¹¶ä¸” list&amp;lt;i64/i32&amp;gt; çš„ç¼–ç æ–¹å¼ååˆ†ç¬¦åˆå‘é‡åŒ–çš„è§„å¾‹ï¼Œäºæ˜¯æˆ‘ä»¬ç”¨äº† SIMD æ¥ä¼˜åŒ– list&amp;lt;i64/i32&amp;gt; çš„ç¼–ç è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä½¿ç”¨äº† avx2ï¼Œä¼˜åŒ–åçš„ç»“æœæ¯”è¾ƒæ˜¾è‘—ï¼Œåœ¨å¤§æ•°æ®é‡ä¸‹é’ˆå¯¹ i64 å¯ä»¥æå‡ 6 å€æ€§èƒ½ï¼Œé’ˆå¯¹ i32 å¯ä»¥æå‡ 12 å€æ€§èƒ½ï¼›åœ¨å°æ•°æ®é‡ä¸‹æå‡æ›´æ˜æ˜¾ï¼Œé’ˆå¯¹ i64 å¯ä»¥æå‡ 10 å€ï¼Œé’ˆå¯¹ i32 å¯ä»¥æå‡ 20 å€ã€‚&lt;/p>
&lt;h4 id="å‡å°‘å‡½æ•°è°ƒç”¨">å‡å°‘å‡½æ•°è°ƒç”¨&lt;/h4>
&lt;p>&lt;strong>inline&lt;/strong>&lt;/p>
&lt;p>inline æ˜¯åœ¨ç¼–è¯‘æœŸé—´å°†ä¸€ä¸ªå‡½æ•°è°ƒç”¨åŸåœ°å±•å¼€ï¼Œæ›¿æ¢æˆè¿™ä¸ªå‡½æ•°çš„å®ç°ï¼Œå®ƒå¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ä»¥æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚&lt;/p>
&lt;p>åœ¨ Go ä¸­å¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½èƒ½ inlineï¼Œä½¿ç”¨å‚æ•°-gflags=&amp;quot;-m&amp;quot;è¿è¡Œè¿›ç¨‹ï¼Œå¯æ˜¾ç¤ºè¢« inline çš„å‡½æ•°ã€‚ä»¥ä¸‹å‡ ç§æƒ…å†µæ— æ³•å†…è”ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>åŒ…å«å¾ªç¯çš„å‡½æ•°ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åŒ…å«ä»¥ä¸‹å†…å®¹çš„å‡½æ•°ï¼šé—­åŒ…è°ƒç”¨ï¼Œselectï¼Œforï¼Œdeferï¼Œgo å…³é”®å­—åˆ›å»ºçš„åç¨‹ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¶…è¿‡ä¸€å®šé•¿åº¦çš„å‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å½“è§£æ AST æ—¶ï¼ŒGo ç”³è¯·äº† 80 ä¸ªèŠ‚ç‚¹ä½œä¸ºå†…è”çš„é¢„ç®—ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæ¶ˆè€—ä¸€ä¸ªé¢„ç®—ã€‚æ¯”å¦‚ï¼Œa = a + 1 è¿™è¡Œä»£ç åŒ…å«äº† 5 ä¸ªèŠ‚ç‚¹ï¼šAS, NAME, ADD, NAME, LITERALã€‚å½“ä¸€ä¸ªå‡½æ•°çš„å¼€é”€è¶…è¿‡äº†è¿™ä¸ªé¢„ç®—ï¼Œå°±æ— æ³•å†…è”ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ç¼–è¯‘æ—¶é€šè¿‡æŒ‡å®šå‚æ•°-lå¯ä»¥æŒ‡å®šç¼–è¯‘å™¨å¯¹ä»£ç å†…è”çš„å¼ºåº¦ï¼ˆgo 1.9+ï¼‰ï¼Œä¸è¿‡è¿™é‡Œä¸æ¨èå¤§å®¶ä½¿ç”¨ï¼Œåœ¨æˆ‘ä»¬çš„æµ‹è¯•åœºæ™¯ä¸‹æ˜¯ buggy çš„ï¼Œæ— æ³•æ­£å¸¸è¿è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// The debug[&amp;#39;l&amp;#39;] flag controls the aggressiveness. Note that main() swaps level 0 and 1, making 1 the default and -l disable. Additional levels (beyond -l) may be buggy and are not supported.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// 0: disabled&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// 1: 80-nodes leaf functions, oneliners, panic, lazy typechecking (default)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// 2: (unassigned)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// 3: (unassigned)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// 4: allow non-leaf functions&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†…è”è™½ç„¶å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½å› ä¸ºå­˜åœ¨é‡å¤ä»£ç ï¼Œä»è€Œå¯¼è‡´ CPU ç¼“å­˜å‘½ä¸­ç‡é™ä½ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ç›²ç›®è¿½æ±‚è¿‡åº¦çš„å†…è”ï¼Œéœ€è¦ç»“åˆ profile ç»“æœæ¥å…·ä½“åˆ†æã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>go &lt;span style="color:#204a87">test&lt;/span> -gcflags&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;-m=2&amp;#39;&lt;/span> -v -test.run TestNewCodec 2&amp;gt;&lt;span style="color:#000;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep &lt;span style="color:#4e9a06">&amp;#34;function too complex&amp;#34;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> wc -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0000cf;font-weight:bold">48&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>go &lt;span style="color:#204a87">test&lt;/span> -gcflags&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;-m=2 -l=4&amp;#39;&lt;/span> -v -test.run TestNewCodec 2&amp;gt;&lt;span style="color:#000;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep &lt;span style="color:#4e9a06">&amp;#34;function too complex&amp;#34;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> wc -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0000cf;font-weight:bold">25&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»ä¸Šé¢çš„è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼ŒåŠ å¼ºå†…è”ç¨‹åº¦ç¡®å®å‡å°‘äº†ä¸€äº›&amp;quot;function too complex&amp;quot;ï¼Œçœ‹ä¸‹ benchmark ç»“æœï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">Benchmark&lt;/th>
&lt;th style="text-align: left">time/op&lt;/th>
&lt;th style="text-align: left">bytes/op&lt;/th>
&lt;th style="text-align: left">allocs/op&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">BenchmarkOldMarshal-4&lt;/td>
&lt;td style="text-align: left">309 Âµs Â± 2%&lt;/td>
&lt;td style="text-align: left">218KB&lt;/td>
&lt;td style="text-align: left">11&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkNewMarshal-4&lt;/td>
&lt;td style="text-align: left">310 Âµs Â± 3%&lt;/td>
&lt;td style="text-align: left">218KB&lt;/td>
&lt;td style="text-align: left">11&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ä¸Šé¢å¼€å¯æœ€é«˜ç¨‹åº¦çš„å†…è”å¼ºåº¦ï¼Œç¡®å®æ¶ˆé™¤äº†ä¸å°‘å› ä¸ºâ€œfunction too complexâ€å¸¦æ¥æ— æ³•å†…è”çš„å‡½æ•°ï¼Œä½†æ˜¯å‹æµ‹ç»“æœæ˜¾ç¤ºæ”¶ç›Šä¸å¤ªæ˜æ˜¾ã€‚&lt;/p>
&lt;h3 id="æµ‹è¯•ç»“æœ">æµ‹è¯•ç»“æœ&lt;/h3>
&lt;p>æˆ‘ä»¬æ„å»ºäº†åŸºå‡†æµ‹è¯•æ¥å¯¹æ¯”ä¼˜åŒ–å‰åçš„æ€§èƒ½ï¼Œä¸‹é¢æ˜¯æµ‹è¯•ç»“æœã€‚&lt;/p>
&lt;p>ç¯å¢ƒï¼šGo 1.13.5 darwin/amd64 on a 2.5 GHz Intel Core i7 16GB&lt;/p>
&lt;p>&lt;strong>å°åŒ…&lt;/strong>&lt;/p>
&lt;p>data size: 20KB&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">Benchmark&lt;/th>
&lt;th style="text-align: left">time/op&lt;/th>
&lt;th style="text-align: left">bytes/op&lt;/th>
&lt;th style="text-align: left">allocs/op&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">BenchmarkOldMarshal-4&lt;/td>
&lt;td style="text-align: left">138 Âµs Â± 3%&lt;/td>
&lt;td style="text-align: left">25.4KB&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkNewMarshal-4&lt;/td>
&lt;td style="text-align: left">29 Âµs Â± 3%&lt;/td>
&lt;td style="text-align: left">26.4KB&lt;/td>
&lt;td style="text-align: left">11&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Marshal Delta&lt;/td>
&lt;td style="text-align: left">-78.97%&lt;/td>
&lt;td style="text-align: left">3.87%&lt;/td>
&lt;td style="text-align: left">-42.11%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkOldUnmarshal-4&lt;/td>
&lt;td style="text-align: left">199 Âµs Â± 3%&lt;/td>
&lt;td style="text-align: left">4720&lt;/td>
&lt;td style="text-align: left">1360&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkNewUnmarshal-4&lt;/td>
&lt;td style="text-align: left">94Âµs Â± 5%&lt;/td>
&lt;td style="text-align: left">4700&lt;/td>
&lt;td style="text-align: left">1280&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Unmarshal Delta&lt;/td>
&lt;td style="text-align: left">-52.93%&lt;/td>
&lt;td style="text-align: left">-0.24%&lt;/td>
&lt;td style="text-align: left">-5.38%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;strong>å¤§åŒ…&lt;/strong>&lt;/p>
&lt;p>data size: 6MB&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">Benchmark&lt;/th>
&lt;th style="text-align: left">time/op&lt;/th>
&lt;th style="text-align: left">bytes/op&lt;/th>
&lt;th style="text-align: left">allocs/op&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">BenchmarkOldMarshal-4&lt;/td>
&lt;td style="text-align: left">58.7ms Â± 5%&lt;/td>
&lt;td style="text-align: left">6.96MB&lt;/td>
&lt;td style="text-align: left">3350&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkNewMarshal-4&lt;/td>
&lt;td style="text-align: left">13.3ms Â± 3%&lt;/td>
&lt;td style="text-align: left">6.84MB&lt;/td>
&lt;td style="text-align: left">10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Marshal Delta&lt;/td>
&lt;td style="text-align: left">-77.30%&lt;/td>
&lt;td style="text-align: left">-1.71%&lt;/td>
&lt;td style="text-align: left">-99.64%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkOldUnmarshal-4&lt;/td>
&lt;td style="text-align: left">56.6ms Â± 3%&lt;/td>
&lt;td style="text-align: left">17.4MB&lt;/td>
&lt;td style="text-align: left">391000&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkNewUnmarshal-4&lt;/td>
&lt;td style="text-align: left">26.8ms Â± 5%&lt;/td>
&lt;td style="text-align: left">17.5MB&lt;/td>
&lt;td style="text-align: left">390000&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">Unmarshal Delta&lt;/td>
&lt;td style="text-align: left">-52.54%&lt;/td>
&lt;td style="text-align: left">0.09%&lt;/td>
&lt;td style="text-align: left">-0.37%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="æ— æ‹·è´åºåˆ—åŒ–">æ— æ‹·è´åºåˆ—åŒ–&lt;/h2>
&lt;p>åœ¨ä¸€äº› request å’Œ response æ•°æ®è¾ƒå¤§çš„æœåŠ¡ä¸­ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä»£ä»·è¾ƒé«˜ï¼Œæœ‰ä¸¤ç§ä¼˜åŒ–æ€è·¯ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¦‚å‰æ–‡æ‰€è¿°è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä¼˜åŒ–&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä»¥æ— æ‹·è´åºåˆ—åŒ–çš„æ–¹å¼è¿›è¡Œè°ƒç”¨&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="è°ƒç ”-1">è°ƒç ”&lt;/h3>
&lt;p>é€šè¿‡æ— æ‹·è´åºåˆ—åŒ–è¿›è¡Œ RPC è°ƒç”¨ï¼Œæœ€æ—©å‡ºè‡ª Kenton Varda çš„ Cap&amp;rsquo;n Proto é¡¹ç›®ï¼ŒCap&amp;rsquo;n Proto æä¾›äº†ä¸€å¥—æ•°æ®äº¤æ¢æ ¼å¼å’Œå¯¹åº”çš„ç¼–è§£ç åº“ã€‚&lt;/p>
&lt;p>Cap&amp;rsquo;n Proto æœ¬è´¨ä¸Šæ˜¯å¼€è¾Ÿä¸€ä¸ª bytes slice ä½œä¸º buffer ï¼Œæ‰€æœ‰å¯¹æ•°æ®ç»“æ„çš„è¯»å†™æ“ä½œéƒ½æ˜¯ç›´æ¥è¯»å†™ bufferï¼Œè¯»å†™å®Œæˆåï¼Œ
åœ¨å¤´éƒ¨æ·»åŠ ä¸€äº› buffer çš„ä¿¡æ¯å°±å¯ä»¥ç›´æ¥å‘é€ï¼Œå¯¹ç«¯æ”¶åˆ°åå³å¯è¯»å–ï¼Œå› ä¸ºæ²¡æœ‰ Go è¯­è¨€ç»“æ„ä½“ä½œä¸ºä¸­é—´å­˜å‚¨ï¼Œæ‰€æœ‰æ— éœ€åºåˆ—åŒ–è¿™ä¸ªæ­¥éª¤ï¼Œååºåˆ—åŒ–äº¦ç„¶ã€‚&lt;/p>
&lt;p>ç®€å•æ€»ç»“ä¸‹ Cap&amp;rsquo;n Proto çš„ç‰¹ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ‰€æœ‰æ•°æ®çš„è¯»å†™éƒ½æ˜¯åœ¨ä¸€æ®µè¿ç»­å†…å­˜ä¸­&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°†åºåˆ—åŒ–æ“ä½œå‰ç½®ï¼Œåœ¨æ•°æ® Get/Set çš„åŒæ—¶è¿›è¡Œç¼–è§£ç &lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨æ•°æ®äº¤æ¢æ ¼å¼ä¸­ï¼Œé€šè¿‡ pointerï¼ˆæ•°æ®å­˜å‚¨ä½ç½®çš„ offsetï¼‰æœºåˆ¶ï¼Œä½¿å¾—æ•°æ®å¯ä»¥å­˜å‚¨åœ¨è¿ç»­å†…å­˜çš„ä»»æ„ä½ç½®ï¼Œè¿›è€Œä½¿å¾—ç»“æ„ä½“ä¸­çš„æ•°æ®å¯ä»¥ä»¥ä»»æ„é¡ºåºè¯»å†™&lt;/p>
&lt;ul>
&lt;li>å¯¹äºç»“æ„ä½“çš„å›ºå®šå¤§å°å­—æ®µï¼Œé€šè¿‡é‡æ–°æ’åˆ—ï¼Œä½¿å¾—è¿™äº›å­—æ®µå­˜å‚¨åœ¨ä¸€å—è¿ç»­å†…å­˜ä¸­&lt;/li>
&lt;li>å¯¹äºç»“æ„ä½“çš„ä¸å®šå¤§å°å­—æ®µï¼ˆå¦‚ listï¼‰ï¼Œåˆ™é€šè¿‡ä¸€ä¸ªå›ºå®šå¤§å°çš„ pointer æ¥è¡¨ç¤ºï¼Œpointer ä¸­å­˜å‚¨äº†åŒ…æ‹¬æ•°æ®ä½ç½®åœ¨å†…çš„ä¸€äº›ä¿¡æ¯&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>é¦–å…ˆ Cap&amp;rsquo;n Proto æ²¡æœ‰ Go è¯­è¨€ç»“æ„ä½“ä½œä¸ºä¸­é—´è½½ä½“ï¼Œå¾—ä»¥å‡å°‘ä¸€æ¬¡æ‹·è´ï¼Œç„¶å Cap&amp;rsquo;n Proto æ˜¯åœ¨ä¸€æ®µè¿ç»­å†…å­˜ä¸Šè¿›è¡Œæ“ä½œï¼Œç¼–ç æ•°æ®çš„è¯»å†™å¯ä»¥ä¸€æ¬¡å®Œæˆï¼Œå› ä¸ºè¿™ä¸¤ä¸ªåŸå› ï¼Œä½¿å¾— Cap&amp;rsquo; Proto çš„æ€§èƒ½è¡¨ç°ä¼˜ç§€ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ç›¸åŒæ•°æ®ç»“æ„ä¸‹ Thrift å’Œ Cap&amp;rsquo;n Proto çš„ Benchmarkï¼Œè€ƒè™‘åˆ° Cap&amp;rsquo;n Proto æ˜¯å°†ç¼–è§£ç æ“ä½œå‰ç½®äº†ï¼Œæ‰€ä»¥å¯¹æ¯”çš„æ˜¯åŒ…æ‹¬æ•°æ®åˆå§‹åŒ–åœ¨å†…çš„å®Œæ•´è¿‡ç¨‹ï¼Œå³ç»“æ„ä½“æ•°æ®åˆå§‹åŒ–+ï¼ˆåºåˆ—åŒ–ï¼‰+å†™å…¥ buffer +ä» buffer è¯»å‡º+ï¼ˆååºåˆ—åŒ–ï¼‰+ä»ç»“æ„ä½“è¯»å‡ºæ•°æ®ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Thrift" data-lang="Thrift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">MyTest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Num&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Ano&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Ano&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">list&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Nums&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">// é•¿åº¦131072 å¤§å°1MB
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Ano&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Num&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">Benchmark&lt;/th>
&lt;th style="text-align: left">Iter&lt;/th>
&lt;th style="text-align: left">time/op&lt;/th>
&lt;th style="text-align: left">bytes/op&lt;/th>
&lt;th style="text-align: left">alloc/op&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">BenchmarkThriftReadWrite&lt;/td>
&lt;td style="text-align: left">172&lt;/td>
&lt;td style="text-align: left">6855840 ns/op&lt;/td>
&lt;td style="text-align: left">3154209 B/op&lt;/td>
&lt;td style="text-align: left">545 allocs/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BenchmarkCapnpReadWrite&lt;/td>
&lt;td style="text-align: left">1500&lt;/td>
&lt;td style="text-align: left">844924 ns/op&lt;/td>
&lt;td style="text-align: left">2085713 B/op&lt;/td>
&lt;td style="text-align: left">9 allocs/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">ReadWrite Delta&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">-87.68%&lt;/td>
&lt;td style="text-align: left">-33.88%&lt;/td>
&lt;td style="text-align: left">-98.35%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ï¼ˆååºåˆ—åŒ–ï¼‰+è¯»å‡ºæ•°æ®ï¼Œè§†åŒ…å¤§å°ï¼ŒCap&amp;rsquo;n Proto æ€§èƒ½å¤§çº¦æ˜¯ Thrift çš„ 8-9 å€ã€‚å†™å…¥æ•°æ®+ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œè§†åŒ…å¤§å°ï¼ŒCap&amp;rsquo;n Proto æ€§èƒ½å¤§çº¦æ˜¯ Thrift çš„ 2-8 å€ã€‚æ•´ä½“æ€§èƒ½ Cap&amp;rsquo; Proto æ€§èƒ½å¤§çº¦æ˜¯ Thrift çš„ 4-8 å€ã€‚&lt;/p>
&lt;p>å‰é¢è¯´äº† Cap&amp;rsquo;n Proto çš„ä¼˜åŠ¿ï¼Œä¸‹é¢æ€»ç»“ä¸€ä¸‹ Cap&amp;rsquo;n Proto å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Cap&amp;rsquo;n Proto çš„è¿ç»­å†…å­˜å­˜å‚¨è¿™ä¸€ç‰¹æ€§å¸¦æ¥çš„ä¸€ä¸ªé—®é¢˜ï¼šå½“å¯¹ä¸å®šå¤§å°æ•°æ®è¿›è¡Œ resize ï¼Œä¸”éœ€è¦çš„ç©ºé—´å¤§äºåŸæœ‰ç©ºé—´æ—¶ï¼Œåªèƒ½åœ¨åé¢é‡æ–°åˆ†é…ä¸€å—ç©ºé—´ï¼Œå¯¼è‡´åŸæ¥æ•°æ®çš„ç©ºé—´æˆä¸ºäº†ä¸€ä¸ªæ— æ³•å»æ‰çš„ hole ã€‚
è¿™ä¸ªé—®é¢˜éšç€è°ƒç”¨é“¾è·¯çš„ä¸æ–­ resize ä¼šè¶Šæ¥è¶Šä¸¥é‡ï¼Œè¦è§£å†³åªèƒ½åœ¨æ•´ä¸ªé“¾è·¯ä¸Šä¸¥æ ¼çº¦æŸï¼šå°½é‡é¿å…å¯¹ä¸å®šå¤§å°å­—æ®µçš„ resize ï¼Œå½“ä¸å¾—ä¸ resize çš„æ—¶å€™ï¼Œé‡æ–°æ„å»ºä¸€ä¸ªç»“æ„ä½“å¹¶å¯¹æ•°æ®è¿›è¡Œæ·±æ‹·è´ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Cap&amp;rsquo;n Proto å› ä¸ºæ²¡æœ‰ Go è¯­è¨€ç»“æ„ä½“ä½œä¸ºä¸­é—´è½½ä½“ï¼Œä½¿å¾—æ‰€æœ‰çš„å­—æ®µéƒ½åªèƒ½é€šè¿‡æ¥å£è¿›è¡Œè¯»å†™ï¼Œç”¨æˆ·ä½“éªŒè¾ƒå·®ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="thrift-åè®®å…¼å®¹çš„æ— æ‹·è´åºåˆ—åŒ–">Thrift åè®®å…¼å®¹çš„æ— æ‹·è´åºåˆ—åŒ–&lt;/h3>
&lt;p>Cap&amp;rsquo;n Proto ä¸ºäº†æ›´å¥½æ›´é«˜æ•ˆåœ°æ”¯æŒæ— æ‹·è´åºåˆ—åŒ–ï¼Œä½¿ç”¨äº†ä¸€å¥—è‡ªç ”çš„ç¼–è§£ç æ ¼å¼ï¼Œä½†åœ¨ç°åœ¨ Thrift å’Œ ProtoBuf å ä¸»æµçš„ç¯å¢ƒä¸­éš¾ä»¥é“ºå¼€ã€‚ä¸ºäº†èƒ½åœ¨åè®®å…¼å®¹çš„åŒæ—¶è·å¾—æ— æ‹·è´åºåˆ—åŒ–çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¼€å§‹äº† Thrift åè®®å…¼å®¹çš„æ— æ‹·è´åºåˆ—åŒ–çš„æ¢ç´¢ã€‚&lt;/p>
&lt;p>Cap&amp;rsquo;n Proto ä½œä¸ºæ— æ‹·è´åºåˆ—åŒ–çš„æ ‡æ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çœ‹çœ‹ Cap&amp;rsquo;n Proto ä¸Šçš„ä¼˜åŒ–èƒ½å¦åº”ç”¨åˆ° Thrift ä¸Šï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>è‡ªç„¶æ˜¯æ— æ‹·è´åºåˆ—åŒ–çš„æ ¸å¿ƒï¼Œä¸ä½¿ç”¨ Go è¯­è¨€ç»“æ„ä½“ä½œä¸ºä¸­é—´è½½ä½“ï¼Œå‡å°‘ä¸€æ¬¡æ‹·è´ã€‚æ­¤ä¼˜åŒ–ç‚¹æ˜¯åè®®æ— å…³çš„ï¼Œèƒ½å¤Ÿé€‚ç”¨äºä»»ä½•å·²æœ‰çš„åè®®ï¼Œè‡ªç„¶ä¹Ÿèƒ½å’Œ Thrift åè®®å…¼å®¹ï¼Œä½†æ˜¯ä» Cap&amp;rsquo;n Proto çš„ä½¿ç”¨ä¸Šæ¥çœ‹ï¼Œç”¨æˆ·ä½“éªŒè¿˜éœ€è¦ä»”ç»†æ‰“ç£¨ä¸€ä¸‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Cap&amp;rsquo;n Proto æ˜¯åœ¨ä¸€æ®µè¿ç»­å†…å­˜ä¸Šè¿›è¡Œæ“ä½œï¼Œç¼–ç æ•°æ®çš„è¯»å†™å¯ä»¥ä¸€æ¬¡å®Œæˆã€‚Cap&amp;rsquo;n Proto å¾—ä»¥åœ¨è¿ç»­å†…å­˜ä¸Šæ“ä½œçš„åŸå› ï¼šæœ‰ pointer æœºåˆ¶ï¼Œæ•°æ®å¯ä»¥å­˜å‚¨åœ¨ä»»æ„ä½ç½®ï¼Œå…è®¸å­—æ®µå¯ä»¥ä»¥ä»»æ„é¡ºåºå†™å…¥è€Œä¸å½±å“è§£ç ã€‚
ä½†æ˜¯ä¸€æ–¹é¢ï¼Œåœ¨è¿ç»­å†…å­˜ä¸Šå®¹æ˜“å› ä¸ºè¯¯æ“ä½œï¼Œå¯¼è‡´åœ¨ resize çš„æ—¶å€™ç•™ä¸‹ holeï¼Œå¦ä¸€æ–¹é¢ï¼ŒThrift æ²¡æœ‰ç±»ä¼¼äº pointer çš„æœºåˆ¶ï¼Œæ•…è€Œå¯¹æ•°æ®å¸ƒå±€æœ‰ç€æ›´ä¸¥æ ¼çš„è¦æ±‚ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªæ€è·¯ï¼š&lt;/p>
&lt;ul>
&lt;li>åšæŒåœ¨è¿ç»­å†…å­˜ä¸Šè¿›è¡Œæ“ä½œï¼Œå¹¶å¯¹ç”¨æˆ·ä½¿ç”¨æå‡ºä¸¥æ ¼è¦æ±‚ï¼š1. resize æ“ä½œå¿…é¡»é‡æ–°æ„å»ºæ•°æ®ç»“æ„ 2. å½“å­˜åœ¨ç»“æ„ä½“åµŒå¥—æ—¶ï¼Œå¯¹å­—æ®µå†™å…¥é¡ºåºæœ‰ç€ä¸¥æ ¼è¦æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæŠŠä¸€ä¸ªå­˜åœ¨åµŒå¥—çš„ç»“æ„ä½“ä»å¤–å¾€é‡Œå±•å¼€ï¼Œå†™å…¥æ—¶éœ€è¦æŒ‰å±•å¼€é¡ºåºå†™å…¥ï¼‰ï¼Œ
ä¸”å› ä¸º Binary ç­‰ TLV ç¼–ç çš„å…³ç³»ï¼Œåœ¨æ¯ä¸ªåµŒå¥—å¼€å§‹å†™å…¥æ—¶ï¼Œéœ€è¦ç”¨æˆ·ä¸»åŠ¨å£°æ˜ï¼ˆå¦‚ StartWriteFieldXï¼‰ã€‚&lt;/li>
&lt;li>ä¸å®Œå…¨åœ¨è¿ç»­å†…å­˜ä¸Šæ“ä½œï¼Œå±€éƒ¨å†…å­˜è¿ç»­ï¼Œå¯å˜å­—æ®µåˆ™å•ç‹¬åˆ†é…ä¸€å—å†…å­˜ï¼Œæ—¢ç„¶å†…å­˜ä¸æ˜¯å®Œå…¨è¿ç»­çš„ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•åšåˆ°ä¸€æ¬¡å†™æ“ä½œä¾¿å®Œæˆè¾“å‡ºã€‚ä¸ºäº†å°½å¯èƒ½æ¥è¿‘ä¸€æ¬¡å†™å®Œæ•°æ®çš„æ€§èƒ½ï¼Œæˆ‘ä»¬é‡‡å–äº†ä¸€ç§é“¾å¼ buffer çš„æ–¹æ¡ˆï¼Œ
ä¸€æ–¹é¢å½“å¯å˜å­—æ®µ resize æ—¶åªéœ€æ›¿æ¢é“¾å¼ buffer çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ— éœ€åƒ Cap&amp;rsquo;n Proto ä¸€æ ·é‡æ–°æ„å»ºç»“æ„ä½“ï¼Œå¦ä¸€æ–¹é¢åœ¨éœ€è¦è¾“å‡ºæ—¶æ— éœ€åƒ Thrift ä¸€æ ·éœ€è¦æ„ŸçŸ¥å®é™…çš„ç»“æ„ï¼Œåªè¦æŠŠæ•´ä¸ªé“¾è·¯ä¸Šçš„ buffer å†™å…¥å³å¯ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å…ˆæ€»ç»“ä¸‹ç›®å‰ç¡®å®šçš„ä¸¤ä¸ªç‚¹ï¼š1. ä¸ä½¿ç”¨ Go è¯­è¨€ç»“æ„ä½“ä½œä¸ºä¸­é—´è½½ä½“ï¼Œé€šè¿‡æ¥å£ç›´æ¥æ“ä½œåº•å±‚å†…å­˜ï¼Œåœ¨ Get/Set æ—¶å®Œæˆç¼–è§£ç  2. é€šè¿‡é“¾å¼ buffer å­˜å‚¨æ•°æ®&lt;/p>
&lt;p>ç„¶åè®©æˆ‘ä»¬çœ‹ä¸‹ç›®å‰è¿˜æœ‰å¾…è§£å†³çš„é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä¸ä½¿ç”¨ Go è¯­è¨€ç»“æ„ä½“åå¸¦æ¥çš„ç”¨æˆ·ä½“éªŒåŠ£åŒ–&lt;/p>
&lt;ul>
&lt;li>è§£å†³æ–¹æ¡ˆï¼šæ”¹å–„ Get/Set æ¥å£çš„ä½¿ç”¨ä½“éªŒï¼Œå°½å¯èƒ½åšåˆ°å’Œ Go è¯­è¨€ç»“æ„ä½“åŒç­‰çš„æ˜“ç”¨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Cap&amp;rsquo;n Proto çš„ Binary Format æ˜¯é’ˆå¯¹æ— æ‹·è´åºåˆ—åŒ–åœºæ™¯ä¸“é—¨è®¾è®¡çš„ï¼Œè™½ç„¶æ¯æ¬¡ Get æ—¶éƒ½ä¼šè¿›è¡Œä¸€æ¬¡è§£ç ï¼Œä½†æ˜¯è§£ç ä»£ä»·éå¸¸å°ã€‚è€Œ Thrift çš„åè®®ï¼ˆä»¥ Binary ä¸ºä¾‹ï¼‰ï¼Œæ²¡æœ‰ç±»ä¼¼äº pointer çš„æœºåˆ¶ï¼Œ
å½“å­˜åœ¨å¤šä¸ªä¸å®šå¤§å°å­—æ®µæˆ–è€…å­˜åœ¨åµŒå¥—æ—¶ï¼Œå¿…é¡»é¡ºåºè§£æè€Œæ— æ³•ç›´æ¥é€šè¿‡è®¡ç®—åç§»æ‹¿åˆ°å­—æ®µæ•°æ®æ‰€åœ¨çš„ä½ç½®ï¼Œè€Œæ¯æ¬¡ Get éƒ½è¿›è¡Œé¡ºåºè§£æçš„ä»£ä»·è¿‡äºé«˜æ˜‚ã€‚&lt;/p>
&lt;ul>
&lt;li>è§£å†³æ–¹æ¡ˆï¼šæˆ‘ä»¬åœ¨è¡¨ç¤ºç»“æ„ä½“çš„æ—¶å€™ï¼Œé™¤äº†è®°å½•ç»“æ„ä½“çš„ buffer èŠ‚ç‚¹ï¼Œè¿˜åŠ äº†ä¸€ä¸ªç´¢å¼•ï¼Œé‡Œé¢è®°å½•äº†æ¯ä¸ªä¸å®šå¤§å°å­—æ®µå¼€å§‹çš„ buffer èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚
ä¸‹é¢æ˜¯ç›®å‰çš„æ— æ‹·è´åºåˆ—åŒ–æ–¹æ¡ˆä¸ FastRead/Writeï¼Œåœ¨ 4 æ ¸ä¸‹çš„æé™æ€§èƒ½å¯¹æ¯”æµ‹è¯•ï¼š&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">åŒ…å¤§å°&lt;/th>
&lt;th style="text-align: left">ç±»å‹&lt;/th>
&lt;th style="text-align: left">QPS&lt;/th>
&lt;th style="text-align: left">TP90&lt;/th>
&lt;th style="text-align: left">TP99&lt;/th>
&lt;th style="text-align: left">TP999&lt;/th>
&lt;th style="text-align: left">CPU&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">1KB&lt;/td>
&lt;td style="text-align: left">æ— åºåˆ—åŒ–&lt;/td>
&lt;td style="text-align: left">70,700&lt;/td>
&lt;td style="text-align: left">1 ms&lt;/td>
&lt;td style="text-align: left">3 ms&lt;/td>
&lt;td style="text-align: left">6 ms&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">FastWrite/FastRead&lt;/td>
&lt;td style="text-align: left">82,490&lt;/td>
&lt;td style="text-align: left">1 ms&lt;/td>
&lt;td style="text-align: left">2 ms&lt;/td>
&lt;td style="text-align: left">4 ms&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2KB&lt;/td>
&lt;td style="text-align: left">æ— åºåˆ—åŒ–&lt;/td>
&lt;td style="text-align: left">65,000&lt;/td>
&lt;td style="text-align: left">1 ms&lt;/td>
&lt;td style="text-align: left">4 ms&lt;/td>
&lt;td style="text-align: left">9 ms&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">FastWrite/FastRead&lt;/td>
&lt;td style="text-align: left">72,000&lt;/td>
&lt;td style="text-align: left">1 ms&lt;/td>
&lt;td style="text-align: left">2 ms&lt;/td>
&lt;td style="text-align: left">8 ms&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4KB&lt;/td>
&lt;td style="text-align: left">æ— åºåˆ—åŒ–&lt;/td>
&lt;td style="text-align: left">56,400&lt;/td>
&lt;td style="text-align: left">2 ms&lt;/td>
&lt;td style="text-align: left">5 ms&lt;/td>
&lt;td style="text-align: left">10 ms&lt;/td>
&lt;td style="text-align: left">380%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">FastWrite/FastRead&lt;/td>
&lt;td style="text-align: left">52,700&lt;/td>
&lt;td style="text-align: left">2 ms&lt;/td>
&lt;td style="text-align: left">4 ms&lt;/td>
&lt;td style="text-align: left">10 ms&lt;/td>
&lt;td style="text-align: left">380%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">32KB&lt;/td>
&lt;td style="text-align: left">æ— åºåˆ—åŒ–&lt;/td>
&lt;td style="text-align: left">27,400&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">FastWrite/FastRead&lt;/td>
&lt;td style="text-align: left">19,500&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;td style="text-align: left">/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1MB&lt;/td>
&lt;td style="text-align: left">æ— åºåˆ—åŒ–&lt;/td>
&lt;td style="text-align: left">986&lt;/td>
&lt;td style="text-align: left">53 ms&lt;/td>
&lt;td style="text-align: left">56 ms&lt;/td>
&lt;td style="text-align: left">59 ms&lt;/td>
&lt;td style="text-align: left">260%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">FastWrite/FastRead&lt;/td>
&lt;td style="text-align: left">942&lt;/td>
&lt;td style="text-align: left">55 ms&lt;/td>
&lt;td style="text-align: left">59 ms&lt;/td>
&lt;td style="text-align: left">62 ms&lt;/td>
&lt;td style="text-align: left">290%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10MB&lt;/td>
&lt;td style="text-align: left">æ— åºåˆ—åŒ–&lt;/td>
&lt;td style="text-align: left">82&lt;/td>
&lt;td style="text-align: left">630 ms&lt;/td>
&lt;td style="text-align: left">640 ms&lt;/td>
&lt;td style="text-align: left">645 ms&lt;/td>
&lt;td style="text-align: left">240%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">FastWrite/FastRead&lt;/td>
&lt;td style="text-align: left">82&lt;/td>
&lt;td style="text-align: left">630 ms&lt;/td>
&lt;td style="text-align: left">640 ms&lt;/td>
&lt;td style="text-align: left">640 ms&lt;/td>
&lt;td style="text-align: left">270%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æµ‹è¯•ç»“æœæ¦‚è¿°ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å°åŒ…åœºæ™¯ï¼Œæ— åºåˆ—åŒ–æ€§èƒ½è¡¨ç°è¾ƒå·®ï¼Œçº¦ä¸º FastWrite/FastRead çš„ 85%ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¤§åŒ…åœºæ™¯ï¼Œæ— åºåˆ—åŒ–æ€§èƒ½è¡¨ç°è¾ƒå¥½ï¼Œ4K ä»¥ä¸Šçš„åŒ…è¾ƒ FastWrite/FastRead æå‡ 7%-40%ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="åè®°">åè®°&lt;/h2>
&lt;p>å¸Œæœ›ä»¥ä¸Šçš„åˆ†äº«èƒ½å¤Ÿå¯¹ç¤¾åŒºæœ‰æ‰€å¸®åŠ©ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨å°è¯• share memory-based IPCã€io_uringã€tcp zero copy ã€RDMA ç­‰ï¼Œæ›´å¥½åœ°æå‡ Kitex æ€§èƒ½ï¼›é‡ç‚¹ä¼˜åŒ–åŒæœºã€åŒå®¹å™¨çš„é€šè®¯åœºæ™¯ã€‚æ¬¢è¿å„ä½æ„Ÿå…´è¶£çš„åŒå­¦åŠ å…¥æˆ‘ä»¬ï¼Œå…±åŒå»ºè®¾ Go è¯­è¨€ç”Ÿæ€ï¼&lt;/p>
&lt;h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://github.com/alecthomas/go_serialization_benchmarks">https://github.com/alecthomas/go_serialization_benchmarks&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://capnproto.org/">https://capnproto.org/&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://software.intel.com/content/www/us/en/develop/documentation/cpp-compiler-developer-guide-and-reference/top/compiler-reference/intrinsics/intrinsics-for-intel-advanced-vector-extensions-2/intrinsics-for-shuffle-operations-1/mm256-shuffle-epi8.html">IntelÂ® C++ Compiler Classic Developer Guide and Reference&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.0.4 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/08/26/kitex-v0.0.4-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Thu, 26 Aug 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/08/26/kitex-v0.0.4-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="ä¼˜åŒ–">ä¼˜åŒ–:&lt;/h2>
&lt;ul>
&lt;li>transMetaHandler åœ¨è‡ªå®šä¹‰ boundHandlers ä¹‹å‰æ‰§è¡Œï¼Œä¿è¯è‡ªå®šä¹‰ boundHandlers å¯ä»¥æ‹¿åˆ° RPCInfo ä¿¡æ¯ã€‚&lt;/li>
&lt;li>TransError æš´éœ²å°è£… error çš„ typeID ç”¨äºæ”¯æŒè‡ªå®šä¹‰ Error å›ä¼ é”™è¯¯ç ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤:&lt;/h2>
&lt;ul>
&lt;li>å¤ç”¨ RPCInfo ä¸å¯¹ stats level é‡ç½®ï¼Œ ä»¥ä¿®å¤åœ¨ä½¿ç”¨ netpollmux æ—¶ metric ä¸¢å¤±é—®é¢˜ã€‚&lt;/li>
&lt;li>æ¸…ç†ä¸å­˜åœ¨èŠ‚ç‚¹çš„è¿æ¥æ± ã€‚&lt;/li>
&lt;li>Streaming ä¸­å¢åŠ  Netpoll EOF é”™è¯¯åˆ¤æ–­æ¥æ¸…é™¤å†—ä½™çš„ warning æ—¥å¿—ã€‚&lt;/li>
&lt;li>ä¿®æ”¹ç†”æ–­é”™è¯¯ç»Ÿè®¡ç±»å‹ï¼Œé Ignorable é”™è¯¯ç±»å‹å‡åšç†”æ–­ç»Ÿè®¡ï¼Œä»¥ä¿®å¤å¼€æºç‰ˆæœ¬ç†”æ–­æ— æ³•æ­£ç¡®ç”Ÿæ•ˆå’Œå†…éƒ¨ç‰ˆæœ¬åœ¨å¼€å¯meshåé‡è¯•ç†”æ–­æ— æ³•ç”Ÿæ•ˆé—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å·¥å…·">å·¥å…·:&lt;/h2>
&lt;ul>
&lt;li>è°ƒæ•´äº† Protobuf unary æ–¹æ³•çš„ç”Ÿæˆä»£ç ï¼Œæ¥åŒæ—¶æ”¯æŒ Kitex Protobuf å’Œ gRPCã€‚&lt;/li>
&lt;li>å‡çº§äº† thriftgo ç‰ˆæœ¬æ¥ä¿®å¤ golintã€‚&lt;/li>
&lt;li>ä¿®å¤äº†ç”Ÿæˆä»£ç ä¸­çš„é”™è¯¯ã€‚&lt;/li>
&lt;li>ä¿®å¤äº†æµç”Ÿæˆçš„ä»£ç ç¼ºå°‘ä¼ è¾“é€‰é¡¹çš„é”™è¯¯ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ–‡æ¡£">æ–‡æ¡£:&lt;/h2>
&lt;ul>
&lt;li>æ·»åŠ äº† Golong é…ç½®éƒ¨åˆ†çš„æ–‡æ¡£ä»¥åŠ Golang ç‰ˆæœ¬è¦æ±‚ã€‚&lt;/li>
&lt;li>æ›´æ–°äº†ä¸€äº›ç°æœ‰æ–‡æ¡£ã€‚&lt;/li>
&lt;li>æ·»åŠ äº†ä¸€äº›è‹±æ–‡æ–‡æ¡£ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä¾èµ–å˜åŒ–">ä¾èµ–å˜åŒ–:&lt;/h2>
&lt;ol>
&lt;li>Thriftgo: v0.0.2-0.20210726073420-0145861fcd04 -&amp;gt; v0.1.2&lt;/li>
&lt;li>Netpoll: v0.0.2 -&amp;gt; v0.0.3&lt;/li>
&lt;/ol></description></item><item><title>Blog: Kitex v0.0.3 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/08/01/kitex-v0.0.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Sun, 01 Aug 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/08/01/kitex-v0.0.3-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤:&lt;/h2>
&lt;ul>
&lt;li>é˜²æ­¢è¿æ¥æ± è¢«è¦†ç›–ã€‚&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.0.2 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/07/30/kitex-v0.0.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Fri, 30 Jul 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/07/30/kitex-v0.0.2-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;h2 id="ä¼˜åŒ–">ä¼˜åŒ–ï¼š&lt;/h2>
&lt;ul>
&lt;li>Kitex åœ¨æ²¡æœ‰ tracer æ—¶å…³é—­ stats åˆ†é˜¶æ®µè€—æ—¶é‡‡é›†ï¼Œé¿å…æ—  Trace æ—¶é¢å¤–çš„æ€§èƒ½æ¶ˆè€—ã€‚&lt;/li>
&lt;li>Kitex client é»˜è®¤ä½¿ç”¨è¿æ¥æ± ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="bug-ä¿®å¤">Bug ä¿®å¤:&lt;/h2>
&lt;ul>
&lt;li>ä¿®å¤äº†ä¸€ä¸ª lbcache ä¸­ nil-pointer çš„é”™è¯¯ã€‚&lt;/li>
&lt;li>ä¿®å¤äº†ä¸€ä¸ª retry é‡è¯•ï¼ˆBackup Requestï¼‰ä¸­çš„ data race é—®é¢˜ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å·¥å…·">å·¥å…·:&lt;/h2>
&lt;ul>
&lt;li>Kitex å·¥å…·å»æ‰é»˜è®¤ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚&lt;/li>
&lt;li>Kitex å·¥å…·ç°åœ¨ä½¿ç”¨æœ€æ–°çš„ thriftgo API ä»¥é¿å…è€ç‰ˆ API åœ¨ç”Ÿæˆä»£ç æ—¶çš„å‡ ä¸ªè¾¹è§’æ¡ˆä¾‹ã€‚&lt;/li>
&lt;li>Kitex å·¥å…·ç°åœ¨ä¼šæ£€æŸ¥ä»£ç ä¸­æ˜¯å¦åŒ…å« go å‘½ä»¤ï¼Œä¸å†å‡è®¾å®ƒçš„å­˜åœ¨ã€‚æ„Ÿè°¢ @anqiansong çš„è´¡çŒ®ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ–‡æ¡£">æ–‡æ¡£:&lt;/h2>
&lt;ul>
&lt;li>æˆ‘ä»¬åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æ›´æ–°äº†ä¸€äº›æ–‡æ¡£ã€‚&lt;/li>
&lt;li>æˆ‘ä»¬ä¿®æ”¹äº†ä¸€äº›æ‹¼å†™é”™è¯¯å’Œé”™åˆ«å­—ã€‚æ„Ÿè°¢ @rleungx @Huangxuny1 @JeffreyBool çš„è´¡çŒ®ã€‚&lt;/li>
&lt;/ul></description></item><item><title>Blog: Kitex v0.0.1 ç‰ˆæœ¬å‘å¸ƒ</title><link>https://www.cloudwego.io/zh/blog/2021/07/12/kitex-v0.0.1-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</link><pubDate>Mon, 12 Jul 2021 00:00:00 +0000</pubDate><guid>https://www.cloudwego.io/zh/blog/2021/07/12/kitex-v0.0.1-%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83/</guid><description>
&lt;p>Kitex é¡¹ç›®åˆå§‹åŒ–ã€‚&lt;/p></description></item></channel></rss>